<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Tzero86@trojanwave/posts/poster_writeup/</title>
    
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="all,follow">
    <meta name="googlebot" content="index,follow,snippet,archive">
    <link rel="stylesheet" href="https://tzero86bits.tk/hugo-theme-console/css/terminal-0.7.1.min.css">
    <link rel="stylesheet" href="https://tzero86bits.tk/hugo-theme-console/css/animate-3.7.2.min.css">
    <link rel="stylesheet" href="https://tzero86bits.tk/hugo-theme-console/css/console.css">
    
      <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
          <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
      <![endif]-->
       <meta property="og:title" content="Poster_writeup" />
<meta property="og:description" content="" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://tzero86bits.tk/posts/poster_writeup/" /><meta property="article:published_time" content="2020-11-17T20:50:13-05:00" />



<meta name="twitter:title" content="Poster_writeup"/>
<meta name="twitter:description" content="The sys admin set up an RDBMS in a safe way, let&rsquo;s play with it and hack our way in!"/>

</head>
<body class="terminal">
    <div class="container">
        <div class="terminal-nav">
          <header class="terminal-logo">
            <div class="logo terminal-prompt">
              
              
              <a href="https://tzero86bits.tk/" class="no-style site-name">Tzero86@trojanwave</a>:~# 
              <a href='https://tzero86bits.tk/posts'>posts</a>/<a href='https://tzero86bits.tk/posts/poster_writeup'>poster_writeup</a>/</div></header>
          <nav class="terminal-menu">
            <ul vocab="https://schema.org/" typeof="BreadcrumbList">
                
                <li><a href="https://tzero86bits.tk/about/" typeof="ListItem">about/</a></li>
                
                <li><a href="https://tzero86bits.tk/posts/" typeof="ListItem">posts/</a></li>
                
                <li><a href="https://tzero86bits.tk/photos/" typeof="ListItem">photos/</a></li>
                
            </ul>
          </nav>
        </div>
    </div>

    <div class="container animated zoomIn fast" >
        
<h1>Poster_writeup</h1>
Nov. 17, 2020


<br/><br/>
<img src="../img/poster_cover.gif" alt="Post Cover Gif animation";>
<br/><br/>
<h1 id="poster---thm-room">Poster - THM Room</h1>
<p>Welcome to another writeup, this time we&rsquo;ll be trying to hack a newly released room on TryHackMe called Poster created by <code>stuxnet</code>! This is gonna be a really quick writeup (compared to my previous ones), since I&rsquo;m supposed to make dinner in 1 hour :joy: so that&rsquo;s the timne we have for this one, just an hour. Let&rsquo;s try to hack this, shall we?</p>
<ul>
<li>Please visit This room on TryHackMe by <a href="https://tryhackme.com/room/poster">clicking this link</a>.</li>
<li><strong>PLEASE NOTE:</strong> Passwords, flag values, or any kind of answers to the room questions were intentionally masked as required by THM writeups rules.</li>
</ul>
<h2 id="getting-initial-access">Getting initial access</h2>
<p>Let&rsquo;s use once again, <code>rustscan</code> to get a very-fast lay of the land.</p>
<p><img src="https://i.imgur.com/bMxpt3q.png" alt=""></p>
<p>A short explanation on that command:</p>
<ul>
<li><code>--ulimit</code> is to avoid any kind of performance issues by setting the recommended value of <code>5000</code>.</li>
<li><code>--</code> let us pass the next switches to <code>nmap</code> instead of sending them to <code>rustcan</code>, this way we can customize which type of scan we want to run.</li>
<li><code>-sV</code> we pass this to <code>nmap</code> so we can try to get the versions of the services running on each open port.</li>
<li><code>-sC</code> we pass this to <code>nmap</code> so it automatically tries the different scripts that are available within nmap.</li>
</ul>
<p>If instead we want to use plain nmap to get the version of the RDBMS running (first room question), we can do it like this (port number discovered by rustscan):</p>
<p><img src="https://i.imgur.com/GdT4034.png" alt=""></p>
<h2 id="metasploiting-away">Metasploiting away!</h2>
<p>Now we need to leverage <code>metasploit</code> to enumerate user credentials. Let&rsquo;s fire up metasploit with the command  <code>msfconsole -q</code> (-q is optional, just starts msfconsole quietly):</p>
<p><img src="https://i.imgur.com/805Xb6x.png" alt=""></p>
<p>Once we have the module we need identified, we select it by running <code>use #</code> where <code>#</code> is the actual number listed to the left of the module name.</p>
<p>Once selected we run <code>show options</code> to see which required values we need to <code>set</code> before the module can be executed. In this case it seems we just need to set <code>RHOSTS</code> to the ip of the target machine. <code>set RHOSTS {Target_IP}</code>, once that is set. We simply <code>run</code> the script:</p>
<p><img src="https://i.imgur.com/t9ZiNtW.png" alt=""></p>
<p>Once it runs we get a successful login back, with that we answer another room question.</p>
<p><img src="https://i.imgur.com/FYkkwzh.png" alt=""></p>
<p>Again, we run <code>show options</code> and set the required values, remember that we found a set of credentials before, let&rsquo;s set those too before running the module. In this case I&rsquo;ve set <code>PASSWORD</code> and <code>RHOSTS</code> since <code>USERNAME</code> was already set correctly:</p>
<p><img src="https://i.imgur.com/YiTsjJx.png" alt=""></p>
<p>With that we get another answer for the room&rsquo;s questions. Let&rsquo;s now move to the other one:</p>
<p><img src="https://i.imgur.com/sH7dkv0.png" alt=""></p>
<p>Again, we locate the right module, set its options and then run it:</p>
<p><img src="https://i.imgur.com/WR39NRo.png" alt=""></p>
<p>With the results we can answer the room question.</p>
<p>For the next one we just simply run <code>search postgre</code> and by just looking at the module names you&rsquo;ll get the answer:</p>
<p><img src="https://i.imgur.com/kmNhXyi.png" alt=""></p>
<p>From the same search we get the next module name to answer the room&rsquo;s question. Now we need to exploit this machine and get the flags.</p>
<h2 id="getting-the-user-flag">Getting the user flag</h2>
<p><img src="https://i.imgur.com/5BJMBLC.png" alt=""></p>
<p>Once we set all required options and the password we found, we can run the module:</p>
<p><img src="https://i.imgur.com/MQnC5kn.png" alt=""></p>
<p>We managed to get the initial access to the machine, if we look around we see where the <code>user.txt</code> flag is located, but we lack permissions to read it:</p>
<p><img src="https://i.imgur.com/DWFZQJx.png" alt=""></p>
<p>Since we know there is a module that would allow us to read files from the system. Let&rsquo;s use that to read the contents of the <code>/etc/passwd</code> file:</p>
<blockquote>
<p>Remember to set RHOSTS, PASSWORD before running the module.</p>
</blockquote>
<p><img src="https://i.imgur.com/TkHxB5Z.png" alt=""></p>
<p>Ok, the interesting part of that file is the mention to another file called <code>credentials.txt</code>. Let&rsquo;s use the same module to read that file, we need to set <code>RFILE</code> to that file path we found:</p>
<p><img src="https://i.imgur.com/QtFVOj6.png" alt=""></p>
<p>Now we got dark&rsquo;s credentials, and if we recall the results from rustscan we now there is a port 22 open. Let&rsquo;s try to login there: dark:qwerty1234#!hackme</p>
<p><img src="https://i.imgur.com/vICq8Oa.png" alt=""></p>
<p>Even though we are logged in as another user now, we still don&rsquo;t have access to that flag.</p>
<p>Let&rsquo;s fire up a local HTTP python server where we have the <code>linpeas.sh</code> file ready and let&rsquo;s upload it to the remote machine using <code>wget</code>:</p>
<p><img src="https://i.imgur.com/vbZKvoE.png" alt=""></p>
<p>If we start checking the results from linpeas, there are a couple of interesting things. However, there is one that seems particularly simple to check:
<img src="https://i.imgur.com/OoCdG1y.png" alt=""></p>
<p>Let&rsquo;s check that file:</p>
<p><img src="https://i.imgur.com/20H0xZI.png" alt=""></p>
<p>It seems we got the password for <code>Alison</code> account, which means we can get that user flag:</p>
<p>If we switch user to alison we get access to the first flag:</p>
<p><img src="https://i.imgur.com/eIukDqU.png" alt=""></p>
<h2 id="getting-the-root-flag">Getting the root flag</h2>
<p>If we run <code>sudo -l</code> for the current user we see that we can run all commands as sudo. Nice, we can get the root flag now:</p>
<p><img src="https://i.imgur.com/4fM2Dg7.png" alt=""></p>
<p>That&rsquo;s it, a very quick and entertaining room, we went a bit over the hour mark but we also produced another writeup that could help back a fellow hacker solve this room in the future. Totally worth it! I hope you enjoyed it!</p>
<p>Happy hacking!</p>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<br>
<div class="container center" style="margin:10px !important;  text-align: center!important">
    <div class="center">
        <script src="https://tryhackme.com/badge/71634"></script>
    </div>
    <div class="center">
        <a href="https://twitter.com/Tzero86" target="_blank" class="fa fa-twitter" style="text-decoration: none !important;  font-size: 30px; padding: 5px"></a>
        <a href="https://github.com/Tzero86" target="_blank" class="fa fa-github" style="text-decoration: none !important;  font-size: 30px; padding: 5px"></a> 
        <a href="https://www.linkedin.com/in/ermedina86/" target="_blank" class="fa fa-linkedin" style="text-decoration: none !important;  font-size: 30px; padding: 5px"></a> 
        <br> 
    </div>
</div>



        <div class="footer">
    Made with <a href="https://gohugo.io/">Hugo</a> with
    <a href="https://github.com/mrmierzejewski/hugo-theme-console/">Console Theme</a>. 
</div>

    </div>
  </body>
</html>
