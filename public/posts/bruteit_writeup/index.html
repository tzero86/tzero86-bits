<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Tzero86@trojanwave/posts/bruteit_writeup/</title>
    
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="all,follow">
    <meta name="googlebot" content="index,follow,snippet,archive">
    <link rel="stylesheet" href="https://tzero86bits.tk/hugo-theme-console/css/terminal-0.7.1.min.css">
    <link rel="stylesheet" href="https://tzero86bits.tk/hugo-theme-console/css/animate-3.7.2.min.css">
    <link rel="stylesheet" href="https://tzero86bits.tk/hugo-theme-console/css/console.css">
    
      <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
          <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
      <![endif]-->
    <link rel="icon" href="https://tzero86bits.tk/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://tzero86bits.tk/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://tzero86bits.tk/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://tzero86bits.tk/apple-touch-icon.png">
<link rel="mask-icon" href="https://tzero86bits.tk/safari-pinned-tab.svg">
<meta name="theme-color" content="#1d1e20">
<meta name="msapplication-TileColor" content="#1d1e20"><meta property="og:title" content="BruteIt_writeup" />
<meta property="og:description" content="" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://tzero86bits.tk/posts/bruteit_writeup/" /><meta property="article:published_time" content="2020-11-14T22:26:26-05:00" />



<meta name="twitter:title" content="BruteIt_writeup"/>
<meta name="twitter:description" content="Learn how to brute, hash cracking and how to escalate privileges in this box!"/>

<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-175520987-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
</head>
<body class="terminal">
    <div class="container">
        <div class="terminal-nav">
          <header class="terminal-logo">
            <div class="logo terminal-prompt">
              
              
              <a href="https://tzero86bits.tk/" class="no-style site-name">Tzero86@trojanwave</a>:~# 
              <a href='https://tzero86bits.tk/posts'>posts</a>/<a href='https://tzero86bits.tk/posts/bruteit_writeup'>bruteit_writeup</a>/</div></header>
          <nav class="terminal-menu">
            <ul vocab="https://schema.org/" typeof="BreadcrumbList">
                
                <li><a href="https://tzero86bits.tk/about/" typeof="ListItem">about/</a></li>
                
                <li><a href="https://tzero86bits.tk/posts/" typeof="ListItem">posts/</a></li>
                
            </ul>
          </nav>
        </div>
    </div>

    <div class="container animated zoomIn fast" >
        
<h1>BruteIt_writeup</h1>
Nov. 14, 2020


<br/><br/>
<img src="../img/bruteIt_cover.gif" alt="Post Cover Gif animation"; style="width:100%;height:auto;left:0;right:0;margin:0 auto;text-align:center; border-radius:1%">
<br/><br/>
<h1 id="brute-it---thm-room">Brute It - THM Room</h1>
<p>Welcome to another writeup, this time we&rsquo;ll be trying to hack a newly released room on TryHackMe called Brute It created by <code>ReddyyZ</code>!</p>
<ul>
<li>Please visit This room on TryHackMe by <a href="https://tryhackme.com/room/bruteit">clicking this link</a>.</li>
<li><strong>PLEASE NOTE:</strong> Passwords, flag values, or any kind of answers to the room questions were intentionally masked as required by THM writeups rules.</li>
</ul>
<h2 id="getting-initial-access">Getting initial access</h2>
<p>Let&rsquo;s run a <code>rustcan</code> to start things off:</p>
<p><img src="https://i.imgur.com/OBpWIBs.png" alt=""></p>
<p>Right away, from rustscan results we get the answers to the first part of the room, specifically these questions:</p>
<blockquote>
<p>How many ports are open?
What version of SSH is running?
Which Linux distributions is running?</p>
</blockquote>
<p>Now let&rsquo;s see if we can answer the following one:</p>
<blockquote>
<p>What is the hidden directory?</p>
</blockquote>
<h3 id="running-gobuster">Running GoBuster</h3>
<p>Let&rsquo;s fire up gobuster and see if we can find that hidden directory:</p>
<p><img src="https://i.imgur.com/yjWT9Ag.png" alt=""></p>
<p>Very quickly we get the hidden directory.</p>
<p>If we open the machine in our browser (I use Burp&rsquo;s suite integrated browser just in case I need Burp later) and navigate to the directory we found using <code>gobuster</code>, we see a login form.</p>
<p><img src="https://i.imgur.com/JhF1O0K.png" alt=""></p>
<p>If we open the dev tools we see there are two users mentioned: <code>john</code> and <code>admin</code>. Let&rsquo;s kpep those in mind.</p>
<h3 id="brute-forcing-the-login-form">Brute-forcing the login form</h3>
<p>Let&rsquo;s see if we can bruteforce this form. First, we need to check how it responds when we attempt to login:</p>
<p><img src="https://i.imgur.com/UOFHGOF.png" alt=""></p>
<p>From that attempt we get all we need to try to brute-force our way in.</p>
<p>Let&rsquo;s ready our <code>hydra</code> command:</p>
<p><code>hydra -l &lt;username&gt; -P &lt;wordlist&gt; 10.10.0.255 http-post-form &quot;/admin/:user=^USER^&amp;pass=^PASS^:F=Username or password invalid&quot; -V</code></p>
<p>NOTE: we could also do -L and provide a list of usernames with both <code>admin</code> and <code>john</code>. As for the wordlist I&rsquo;ll try with <code>rockyou.txt</code>.</p>
<p>Once ready we launch the command:</p>
<p><img src="https://i.imgur.com/5MPHfCJ.png" alt=""></p>
<p>This might take a while but we&rsquo;ll get the password. In <code>hydra</code> we trust ðŸ˜‚</p>
<p>Let&rsquo;s log in with the credentials we now have:</p>
<p><img src="https://i.imgur.com/ngiXffJ.png" alt=""></p>
<p>We get the web flag for the room and a link to a RSA private key:</p>
<p><img src="https://i.imgur.com/xV47qZJ.png" alt=""></p>
<h3 id="cracking-the-rsa-key">Cracking the RSA key</h3>
<p>Now we need to crack that key so we can hopefully get the initial access to this machine.</p>
<p>We need to grab that plain text key and save it into a file so we can use <code>john</code> to try and crack it. Before that we need to use <code>ssh2john</code> to generate a file that can be cracked by <code>john</code>.</p>
<p><img src="https://i.imgur.com/c6iqz8X.png" alt=""></p>
<p>Now we can run john:</p>
<p><img src="https://i.imgur.com/drW5YLk.png" alt=""></p>
<p>and we get the hash cracked.</p>
<p>Now let&rsquo;s try to connect as <code>john</code> with that key we&rsquo;ve got:</p>
<blockquote>
<p><em>NOTE:</em> Remember we need proper permissions set for the key to work, so do <code>chmod 600 id_rsa</code> before tryin to log in with the key.</p>
</blockquote>
<p><img src="https://i.imgur.com/lJwjB65.png" alt=""></p>
<p>Ok we managed to get the initial access. Off to get the flags now.</p>
<h2 id="getting-the-usertxt-flag">Getting the user.txt flag</h2>
<p>For this flag we just need to list the files in the directory, and then cat the user.txt file:</p>
<p><img src="https://i.imgur.com/jOCr5ju.png" alt=""></p>
<p>That&rsquo;s the user flag.</p>
<h2 id="getting-the-roottxt-flag">Getting the root.txt flag</h2>
<p>Now we need to find a way to scalate privileges to root so we can get the last flag. Let&rsquo;s fire up a python  HTTP local server in a folder where we get the <code>linpeas.sh</code> ready. Then from the target machine we&rsquo;ll <code>wget</code> that file so we can do some enumeration.</p>
<p><img src="https://i.imgur.com/HP86rN7.png" alt=""></p>
<blockquote>
<p>NOTE: Remmeber to run <code>chmod +x linpeas.sh</code> before running it.</p>
</blockquote>
<p>Right away we see the user john seems to have permissions to run as sudo, let&rsquo;s check that out:</p>
<p><img src="https://i.imgur.com/jpUIqBB.png" alt=""></p>
<p>If we run <code>sudo -l</code> we can see which commands we can run as sudo:</p>
<p><img src="https://i.imgur.com/fSH27zC.png" alt=""></p>
<p>It seems we can run <code>cat</code> as sudo, we can probably just try to cat the root.txt flag if it is in the usual location <code>/root/root.txt</code>:</p>
<p><img src="https://i.imgur.com/V594hIO.png" alt=""></p>
<p>That&rsquo;s it, we got the flag. However, we are not done yet. We need to find the password for the <code>root</code> account. So let&rsquo;s see how we can get root from <code>cat</code> by searching in <code>GTFObins</code> page:</p>
<p><img src="https://i.imgur.com/uTQ8Q0J.png" alt=""></p>
<p>So let&rsquo;s try to get the <code>/etc/shadow</code> file so we can potentially get the root password:</p>
<p><img src="https://i.imgur.com/AhoK6xj.png" alt=""></p>
<p>Ok we have the password hashes, let&rsquo;s try to crack them now:</p>
<p>It seems the password are using <code>SHA512crypt</code>. But instead of trying to crack that we can leverage the <code>cat</code> command again and get the <code>/etc/passwd</code> file two, so we can then use the <code>ushadow</code> tool to get the password:</p>
<p><img src="https://i.imgur.com/7Fhx3h4.png" alt=""></p>
<p>Now having both files we can just use <code>unshadow</code> to get the password:</p>
<p><img src="https://i.imgur.com/2XUHJZQ.png" alt=""></p>
<p>Now we need to run <code>john</code> again on that passwords file and we should be golden:</p>
<p><img src="https://i.imgur.com/h5plnF0.png" alt=""></p>
<p>That&rsquo;s it we got the last answer to fully solve this room!</p>
<p>I hope you enjoy the room, props to <code>ReddyyZ</code> for creating it!</p>
<p>Happy hacking!</p>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<br>
<div class="container center" style="margin:10px !important;  text-align: center!important">
    <div class="center">
        <script src="https://tryhackme.com/badge/71634"></script>
    </div>
    <div class="center">
        <a href="https://twitter.com/Tzero86" target="_blank" class="fa fa-twitter" style="text-decoration: none !important;  font-size: 30px; padding: 5px"></a>
        <a href="https://github.com/Tzero86" target="_blank" class="fa fa-github" style="text-decoration: none !important;  font-size: 30px; padding: 5px"></a> 
        <a href="https://www.linkedin.com/in/ermedina86/" target="_blank" class="fa fa-linkedin" style="text-decoration: none !important;  font-size: 30px; padding: 5px"></a> 
        <br> 
    </div>
</div>

<div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "tzero86bits" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

        <div class="footer">
    Made with <a href="https://gohugo.io/">Hugo</a> based of
    <a href="https://github.com/mrmierzejewski/hugo-theme-console/">Console Theme</a>. 
    Noli umquam discere desinere.
</div>

    </div>
  </body>
</html>
